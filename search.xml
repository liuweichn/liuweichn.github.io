<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>Gradle与Maven的区别</title>
      <link href="/2019/12/10/Gradle%E4%B8%8EMaven%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/2019/12/10/Gradle%E4%B8%8EMaven%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      <content type="html"><![CDATA[<p>Java生态体系中3大构建工具：Ant、Maven和Gradle。<br>Ant由Apache软件基金会维护；<br>Maven是Apache下的一个纯Java开发的开源项目，基于项目对象模型；<br>Gradle是基于Ant和Maven概念的自动化构建工具，使用一种基于Groovy的特定领域语言（DSL）来声明项目设置。<br><a id="more"></a></p><p>经过几年的发展，Ant几乎销声匿迹，而Maven由于较为不灵活的配置也渐渐被遗忘，而由于Gradle是基于Ant和Maven的一个优化版本，被越来越多的开发者使用。  </p><p>下面简单说下Maven和Gradle区别</p><h1 id="依赖管理"><a href="#依赖管理" class="headerlink" title="依赖管理"></a>依赖管理</h1><p>在Maven的管理体系中，用GroupID、ArtifactID和Version组成的Coordination唯一标识一个依赖项。任何基于Maven构建的项目自身也必须定义前两项属性，不指定Version则使用最新版本。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;2.1.10.RELEASE&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure></p><p>Gradle中直接使用“:”连接起来，GroupId:ArtifactId:Version。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    testImplementation &apos;junit:junit:4.12&apos;</span><br><span class="line">    androidTestImplementation &apos;com.android.support.test:runner:1.0.2&apos;</span><br><span class="line">    androidTestImplementation &apos;com.android.support.test.espresso:espresso-core:3.0.2&apos;</span><br><span class="line">    implementation &apos;com.android.support:support-annotations:28.0.0&apos;</span><br><span class="line">    implementation &apos;com.android.support:appcompat-v7:28.+&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>1、Maven和Gradle对依赖项的审视也有所不同。在Maven中，一个依赖项有6种scope，分别是compile、provided、runtime、test、system、import。其中compile为默认。而gradle将其简化为4种，compile、runtime、testCompile、testRuntime。如上述代码“testCompile ‘junit:junit:4.+’”，在Gradle中支持动态的版本依赖，在版本号后面使用+号可以实现动态的版本管理。<br>2、在解决依赖冲突方面Gradle的实现机制更加明确，两者都采用的是传递性依赖，而如果多个依赖项指向同一个依赖项的不同版本时可能会引起依赖冲突，Maven处理起来较为繁琐，而Gradle先天具有比较明确的策略。<br>3、两者都采用了插件机制，Maven是基于XML进行配置，而在Gradle中更加灵活。</p>]]></content>
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Gradle </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CentOS 安装MySql、Java</title>
      <link href="/2019/09/13/CentOS-%E5%AE%89%E8%A3%85MySql%E3%80%81Java/"/>
      <url>/2019/09/13/CentOS-%E5%AE%89%E8%A3%85MySql%E3%80%81Java/</url>
      <content type="html"><![CDATA[<p>腾讯云99元/年买了单核，1MB、2G、50G云服务器，安装MySql、Java环境，服务托管于此。</p><a id="more"></a><h1 id="连接到远程服务器"><a href="#连接到远程服务器" class="headerlink" title="连接到远程服务器"></a>连接到远程服务器</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh root@服务器地址</span><br><span class="line">或</span><br><span class="line">ssh -o serveraliveinterval=60 root@服务器地址</span><br></pre></td></tr></table></figure><h1 id="Java环境安装"><a href="#Java环境安装" class="headerlink" title="Java环境安装"></a>Java环境安装</h1><p>1、查看yum下可更新的Java列表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_17_centos /]# yum -y list java*</span><br></pre></td></tr></table></figure></p><p>2、安装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_17_centos /]# yum install -y java-1.8.0-openjdk.x86_64</span><br><span class="line">java -version //查看版本</span><br></pre></td></tr></table></figure></p><h1 id="MySql安装"><a href="#MySql安装" class="headerlink" title="MySql安装"></a>MySql安装</h1><h2 id="下载并安装"><a href="#下载并安装" class="headerlink" title="下载并安装"></a>下载并安装</h2><p>1、下载并安装MySQL官方的 Yum Repository<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# wget -i -c http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm</span><br></pre></td></tr></table></figure></p><p>2、 使用上面的命令就直接下载了安装用的Yum Repository，大概25KB的样子，然后就可以直接yum安装了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# yum -y install mysql57-community-release-el7-10.noarch.rpm</span><br></pre></td></tr></table></figure></p><p>2、之后就开始安装MySQL服务器。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# yum -y install mysql-community-server</span><br></pre></td></tr></table></figure></p><p>日志<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Installed:</span><br><span class="line">  mysql-community-libs.x86_64 0:5.7.27-1.el7      mysql-community-libs-compat.x86_64 0:5.7.27-1.el7   </span><br><span class="line">  mysql-community-server.x86_64 0:5.7.27-1.el7   </span><br><span class="line"></span><br><span class="line">Dependency Installed:</span><br><span class="line">  mysql-community-client.x86_64 0:5.7.27-1.el7      mysql-community-common.x86_64 0:5.7.27-1.el7     </span><br><span class="line">  numactl-libs.x86_64 0:2.0.9-7.el7                </span><br><span class="line"></span><br><span class="line">Replaced:</span><br><span class="line">  mariadb-libs.x86_64 1:5.5.60-1.el7_5</span><br></pre></td></tr></table></figure></p><h2 id="数据库配置"><a href="#数据库配置" class="headerlink" title="数据库配置"></a>数据库配置</h2><p>1、启动MySql<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# systemctl start  mysqld.service</span><br><span class="line">```  </span><br><span class="line">2、查看MySql运行状态</span><br></pre></td></tr></table></figure></p><p>[root@localhost ~]# systemctl status  mysqld.service<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3、此时MySQL已经开始正常运行，不过要想进入MySQL还得先找出此时root用户的密码，通过如下命令可以在日志文件中找出密码</span><br></pre></td></tr></table></figure></p><p>[root@localhost ~]# grep “password” /var/log/mysqld.log<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">![查看密码](CentOS-安装MySql、Java/password.png)</span><br><span class="line">4、进入数据库</span><br></pre></td></tr></table></figure></p><p>mysql -uroot -p<br>密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入密码  </span><br><span class="line">5、修改初始密码</span><br></pre></td></tr></table></figure></p><p>mysql&gt; ALTER USER ‘root‘@’localhost’ IDENTIFIED BY ‘new password’;<br>ERROR 1819 (HY000): Your password does not satisfy the current policy requirements//密码不满足规则，可查看规则<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">show variables like &apos;validate_password%&apos;;//查看规则</span><br></pre></td></tr></table></figure></p><h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><p>1、查看内存使用情况<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -mh</span><br></pre></td></tr></table></figure></p><p>2、查看硬盘使用情况<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df</span><br><span class="line">df -h</span><br></pre></td></tr></table></figure></p><h1 id="Mac使用scp指令上传文件到CentOS"><a href="#Mac使用scp指令上传文件到CentOS" class="headerlink" title="Mac使用scp指令上传文件到CentOS"></a>Mac使用scp指令上传文件到CentOS</h1><p>打开终端进入要上传文件的目录下，使用scp指令上传文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">上传：  </span><br><span class="line">scp first-0.0.1-SNAPSHOT.jar root@远程服务器ip地址:~ //根目录</span><br><span class="line">scp first-0.0.1-SNAPSHOT.jar root@远程服务器ip地址:/root/myapp/first.jar //复制到myapp文件夹下</span><br><span class="line">下载：  </span><br><span class="line">scp root@远程服务器ip地址:/下载文件的目录 『空格』 本地目录</span><br></pre></td></tr></table></figure></p><h1 id="后台运行java程序"><a href="#后台运行java程序" class="headerlink" title="后台运行java程序"></a>后台运行java程序</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar first.jar</span><br></pre></td></tr></table></figure><p>杀死nohup提交的后台运行的程序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.如果没有退出客户端界面，可以先通过 “jobs” 命令查看程序是否在运行，此时只有序号没有PID号；  </span><br><span class="line">2.输入命令 “jobs -l” 会显示程序的PID号，然后通过 “kill -9 PID”杀死程序；  </span><br><span class="line">3.输入命令 “jobs” 查看程序是否被杀死。</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.如果退出过客户端界面，输入 “jobs” 命令查不到正在运行的程序；  </span><br><span class="line">2.输入 “ps ux” 来查看所有程序的进程号PID，然后再通过 “kill -9 PID” 杀死程序；  </span><br><span class="line">3.输入 “ps ux” 来查看程序是否被杀死。</span><br></pre></td></tr></table></figure><h1 id="Linux常用命令"><a href="#Linux常用命令" class="headerlink" title="Linux常用命令"></a>Linux常用命令</h1><p>.ls -la 查看当前目录下的文件夹及文件<br>.rm -fr file/dir 删除文件或文件夹</p>]]></content>
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CentOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Spring Boot测试打包发布</title>
      <link href="/2019/09/12/Spring-Boot%E6%B5%8B%E8%AF%95%E6%89%93%E5%8C%85%E5%8F%91%E5%B8%83/"/>
      <url>/2019/09/12/Spring-Boot%E6%B5%8B%E8%AF%95%E6%89%93%E5%8C%85%E5%8F%91%E5%B8%83/</url>
      <content type="html"><![CDATA[<p>开发阶段就需要进行单元测试，Spring Boot对单元测试支持完善。<br>在 test 文件夹先新建一个测试类 UserControllerTest<br>添加@RunWith(SpringRunner.class)和@SpringBootTest注解，然后在测试方法头部加 @Test即可，最后在方法或类上右键run运行</p><a id="more"></a><h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@RunWith(SpringRunner.class)</span><br><span class="line">@SpringBootTest</span><br><span class="line">public class UserControllerTest &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private UserController1 userController1;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void hello()&#123;</span><br><span class="line">        Iterable&lt;User&gt; allUser = userController1.getAllUser();</span><br><span class="line">        for (User user : allUser) &#123;</span><br><span class="line">            System.out.println(user.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gradle build</span><br></pre></td></tr></table></figure><p>*会在项目 build -&gt; libs 目录下生成 first-0.0.1-SNAPSHOT.jar 文件</p><h1 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h1><p>进入libs目录下，运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar first-0.0.1-SNAPSHOT.jar</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Spring Boot Jpa的使用</title>
      <link href="/2019/09/12/Spring-boot-Jpa%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/09/12/Spring-boot-Jpa%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>Jpa（Java Persistence API）是Sun官方提出的Java持久化规范，提供一种对象/关系映射工具管理Java应用中的关系数据，为简化持久化开发工作和整合ORM技术。</p><p><em>注意Jpa是一套规范，不是一套产品。Hibernate、TopLink、JDO等框架是一套产品，如果这些产品实现了这个规范，那么我们就可以加他们为Jpa的实现产品。</em></p><p>Spring Boot Jpa是Spring 基于ORM框架、Jpa规范的基础上封装的一套Jpa应用框架，可使开发者用极简单的代码即可实现对数据的访问操作。它提供包括增删改查等在内的常用操作，且易于扩展！Spring Boot Jpa可以极大的提高开发效率。</p><a id="more"></a><p>在之前的文章<a href="">Spring Boot MySql操作</a>简单使用Spring Boot Jpa功能，此篇详细介绍常用用法及注意事项。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">userRepository.save(user);//插入</span><br><span class="line">userRepository.findAll();//查询所有</span><br></pre></td></tr></table></figure></p><h1 id="基本查询"><a href="#基本查询" class="headerlink" title="基本查询"></a>基本查询</h1><p>基本查询也分为两种，一种是 Spring Data 默认已经实现，一种是根据查询的方法来自动解析成 SQL。</p><h2 id="预先生成方法"><a href="#预先生成方法" class="headerlink" title="预先生成方法"></a>预先生成方法</h2><p>Spring Boot Jpa预生成了一些基本的CURD方法（增删改查）等等</p><h3 id="继承-JpaRepository"><a href="#继承-JpaRepository" class="headerlink" title="继承 JpaRepository"></a>继承 JpaRepository</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface UserRepository extends JpaRepository&lt;User, Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="使用默认方法"><a href="#使用默认方法" class="headerlink" title="使用默认方法"></a>使用默认方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class UserController1 &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private UserRepository userRepository;//自动注入生成的对象，逻辑处理层</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    @PostMapping(path = &quot;/test&quot;)</span><br><span class="line">    public @ResponseBody</span><br><span class="line">    String addNewUser(@RequestParam String name, @RequestParam String email) &#123;</span><br><span class="line">        userRepository.save(user);</span><br><span class="line">        userRepository.finidAll();</span><br><span class="line">        userRepository.findOne(1);</span><br><span class="line">        userRepository.delete(user);</span><br><span class="line">        userRepository.count();</span><br><span class="line">        userRepository.exists(1);</span><br><span class="line">        return &quot;test&quot;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">delete时需要加上注解：  </span><br><span class="line">@Modifying</span><br><span class="line">@Transactional</span><br></pre></td></tr></table></figure><h2 id="自定义简单查询"><a href="#自定义简单查询" class="headerlink" title="自定义简单查询"></a>自定义简单查询</h2><p>根据方法名来自动生成Sql，主要语法有：findXXBy、readAXXBy、queryXXBy、countXXBy、getXXBy后面更属性名称<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Iterable&lt;User&gt; findByEmail(String email);//根据email查</span><br><span class="line">Iterable&lt;User&gt; findByNameOrEmail(String name,String email);//根据name或者email查</span><br><span class="line">Long deleteByName(String name);//根据name删除</span><br></pre></td></tr></table></figure></p><p>LIKE、OrderBy、IgnoreCase等Sql体系的关键词都可以使用  </p><table><thead><tr><th style="text-align:center">Keyword</th><th style="text-align:center">Sample</th><th style="text-align:center">JPQL snippet</th></tr></thead><tbody><tr><td style="text-align:center">And</td><td style="text-align:center">findByLastnameAndFirstname</td><td style="text-align:center">… where x.lastname = ?1 and x.firstname = ?2</td></tr><tr><td style="text-align:center">Or</td><td style="text-align:center">findByLastnameOrFirstname</td><td style="text-align:center">… where x.lastname = ?1 or x.firstname = ?2</td></tr><tr><td style="text-align:center">Between</td><td style="text-align:center">findByStartDateBetween</td><td style="text-align:center">… where x.startDate between ?1 and ?2</td></tr><tr><td style="text-align:center">LessThan</td><td style="text-align:center">findByAgeLessThan</td><td style="text-align:center">… where x.age &lt; ?1</td></tr><tr><td style="text-align:center">LessThanEqual</td><td style="text-align:center">findByAgeLessThanEqual</td><td style="text-align:center">… where x.age &lt;= ?1</td></tr><tr><td style="text-align:center">GreaterThan</td><td style="text-align:center">findByAgeGreaterThan</td><td style="text-align:center">… where x.age &gt; ?1</td></tr><tr><td style="text-align:center">GreaterThanEqual</td><td style="text-align:center">findByAgeGreaterThanEqual</td><td style="text-align:center">… where x.age &gt;= ?1</td></tr><tr><td style="text-align:center">After</td><td style="text-align:center">findByStartDateAfter</td><td style="text-align:center">… where x.startDate &gt; ?1</td></tr><tr><td style="text-align:center">Before</td><td style="text-align:center">findByStartDateBefore</td><td style="text-align:center">… where x.startDate &lt; ?1</td></tr><tr><td style="text-align:center">IsNull</td><td style="text-align:center">findByAgeIsNull</td><td style="text-align:center">… where x.age is null</td></tr><tr><td style="text-align:center">IsNotNull,NotNull</td><td style="text-align:center">findByAge(Is)NotNull</td><td style="text-align:center">… where x.age not null</td></tr><tr><td style="text-align:center">Like</td><td style="text-align:center">findByFirstnameLike</td><td style="text-align:center">… where x.firstname like ?1</td></tr><tr><td style="text-align:center">NotLike</td><td style="text-align:center">findByFirstnameNotLike</td><td style="text-align:center">… where x.firstname not like ?1</td></tr><tr><td style="text-align:center">StartingWith</td><td style="text-align:center">findByFirstnameStartingWith</td><td style="text-align:center">… where x.firstname like ?1 (parameter bound with appended %)</td></tr><tr><td style="text-align:center">EndingWith</td><td style="text-align:center">findByFirstnameEndingWith</td><td style="text-align:center">… where x.firstname like ?1 (parameter bound with prepended %)</td></tr><tr><td style="text-align:center">Containing</td><td style="text-align:center">findByFirstnameContaining</td><td style="text-align:center">… where x.firstname like ?1 (parameter bound wrapped in %)</td></tr><tr><td style="text-align:center">OrderBy</td><td style="text-align:center">findByAgeOrderByLastnameDesc</td><td style="text-align:center">… where x.age = ? order by x.lastname desc</td></tr><tr><td style="text-align:center">Not</td><td style="text-align:center">findByLastnameNot</td><td style="text-align:center">… where x.lastname &lt;&gt; ?1</td></tr><tr><td style="text-align:center">In</td><td style="text-align:center">findByAgeIn(Collection ages)</td><td style="text-align:center">… where x.age in ?</td></tr><tr><td style="text-align:center">NotIn</td><td style="text-align:center">findByAgeNotIn(Collection age)</td><td style="text-align:center">… where x.age not in ?1</td></tr><tr><td style="text-align:center">TRUE</td><td style="text-align:center">findByActiveTrue()</td><td style="text-align:center">… where x.active = true</td></tr><tr><td style="text-align:center">IgnoreCase</td><td style="text-align:center">findByFirstnameIgnoreCase</td><td style="text-align:center">… where UPPER(x.firstame) = UPPER(?1)</td></tr></tbody></table><h1 id="复杂查询"><a href="#复杂查询" class="headerlink" title="复杂查询"></a>复杂查询</h1><p>在实际开发中我们需要用到分页、删选、连表等查询时就需要特殊的方式或者自定义Sql</p><h2 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h2><p>Spring Boot Jpa已经帮我们实现了分页功能，在查询的时候传入Pageable，当查询中有多个参数时Pageable建议作为做后一个参数传入。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Page&lt;User&gt; findALL(Pageable pageable);</span><br><span class="line">Page&lt;User&gt; findByName(String name,Pageable pageable);</span><br></pre></td></tr></table></figure></p><p>Pageable是spring封装的分页实现类，使用的时候需要传入页数、每页条数和排序规则<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@PostMapping(path = &quot;/findByPage&quot;)</span><br><span class="line">public @ResponseBody Page&lt;User&gt; findAllByPage(@RequestParam int page,@RequestParam int size)&#123;</span><br><span class="line">Sort sort = new Sort(Sort.Direction.ASC, &quot;id&quot;);</span><br><span class="line">Pageable pageable = PageRequest.of(page,size,sort);</span><br><span class="line">return userRepository.findAll(pageable);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>返回结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;content&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 10,</span><br><span class="line">            &quot;name&quot;: &quot;wang&quot;,</span><br><span class="line">            &quot;email&quot;: &quot;345@126.com&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 4,</span><br><span class="line">            &quot;name&quot;: &quot;liuwei&quot;,</span><br><span class="line">            &quot;email&quot;: &quot;liuwei_chn@126.com&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 9,</span><br><span class="line">            &quot;name&quot;: &quot;wang&quot;,</span><br><span class="line">            &quot;email&quot;: &quot;34@126.com&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 8,</span><br><span class="line">            &quot;name&quot;: &quot;wang&quot;,</span><br><span class="line">            &quot;email&quot;: &quot;3@126.com&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 11,</span><br><span class="line">            &quot;name&quot;: &quot;wang&quot;,</span><br><span class="line">            &quot;email&quot;: &quot;3456@126.com&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;pageable&quot;: &#123;</span><br><span class="line">        &quot;sort&quot;: &#123;</span><br><span class="line">            &quot;sorted&quot;: false,</span><br><span class="line">            &quot;unsorted&quot;: true,</span><br><span class="line">            &quot;empty&quot;: true</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;offset&quot;: 0,</span><br><span class="line">        &quot;pageSize&quot;: 5,</span><br><span class="line">        &quot;pageNumber&quot;: 0,</span><br><span class="line">        &quot;unpaged&quot;: false,</span><br><span class="line">        &quot;paged&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;totalPages&quot;: 4,</span><br><span class="line">    &quot;totalElements&quot;: 17,</span><br><span class="line">    &quot;last&quot;: false,</span><br><span class="line">    &quot;size&quot;: 5,</span><br><span class="line">    &quot;number&quot;: 0,</span><br><span class="line">    &quot;first&quot;: true,</span><br><span class="line">    &quot;numberOfElements&quot;: 5,</span><br><span class="line">    &quot;sort&quot;: &#123;</span><br><span class="line">        &quot;sorted&quot;: false,</span><br><span class="line">        &quot;unsorted&quot;: true,</span><br><span class="line">        &quot;empty&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;empty&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="限制查询"><a href="#限制查询" class="headerlink" title="限制查询"></a>限制查询</h2><p>取前N个数据:top10（queryFirst10ByName）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//按名字查前10条记录，根据id正序</span><br><span class="line">Iterable&lt;User&gt; findFirst10ByName(String name, Sort sort);</span><br><span class="line"></span><br><span class="line">//限制查询</span><br><span class="line">@GetMapping(path = &quot;/nameTop10&quot;)</span><br><span class="line">public @ResponseBody Iterable&lt;User&gt; top10(@RequestParam String name)&#123;</span><br><span class="line">Sort sort = new Sort(Sort.Direction.ASC,&quot;id&quot;);</span><br><span class="line">return userRepository.findFirst10ByName(name,sort);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//After 根据packageName并且status &gt; 0 查询</span><br><span class="line">Build findFirstByPackageNameAndStatusAfter(String packageName, int than, Sort sort);</span><br></pre></td></tr></table></figure><h2 id="自定义Sql查询"><a href="#自定义Sql查询" class="headerlink" title="自定义Sql查询"></a>自定义Sql查询</h2><p>Spring Boot Jpa支持sql语句查询。查询方法使用@Query注解；修改/删除使用@Modifying；也可以@Transactional对事务的支持，设置查询超时<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//自定义sql查询</span><br><span class="line">@Query(&quot;select u from User u where u.name=?1&quot;)</span><br><span class="line">Iterable&lt;User&gt; findByName(String name);</span><br><span class="line"></span><br><span class="line">@Modifying</span><br><span class="line">@Query(&quot;update User u set u.name = ?1 where u.id = ?2&quot;)</span><br><span class="line">int modifyNameById(String name,Integer id);</span><br><span class="line"></span><br><span class="line">@Modifying</span><br><span class="line">@Query(&quot;delete from User where id = ?1&quot;)</span><br><span class="line">void deleteById(Integer id);</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@PostMapping(path = &quot;/findByName&quot;)</span><br><span class="line">public @ResponseBody Iterable&lt;User&gt; findByName(@RequestParam String name)&#123;</span><br><span class="line">return userRepository.findByName(name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Modifying</span><br><span class="line">@Transactional</span><br><span class="line">@PostMapping(path = &quot;/updateNameById&quot;)</span><br><span class="line">public @ResponseBody</span><br><span class="line">int updateNameById(@RequestParam String name, @RequestParam Integer id) &#123;</span><br><span class="line">return userRepository.modifyNameById(name, id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Modifying</span><br><span class="line">@Transactional</span><br><span class="line">@PostMapping(path = &quot;/deleteById&quot;)</span><br><span class="line">public @ResponseBody String deleteById(@RequestParam Integer id)&#123;</span><br><span class="line">userRepository.deleteById(id);</span><br><span class="line">return &quot;删除成功&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><p>待补充</p><h1 id="多数据源的支持"><a href="#多数据源的支持" class="headerlink" title="多数据源的支持"></a>多数据源的支持</h1><p>待补充</p>]]></content>
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Spring Boot MySql操作</title>
      <link href="/2019/09/12/Spring-Boot-MySql%E6%93%8D%E4%BD%9C/"/>
      <url>/2019/09/12/Spring-Boot-MySql%E6%93%8D%E4%BD%9C/</url>
      <content type="html"><![CDATA[<p>之前初始化项目时加入了mysql数据库依赖</p><p><img src="/2019/09/12/Spring-Boot-MySql操作/init.png" alt="数据库操作"></p><a id="more"></a><h1 id="添加配置文件"><a href="#添加配置文件" class="headerlink" title="添加配置文件"></a>添加配置文件</h1><ul><li>编辑resources -&gt; application.properties 文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># mysql</span><br><span class="line">spring.jpa.hibernate.ddl-auto=create</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/db_example</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=root</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.spring.jpa.hibernate.ddl-auto=create</span><br><span class="line">create： 每次加载hibernate时都会上一次生成的表，然后根据你的model类再生成新表，会导致数据丢失；</span><br><span class="line">create-drop：每次加载hibernate时根据model类生成表，但是sessionFactory一关闭表就自动删除；</span><br><span class="line">update：最常用的属性，第一次夹在hibernate时根据model类会自动建立表的结构（前提是先建立好数据库），以后根据model类自动更新表结构，即使表结构改变了但表中的行仍然存在不会删除以前的行；</span><br><span class="line">validate：每次加载hibernate时，验证创建数据库表结构，只会在数据库中的表进行比较，不会创建新表，但是会插入新值。</span><br><span class="line">2.spring.datasource.url=jdbc:mysql://127.0.0.1:3306/db_example</span><br><span class="line">新建‘db_example’数据库</span><br><span class="line">3.4. root</span><br></pre></td></tr></table></figure><h1 id="添加实体类"><a href="#添加实体类" class="headerlink" title="添加实体类"></a>添加实体类</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class User &#123;</span><br><span class="line"></span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue(strategy = GenerationType.AUTO)</span><br><span class="line">    private Integer id;</span><br><span class="line"></span><br><span class="line">    @Column(nullable = false)</span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    @Column(nullable = false, unique = true)</span><br><span class="line">    private String email;</span><br><span class="line"></span><br><span class="line">    //省略getter setter方法</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Dao层"><a href="#Dao层" class="headerlink" title="Dao层"></a>Dao层</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface UserRepository  extends JpaRepository&lt;User,Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">//JpaRepository 里面实现了大量的增删改查方法</span><br></pre></td></tr></table></figure><h1 id="UserController"><a href="#UserController" class="headerlink" title="UserController"></a>UserController</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">@RequestMapping(&quot;/user&quot;)</span><br><span class="line">public class UserController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private UserRepository userRepository;//自动注入生成的对象，逻辑处理层</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 新增用户</span><br><span class="line">     */</span><br><span class="line">    @PostMapping(path = &quot;/add&quot;)</span><br><span class="line">    public @ResponseBody</span><br><span class="line">    String addNewUser(@RequestParam String name, @RequestParam String email) &#123;</span><br><span class="line">        User user = new User();</span><br><span class="line">        user.setName(name);</span><br><span class="line">        user.setEmail(email);</span><br><span class="line">        userRepository.save(user);</span><br><span class="line">        return &quot;Saved&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @GetMapping(path = &quot;/getAll&quot;)</span><br><span class="line">    public @ResponseBody</span><br><span class="line">    Iterable&lt;User&gt; getAllUser() &#123;</span><br><span class="line">        return userRepository.findAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Gradle 初始化Spring Boot项目</title>
      <link href="/2019/09/11/Gradle-%E5%88%9D%E5%A7%8B%E5%8C%96Spring-boot%E9%A1%B9%E7%9B%AE/"/>
      <url>/2019/09/11/Gradle-%E5%88%9D%E5%A7%8B%E5%8C%96Spring-boot%E9%A1%B9%E7%9B%AE/</url>
      <content type="html"><![CDATA[<h2 id="1、网页构建"><a href="#1、网页构建" class="headerlink" title="1、网页构建"></a>1、网页构建</h2><p><a href="spring initializr">https://start.spring.io</a> 初始化gradle spring boot</p><p><img src="/2019/09/11/Gradle-初始化Spring-boot项目/springinit.png" alt="spring init"></p><p>IntelliJ IDEA中打开项目</p><p><img src="/2019/09/11/Gradle-初始化Spring-boot项目/pro.png" alt="项目结构">  </p><h2 id="2、IDEA-Gradle构建"><a href="#2、IDEA-Gradle构建" class="headerlink" title="2、IDEA Gradle构建"></a>2、IDEA Gradle构建</h2><p>打开Idea -&gt; new Project -&gt; Spring Initializr -&gt; Type选择Gradle Project -&gt; 填写group、artifact -&gt; 钩上web、jpa、mysql -&gt; 点下一步就行了。  </p><p><img src="/2019/09/11/Gradle-初始化Spring-boot项目/ideacreate.png" alt="spring init"></p>]]></content>
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>mac 8080端口被占用</title>
      <link href="/2019/09/11/mac-8080%E7%AB%AF%E5%8F%A3%E8%A2%AB%E5%8D%A0%E7%94%A8/"/>
      <url>/2019/09/11/mac-8080%E7%AB%AF%E5%8F%A3%E8%A2%AB%E5%8D%A0%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>当端口被占用后,我们可以使用下面这个命令去查看哪个程序占用了端口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lsof -i tcp:8080</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">然后对其中的pid执行这个命令</span><br></pre></td></tr></table></figure></p><p>kill 12334 (12334 指的是pid)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- more --&gt;</span><br><span class="line"></span><br><span class="line">但有时候发现杀掉了,端口还是被占用了.</span><br><span class="line"></span><br><span class="line">则使用该命令</span><br></pre></td></tr></table></figure></p><p>sudo lsof -i :8080<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">然后根据端PID去杀掉对应的进程:</span><br></pre></td></tr></table></figure></p><p>sudo kill -9 61342<br><code>`</code></p>]]></content>
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 8080端口占用 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Kotlin 基本数据类型</title>
      <link href="/2019/05/17/Kotlin-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
      <url>/2019/05/17/Kotlin-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
      <content type="html"><![CDATA[]]></content>
      
      
        <tags>
            
            <tag> Kotlin </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Kotlin 基础语法</title>
      <link href="/2019/05/10/Kotlin-%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/"/>
      <url>/2019/05/10/Kotlin-%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>函数定义；可变长参数函数；lambda（匿名函数）；常量变量；注释；字符串模版；NULL检查机制；类型检测及自动转换；区间<br><a id="more"></a></p><h1 id="函数定义"><a href="#函数定义" class="headerlink" title="函数定义"></a>函数定义</h1><p>关键字fun，参数格式为：参数：类型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fun sum(a: Int, b: Int): Int &#123;</span><br><span class="line">return a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//表达式作为函数体</span><br><span class="line">fun sum1(a: Int, b: Int): Int = a + b</span><br><span class="line"></span><br><span class="line">//无返回值的函数： Unit</span><br><span class="line">fun PrintSum(a: Int): Unit &#123;</span><br><span class="line">print(a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="可变长度参数"><a href="#可变长度参数" class="headerlink" title="可变长度参数"></a>可变长度参数</h1><p>关键字：vararg<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fun vars(vararg v: String) &#123;</span><br><span class="line">for(vt in v)</span><br><span class="line">print(vt)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="lambad（匿名函数）"><a href="#lambad（匿名函数）" class="headerlink" title="lambad（匿名函数）"></a>lambad（匿名函数）</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fun lambadDemo()&#123;</span><br><span class="line">val sumLambad: (Int, Int) -&gt; Int = &#123;x, y -&gt; x + y&#125;</span><br><span class="line">print(sumLambad(2, 3)) //输出5</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="定义变量常量"><a href="#定义变量常量" class="headerlink" title="定义变量常量"></a>定义变量常量</h1><p>var 关键字 //变量<br>var &lt;标识符&gt; : &lt;类型&gt; = &lt;初始化值&gt;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var a : Int = 1</span><br></pre></td></tr></table></figure></p><p>val 关键字 //常量<br>val &lt;标识符&gt; : &lt;类型&gt; = &lt;初始化值&gt;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val a : Int = 1</span><br></pre></td></tr></table></figure></p><h1 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h1><p>单行注视<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//这是单行注视</span><br></pre></td></tr></table></figure></p><p>多行注释<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/* 这是</span><br><span class="line">多行注释</span><br><span class="line">*/</span><br></pre></td></tr></table></figure></p><h1 id="字符串模版"><a href="#字符串模版" class="headerlink" title="字符串模版"></a>字符串模版</h1><p>$ 表示一个变量名或变量值<br>$varName 表示变量值<br>${varName.fun()} 表示变量的方法返回值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var a = 1</span><br><span class="line"></span><br><span class="line">//模版中的简单名称</span><br><span class="line">val s1 = &quot;a is $a&quot;</span><br><span class="line"></span><br><span class="line">a = 2</span><br><span class="line"></span><br><span class="line">//模版中的任意表达式</span><br><span class="line">val s2 = &quot;$&#123;s1.replace(&quot;is&quot;,&quot;was&quot;)&#125;, but now is $a&quot;</span><br><span class="line"></span><br><span class="line">//输出： a was 1, but now is 2</span><br></pre></td></tr></table></figure></p><h1 id="NULL检查机制"><a href="#NULL检查机制" class="headerlink" title="NULL检查机制"></a>NULL检查机制</h1><p>Kotlin的空安全设计对于声明可为空的参数，在使用时要进行空判断处理，有两种处理方式，字段后加 !! 像java一样抛出空异常，另一种字段后加 ? 可不做处理返回值为null或配合 ?: 作空判断处理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//类型后面加 ? 表示可为空</span><br><span class="line">var age: String? = &quot;23&quot;</span><br><span class="line">age = null</span><br><span class="line"></span><br><span class="line">//抛出空指针异常</span><br><span class="line">val ages = age!!.toInt()</span><br><span class="line"></span><br><span class="line">//不做处理返回null</span><br><span class="line">val age1 = age?.toInt()</span><br><span class="line"></span><br><span class="line">//为空返回-1</span><br><span class="line">val age2 = age?.toInt() ?: -1</span><br></pre></td></tr></table></figure></p><h1 id="类型检测及自动类型转换"><a href="#类型检测及自动类型转换" class="headerlink" title="类型检测及自动类型转换"></a>类型检测及自动类型转换</h1><p>使用 is 运算符检测是否为某种类型（类似于java的instanceof关键字）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fun getStrLength(obj: Any): Int?&#123;</span><br><span class="line">if(obj is String)</span><br><span class="line">return obj.length</span><br><span class="line">return null</span><br><span class="line">&#125;</span><br><span class="line">//或者 !is</span><br><span class="line">fun getStrLength(obj: Any): Int?&#123;</span><br><span class="line">if(obj !is String)</span><br><span class="line">return null</span><br><span class="line">//这个分支中，obj 会被自动转换为 String</span><br><span class="line">return obj.length</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="区间"><a href="#区间" class="headerlink" title="区间"></a>区间</h1><p>区间表达式由具有操作符 .. 的范围形式辅以in组合；<br>区间是为任何可比较类型定义的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for(i in 1..4) print(i) //输出1234</span><br><span class="line">for(i in 4 downTo 1) print(i) //输出4321</span><br><span class="line">for(i in 1..4 step 2) print(i) //输出13，步长为2</span><br><span class="line">for(i in 1 until 4) print(i) //输出123，[1,4)含左不含右</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> Kotlin </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kotlin </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Kotlin 教程</title>
      <link href="/2019/05/10/Kotlin-%E6%95%99%E7%A8%8B/"/>
      <url>/2019/05/10/Kotlin-%E6%95%99%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>Kotlin是一种在Java虚拟机上运行的静态类型编程语言，被称之为Android界的Swift。由JetBrains设计开发。<br>Kotlin可以编译成Java字节码，也可以编译成JavaScript，方便在没有Java的设备上运行。<br>Google在 I/O 2017年，宣布成为Android官方开发语言。<br><a id="more"></a>  </p><h1 id="Kotlin-Android-环境搭建"><a href="#Kotlin-Android-环境搭建" class="headerlink" title="Kotlin Android 环境搭建"></a>Kotlin Android 环境搭建</h1><p>打开setting，在plugins中搜索kotlin安装</p><h1 id="将Java代码转换为Kotlin"><a href="#将Java代码转换为Kotlin" class="headerlink" title="将Java代码转换为Kotlin"></a>将Java代码转换为Kotlin</h1><p>新建一个Android项目，添加一个磨人的MainActivity<br>打开MainActivity.java文件，通过菜单栏依次调出Code-&gt;Convert Java File to Kotlin File<br>转换完成后可看到使用Kotlin编写的activity<br><img src="/2019/05/10/Kotlin-教程/1.jpg" alt=""></p><h1 id="工程配置Kotlin"><a href="#工程配置Kotlin" class="headerlink" title="工程配置Kotlin"></a>工程配置Kotlin</h1><p>转换完之后Android Strdio会提示当前工程还未配置Kotlin，根据提示完成操作即可<br><img src="/2019/05/10/Kotlin-教程/2.png" alt=""><br><img src="/2019/05/10/Kotlin-教程/3.png" alt=""></p>]]></content>
      
      <categories>
          
          <category> Kotlin </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kotlin </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Spring Boot(2)-Web综合开发</title>
      <link href="/2019/04/29/Spring-Boot-2-Web%E7%BB%BC%E5%90%88%E5%BC%80%E5%8F%91/"/>
      <url>/2019/04/29/Spring-Boot-2-Web%E7%BB%BC%E5%90%88%E5%BC%80%E5%8F%91/</url>
      <content type="html"><![CDATA[<p>Web开发： 包括常用的json输出、filters、property、log等<br><a id="more"></a></p><h1 id="1-json接口开发"><a href="#1-json接口开发" class="headerlink" title="1.json接口开发"></a>1.json接口开发</h1><p>使用@Controller注解即可返回json数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class HelloController &#123;</span><br><span class="line">    @RequestMapping(&quot;/getUser&quot;)</span><br><span class="line">    public User getUser() &#123;</span><br><span class="line">    User user=new User();</span><br><span class="line">    user.setUserName(&quot;小明&quot;);</span><br><span class="line">    user.setPassWord(&quot;xxxx&quot;);</span><br><span class="line">        return user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>请求返回：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;name&quot;:&quot;小明&quot;,&quot;password&quot;:xxxx&#125;</span><br></pre></td></tr></table></figure></p><h1 id="2-自定义Filter"><a href="#2-自定义Filter" class="headerlink" title="2.自定义Filter"></a>2.自定义Filter</h1><p>使用filter记录日志:</p><ul><li>实现Filter接口</li><li>添加@Configuration注解，将自定义Filter加入过滤器<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class WebConfiguration &#123;</span><br><span class="line">    @Bean</span><br><span class="line">    public RemoteIpFilter remoteIpFilter() &#123;</span><br><span class="line">        return new RemoteIpFilter();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @Bean</span><br><span class="line">    public FilterRegistrationBean testFilterRegistration() &#123;</span><br><span class="line"></span><br><span class="line">        FilterRegistrationBean registration = new FilterRegistrationBean();</span><br><span class="line">        registration.setFilter(new MyFilter());</span><br><span class="line">        registration.addUrlPatterns(&quot;/*&quot;);</span><br><span class="line">        registration.addInitParameter(&quot;paramName&quot;, &quot;paramValue&quot;);</span><br><span class="line">        registration.setName(&quot;MyFilter&quot;);</span><br><span class="line">        registration.setOrder(1);</span><br><span class="line">        return registration;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public class MyFilter implements Filter &#123;</span><br><span class="line">@Override</span><br><span class="line">public void destroy() &#123;</span><br><span class="line">// TODO Auto-generated method stub</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void doFilter(ServletRequest srequest, ServletResponse sresponse, FilterChain filterChain)</span><br><span class="line">throws IOException, ServletException &#123;</span><br><span class="line">// TODO Auto-generated method stub</span><br><span class="line">HttpServletRequest request = (HttpServletRequest) srequest;</span><br><span class="line">System.out.println(&quot;this is MyFilter,url :&quot;+request.getRequestURI());</span><br><span class="line">filterChain.doFilter(srequest, sresponse);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void init(FilterConfig arg0) throws ServletException &#123;</span><br><span class="line">// TODO Auto-generated method stub</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="3-自定义Property"><a href="#3-自定义Property" class="headerlink" title="3.自定义Property"></a>3.自定义Property</h1><p>开发中经常需要自定义一些配置文件。  </p><h3 id="1-配置在application-properties中"><a href="#1-配置在application-properties中" class="headerlink" title="1.配置在application.properties中"></a>1.配置在application.properties中</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user.name=小明</span><br><span class="line">user.age=26</span><br></pre></td></tr></table></figure><p>获取配置信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@Value(&quot;$&#123;user.name&#125;&quot;)</span><br><span class="line">private String name;</span><br></pre></td></tr></table></figure></p><h3 id="2-配置在其他文件中user-properties"><a href="#2-配置在其他文件中user-properties" class="headerlink" title="2.配置在其他文件中user.properties"></a>2.配置在其他文件中user.properties</h3><p>在main/resources下新建user.properties文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">haha.name=小明</span><br><span class="line">haha.age=260</span><br></pre></td></tr></table></figure></p><p>获取配置信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">//@ConfigurationProperties(prefix = &quot;user&quot;)</span><br><span class="line">@PropertySource(value = &quot;classpath:user.properties&quot;,encoding = &quot;UTF-8&quot;)</span><br><span class="line">public class UserBean &#123;</span><br><span class="line"></span><br><span class="line">    @Value(&quot;$&#123;user.user.name&#125;&quot;)</span><br><span class="line">    private String name;</span><br><span class="line">    @Value(&quot;$&#123;user.user.age&#125;&quot;)</span><br><span class="line">    private int age;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(int age) &#123;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;User&#123;&quot; +</span><br><span class="line">                &quot;name=&apos;&quot; + name + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, age=&quot; + age +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><ul><li>@PropertySource：value = “classpath:user.properties”自定义properties位置</li><li>encoding = “UTF-8”编码（不设置可能会中文乱码）</li></ul>]]></content>
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Spring Boot（1）-入门</title>
      <link href="/2019/04/29/Spring-Boot-1-%E5%85%A5%E9%97%A8/"/>
      <url>/2019/04/29/Spring-Boot-1-%E5%85%A5%E9%97%A8/</url>
      <content type="html"><![CDATA[<p>Spring Boot 是由 Pivotal 团队提供的全新框架，其设计目的是用来简化新 Spring 应用的初始搭建以及开发过程。该框架使用了特定的方式来进行配置，从而使开发人员不再需要定义样板化的配置。用我的话来理解，就是 Spring Boot 其实不是什么新的框架，它默认配置了很多框架的使用方式，就像 Maven 整合了所有的 Jar 包，Spring Boot 整合了所有的框架。<br><a id="more"></a></p><h1 id="1-引入"><a href="#1-引入" class="headerlink" title="1.引入"></a>1.引入</h1><p>maven引入：打开pom.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">    &lt;java.version&gt;1.8&lt;/java.version&gt;</span><br><span class="line">&lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">&lt;parent&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.1.4.RELEASE&lt;/version&gt;</span><br><span class="line">    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">&lt;/parent&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependencies&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">        &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">&lt;build&gt;</span><br><span class="line">    &lt;plugins&gt;</span><br><span class="line">        &lt;plugin&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">        &lt;/plugin&gt;</span><br><span class="line">    &lt;/plugins&gt;</span><br><span class="line">&lt;/build&gt;</span><br></pre></td></tr></table></figure></p><p>spring boot建议目录结构</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">com</span><br><span class="line">  +- example</span><br><span class="line">    +- myproject</span><br><span class="line">      +- Application.java //根目录，主要用于做一些框架配置</span><br><span class="line">      |</span><br><span class="line">      +- domain //实体（Entity）与数据访问层（Repository）</span><br><span class="line">      |  +- Customer.java</span><br><span class="line">      |  +- CustomerRepository.java</span><br><span class="line">      |</span><br><span class="line">      +- service //业务类代码</span><br><span class="line">      |  +- CustomerService.java</span><br><span class="line">      |</span><br><span class="line">      +- controller //页面访问控制</span><br><span class="line">      |  +- CustomerController.java</span><br><span class="line">      |</span><br></pre></td></tr></table></figure><h1 id="2-引入web模块"><a href="#2-引入web模块" class="headerlink" title="2.引入web模块"></a>2.引入web模块</h1><p><dependencies>中加入spring-boot-starter-web<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">...</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">...</span><br><span class="line">&lt;dependencies&gt;</span><br></pre></td></tr></table></figure></dependencies></p><p>pom.xml中默认两个模块.</p><ul><li>spring-boot-starter:核心模块，包括自动配置支持、日志和YAML，如果引入了spring-boot-starter-web模块，可以去到此配置，因为spring-boot-starter-web自动依赖spring-boot-starter。  </li><li>spring-boot-starter-test</li></ul><h1 id="3-Hello-World"><a href="#3-Hello-World" class="headerlink" title="3.Hello World"></a>3.Hello World</h1><p>新建controller/HelloWorldController.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class HelloWorldController &#123;</span><br><span class="line">    @RequestMapping(&quot;/hello&quot;)</span><br><span class="line">    public String index() &#123;</span><br><span class="line">        return &quot;Hello World&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>启动FirstApplication<br><img src="/2019/04/29/Spring-Boot-1-入门/1.jpg" alt="控制台"><br><img src="/2019/04/29/Spring-Boot-1-入门/2.jpg" alt="浏览器"></p><p>参考：<a href="http://www.ityouknow.com/springboot/2016/01/06/spring-boot-quick-start.html" target="_blank" rel="noopener">http://www.ityouknow.com/springboot/2016/01/06/spring-boot-quick-start.html</a></p>]]></content>
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Maven 安装与配置</title>
      <link href="/2019/04/28/Maven-%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/"/>
      <url>/2019/04/28/Maven-%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/</url>
      <content type="html"><![CDATA[<p>Maven项目对象模型(POM)，可以通过一小段描述信息来管理项目的构建，报告和文档的项目管理工具软件。<br><a id="more"></a></p><p>Maven是一个项目管理和综合工具。Maven提供了开发人员构建一个完整的生命周期框架。开发团队可以自动完成项目的基础工具建设，Maven使用标准的目录结构和默认构建生命周期。  </p><p>在多个开发团队环境时，Maven可以设置按标准在非常短的时间里完成配置工作。由于大部分项目的设置都很简单，并且可重复使用，Maven让开发人员的工作更轻松，同时创建报表，检查，构建和测试自动化设置。</p><h1 id="1-下载maven包"><a href="#1-下载maven包" class="headerlink" title="1.下载maven包"></a>1.下载maven包</h1><p>下载地址<a href="http://maven.apache.org/download.cgi" target="_blank" rel="noopener">http://maven.apache.org/download.cgi</a>  </p><p><em>注意<br>Binary tar.gz archive：是装在Linux、MacOsX上的<br>Binary zip archive：是装在windows上的<br>binary表示编译后的二进制文件，一般比较小，适合直接在项目中使用<br>source表示可以查看源代码的，比binary大一些，如果你想看一下maven的源码可以下载这一类的</em></p><h1 id="2-mac下-maven环境配置"><a href="#2-mac下-maven环境配置" class="headerlink" title="2.mac下 maven环境配置"></a>2.mac下 maven环境配置</h1><h3 id="1-先解压Binary-tar-gz-archive文件"><a href="#1-先解压Binary-tar-gz-archive文件" class="headerlink" title="1.先解压Binary tar.gz archive文件"></a>1.先解压Binary tar.gz archive文件</h3><h3 id="2-打开配置文件-open-bash-profile"><a href="#2-打开配置文件-open-bash-profile" class="headerlink" title="2.打开配置文件:open ~/.bash_profile"></a>2.打开配置文件:open ~/.bash_profile</h3><h3 id="3-最后面加入环境配置："><a href="#3-最后面加入环境配置：" class="headerlink" title="3.最后面加入环境配置："></a>3.最后面加入环境配置：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export MAVEN_HOME=/Users/pc/apache-maven-3.6.1</span><br><span class="line">export PATH=$PATH:$MAVEN_HOME/bin</span><br></pre></td></tr></table></figure><h3 id="4-使配置生效"><a href="#4-使配置生效" class="headerlink" title="4.使配置生效"></a>4.使配置生效</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source .bash_profile</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Maven </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Maven </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Intellij IDEA安装</title>
      <link href="/2019/04/28/Intellij-IDEA%E5%AE%89%E8%A3%85/"/>
      <url>/2019/04/28/Intellij-IDEA%E5%AE%89%E8%A3%85/</url>
      <content type="html"><![CDATA[<p>IDEA 全称 IntelliJ IDEA，是java编程语言开发的集成环境。IntelliJ在业界被公认为最好的java开发工具之一，尤其在智能代码助手、代码自动提示、重构、J2EE支持、各类版本工具(git、svn等)、JUnit、CVS整合、代码分析、 创新的GUI设计等方面的功能可以说是超常的。<br><a id="more"></a></p><h1 id="1-下载"><a href="#1-下载" class="headerlink" title="1.下载"></a>1.下载</h1><p><a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">https://www.jetbrains.com/idea/</a></p><h1 id="2-安装"><a href="#2-安装" class="headerlink" title="2.安装"></a>2.安装</h1><p>略</p><h1 id="3-激活"><a href="#3-激活" class="headerlink" title="3.激活"></a>3.激活</h1><p>注册码:<a href="http://idea.lanyus.com" target="_blank" rel="noopener">http://idea.lanyus.com</a><br>获取注册码用于激活</p>]]></content>
      
      
        <tags>
            
            <tag> IntelliJ IDEA </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Dagger2 - 进阶</title>
      <link href="/2018/05/18/Dagger2%20-%20%E8%BF%9B%E9%98%B6/"/>
      <url>/2018/05/18/Dagger2%20-%20%E8%BF%9B%E9%98%B6/</url>
      <content type="html"><![CDATA[<p>Dagger2 - 基础 讲解了Inject，Component，Module，Provides是如何构成Dagger2整个依赖注入框架。<br>本章讲解Qualifier（限定符），Singleton（单例），Scope（作用域），SubComponent，对Dagger2进行细节上的完善。<br><img src="/2018/05/18/Dagger2 - 进阶/provides.png" alt="modules"></p><a id="more"></a><h1 id="Qualifier（限定符）"><a href="#Qualifier（限定符）" class="headerlink" title="Qualifier（限定符）"></a>Qualifier（限定符）</h1>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android 第三方框架 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Dagger2 - 基础</title>
      <link href="/2018/05/18/Dagger2%20-%20%E5%9F%BA%E7%A1%80/"/>
      <url>/2018/05/18/Dagger2%20-%20%E5%9F%BA%E7%A1%80/</url>
      <content type="html"><![CDATA[<p>Dagger2,它是解决android或java中依赖注入的一个类库（DI类库）。<br>Dagger2能带来哪些好处？<br>Dagger2中的Inject，Component，Module，Provides等等是什么，有什么作用？<br>Dagger2如何使用？<br><a id="more"></a></p><h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><p>依赖注入： 就是目标类（目标类需要进行依赖初始化的类）中所依赖的其他类的初始化过程，不是通过手动编码的方式创建，而是通过技术手段可以吧其他的类的已经初始化好了的实例自动注入到目标类中。</p><h1 id="正式开始"><a href="#正式开始" class="headerlink" title="正式开始"></a>正式开始</h1><h2 id="Inject"><a href="#Inject" class="headerlink" title="Inject"></a>Inject</h2><p>先看一段代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class A&#123;</span><br><span class="line">B b = new B(...);</span><br><span class="line">C c = new C();</span><br><span class="line">D d = new D(new E());</span><br><span class="line">F f = new F(.....);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>上面代码在做重复工作，new B() new C()…  </p><p>我们可以用注解来标注目标类中所依赖的其他类，同样用注解来标注所依赖的其他类的构造函数，那注解的名字就叫Inject<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class A&#123;</span><br><span class="line">@Inject</span><br><span class="line">B b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class B&#123;</span><br><span class="line">@Inject</span><br><span class="line">public B()&#123;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>这样我们就可以让目标类中所依赖的其他类与其他类的构造函数有一种联系。Component就是他们联系的桥梁。</p><h2 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h2><p>Component也是一个注解类，一个类要想是Component，必须用Component注解来标注该类，并且该类是抽象类或接口。<br>Component是目标类所依赖的其他类和其他类的构造函数直接的桥梁，那么Component需要引用到目标类的实例，Component会查找目标类中用Inject注解标注的属性，查找到相应的属性后会接着查找该属性对应的用Inject标注的构造函数（此时就发生了联系），剩下的工作就是初始化该属性的实例并把实例进行赋值。因此我们也可以给Component就另一个名字注入器（Injector）。<br><img src="/2018/05/18/Dagger2 - 基础/injector.png" alt="Injector"></p><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>目标类要想初始化自己所依赖的其他类：</p><ul><li>用Inject注解标注目标类的其他类</li><li>用Inject注解标注其他类的构造函数（若其他类还依赖于别的类，重复1 2步骤）</li><li>调用Component（注入器）的injectXXX（Object）方法开始注入（injectXXX方法名字是官方推荐的名字，以inject开始）</li></ul><p>Component现在是一个注入器，Component会把目标类依赖的实例注入到目标类中，并初始化目标类的依赖。</p><h2 id="为啥又有个Module"><a href="#为啥又有个Module" class="headerlink" title="为啥又有个Module"></a>为啥又有个Module</h2><p>如果项目中用到第三方的类库，就不能修改第三方类库，所以不可能把Inject注解加入到这些类中，此时Inject就失效了。  </p><p>那我们怎么封装第三方类库呢，于是Module就派上用场了。<br>可以把封装第三方类库的代码放到Module中：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Module</span><br><span class="line">public class ModuleClass&#123;</span><br><span class="line">//A是第三方类库中的一个类</span><br><span class="line">A provideA()&#123;</span><br><span class="line">return A();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Module其实是一个简单工厂模式，Module里面的方法基本都是创建类实例的方法。<br>问题：Component注入器，如何让Component与Module产生联系？</p><h2 id="Component新职责"><a href="#Component新职责" class="headerlink" title="Component新职责"></a>Component新职责</h2><p>Component是注入器，它一端连接目标类，另一端连接目标类的依赖实例，它把目标类实例注入到目标类中。<br>上文中的Module是一个提供类实例的类，所有它是属于Component的实例端的，Component的新职责是管理Module，Component中的modules属性可以把Module加入到Component中，modules可以加入多个Module。<br><img src="/2018/05/18/Dagger2 - 基础/modules.png" alt="modules"></p><h2 id="Provides-最终解决第三方类库依赖注入问题"><a href="#Provides-最终解决第三方类库依赖注入问题" class="headerlink" title="Provides 最终解决第三方类库依赖注入问题"></a>Provides 最终解决第三方类库依赖注入问题</h2><p>Module中创建类实例方法用Provides进行标注，Component在搜索到目标类中用Inject注解标注的属性后，Component就会去Module中查找用Provides标注的对应的创建类实例方法，这样就解决了第三方类库用Dagger2实现依赖注入了。</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>Inject，Component，Module，Provides是Dagger2中最基础最核心的内容。奠定了Dagger2的整个依赖注入框架。</p><ul><li>Inject用于标注目标类的依赖，和依赖的构造函数</li><li>Component是个桥梁，连接目标类和目标类的依赖的实例，它也是注入器负责把目标类的依赖的实例注入到目标类中，同时管理Module。</li><li>Module和Provides是为了解决第三方类库而生的，Module是一个简单工厂模式，Module可以包含创建类实例的方法，这些方法用Provides来标注</li></ul><p><img src="/2018/05/18/Dagger2 - 基础/provides.png" alt="provides"></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android 第三方框架 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>多渠道打包</title>
      <link href="/2018/05/08/%E5%A4%9A%E6%B8%A0%E9%81%93%E6%89%93%E5%8C%85/"/>
      <url>/2018/05/08/%E5%A4%9A%E6%B8%A0%E9%81%93%E6%89%93%E5%8C%85/</url>
      <content type="html"><![CDATA[<h1 id="1-多渠道打包（gradle）"><a href="#1-多渠道打包（gradle）" class="headerlink" title="1.多渠道打包（gradle）"></a>1.多渠道打包（gradle）</h1><h2 id="1-替换channel"><a href="#1-替换channel" class="headerlink" title="1.替换channel"></a>1.替换channel</h2><p>1.在AndroidManifest.xml中添加占位符(友盟统计渠道)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta-data</span><br><span class="line">android:name=&quot;MTA_CHANNEL&quot;</span><br><span class="line">android:value=&quot;$&#123;MTA_CHANNEL_VALUE&#125;&quot; /&gt;</span><br></pre></td></tr></table></figure></p><p>2.在app的build.gradle中添加代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">productFlavors &#123;//需要哪些渠道都写进来</span><br><span class="line">        baidu &#123;&#125;</span><br><span class="line">        _91 &#123;&#125;//不可使用数字开头</span><br><span class="line">        wandoujia &#123;&#125;</span><br><span class="line">        xiaomi &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //批量处理</span><br><span class="line">    productFlavors.all &#123;//替换在AndroidManifest.xml中的$&#123;MTA_CHANNEL_VALUE&#125;</span><br><span class="line">        flavor -&gt; flavor.manifestPlaceholders = [MTA_CHANNEL_VALUE: name]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>3.打包<br>build -&gt; Generate Signed APK<br><img src="/2018/05/08/多渠道打包/1.png" alt="全选Flavors"><br>打出来的包位置<br><img src="/2018/05/08/多渠道打包/2.png" alt="全选Flavors">  </p><h2 id="2-更改包名"><a href="#2-更改包名" class="headerlink" title="2.更改包名"></a>2.更改包名</h2><p>当需要更改包名，在productFlavors中指定不同的applicationId即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">productFlavors &#123;</span><br><span class="line">baidu &#123;</span><br><span class="line">applicationId=&quot;com.aimerd.channel.baidu&quot;</span><br><span class="line">&#125;</span><br><span class="line">_91 &#123;</span><br><span class="line">applicationId=&quot;com.aimerd.channel.jiuyi&quot;</span><br><span class="line">&#125;</span><br><span class="line">wandoujia &#123;</span><br><span class="line">applicationId=&quot;com.aimerd.channel.wandoujia&quot;</span><br><span class="line">&#125;</span><br><span class="line">xiaomi &#123;</span><br><span class="line">applicationId=&quot;com.aimerd.channel.xiaomi&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">//  批量处理</span><br><span class="line">productFlavors.all &#123;</span><br><span class="line">flavor -&gt; flavor.manifestPlaceholders = [MTA_CHANNEL_VALUE: name]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="3-生成不同应用名称和图标"><a href="#3-生成不同应用名称和图标" class="headerlink" title="3.生成不同应用名称和图标"></a>3.生成不同应用名称和图标</h2><p>我们以baidu为例，在app模块src目录下，新建一个”baidu”目录（名字和productFlavors中定义的要一致）<br>目录结构<br><img src="/2018/05/08/多渠道打包/3.png" alt="baidu目录结构  "><br>如果需要换图标，只需更换ic_launcher.png文件即可。  </p><p>把values下strings.xml中的”app_name”改成自己想要的应用名称。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">    &lt;string name=&quot;app_name&quot;&gt;Dragger2_baidu&lt;/string&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure></p><h1 id="2-多渠道打包（美团替换文件）"><a href="#2-多渠道打包（美团替换文件）" class="headerlink" title="2.多渠道打包（美团替换文件）"></a>2.多渠道打包（美团替换文件）</h1><p>引用 美团Android自动化之旅—生成渠道包 <a href="https://tech.meituan.com/mt-apk-packaging.html" title="美团Android自动化之旅—生成渠道包" target="_blank" rel="noopener">https://tech.meituan.com/mt-apk-packaging.html</a></p><p>工具包及使用 <a href="https://gitee.com/welau/multichannel_packaging_channel" title="welau utils" target="_blank" rel="noopener">https://gitee.com/welau/multichannel_packaging_channel</a></p><p>复制ChannelUtils到项目中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String aDefault = ChannelUtils.getChannel(this);</span><br><span class="line">Toast.makeText(this,aDefault,Toast.LENGTH_SHORT).show();//即可获取到channel</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android 打包 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>robolectric-测试</title>
      <link href="/2018/05/08/robolectric-%E6%B5%8B%E8%AF%95/"/>
      <url>/2018/05/08/robolectric-%E6%B5%8B%E8%AF%95/</url>
      <content type="html"><![CDATA[<p>robolectric的最大特别是运行测试程序时不需要设备或者模拟器，在电脑中进行就可以了，自然测试程序的运行效率可以大大提升。</p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Robolectric 测试 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Android 屏幕适配</title>
      <link href="/2018/05/06/Android-%E5%B1%8F%E5%B9%95%E9%80%82%E9%85%8D/"/>
      <url>/2018/05/06/Android-%E5%B1%8F%E5%B9%95%E9%80%82%E9%85%8D/</url>
      <content type="html"><![CDATA[<p>dp适配</p><p>参考：<a href="https://www.jianshu.com/p/1302ad5a4b04" target="_blank" rel="noopener">ScreenMatch屏幕适配</a></p><a id="more"></a>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Android 图片加载框架</title>
      <link href="/2018/04/23/Android-%E5%9B%BE%E7%89%87%E5%8A%A0%E8%BD%BD%E6%A1%86%E6%9E%B6/"/>
      <url>/2018/04/23/Android-%E5%9B%BE%E7%89%87%E5%8A%A0%E8%BD%BD%E6%A1%86%E6%9E%B6/</url>
      <content type="html"><![CDATA[<p>三大图片加载框架</p><ul><li>Picasso</li><li>Glide</li><li>Fresco</li></ul><a id="more"></a><h1 id="Picasso"><a href="#Picasso" class="headerlink" title="Picasso"></a>Picasso</h1><p>Picasso：和Square的网络库一起能发挥最大作用，因为Picasso可以选择将网络请求的缓存部分交给okhttp实现。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Picasso.with(this)</span><br><span class="line">.load(&quot;url&quot;)</span><br><span class="line">.placeholder(R.mipmap.ic_default)</span><br><span class="line">.into(imageView);</span><br></pre></td></tr></table></figure></p><p>Glide：对Picasso进行包装，而且在他的基础上加了很多的扩展（gif、video等支持）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Glide.with(fragment)</span><br><span class="line">.load(url)</span><br><span class="line">.into(imageView);</span><br></pre></td></tr></table></figure></p><p>Fresco：最大的优势在于5.0以下的bitmap的加载。在5.0以下，Fresco将图片放到一个特别的内存区域（Ashmem区），5.0以上系统默认就是存储在Ashmem区。</p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>SmartRefreshLayout 刷新加载数据（listview，recycleview，webivew...）</title>
      <link href="/2018/04/12/SmartRefreshLayout-%E5%88%B7%E6%96%B0%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%EF%BC%88listview%EF%BC%8Crecycleview%EF%BC%8Cwebivew-%EF%BC%89/"/>
      <url>/2018/04/12/SmartRefreshLayout-%E5%88%B7%E6%96%B0%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%EF%BC%88listview%EF%BC%8Crecycleview%EF%BC%8Cwebivew-%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>引用 <a href="https://github.com/scwang90/SmartRefreshLayout" title="SmartRefreshLayout" target="_blank" rel="noopener">SmartRefreshLayout</a></p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>正如名字所说，SmartRefreshLayout是一个“聪明”或者“智能”的下拉刷新布局，由于它的“智能”，它不只是支持所有的View，还支持多层嵌套的视图结构。它继承自ViewGroup 而不是FrameLayout或LinearLayout，提高了性能。 也吸取了现在流行的各种刷新布局的优点，包括谷歌官方的 SwipeRefreshLayout，其他第三方的 Ultra-Pull-To-Refresh、TwinklingRefreshLayout 。还集成了各种炫酷的 Header 和 Footer。 SmartRefreshLayout的目标是打造一个强大，稳定，成熟的下拉刷新框架，并集成各种的炫酷、多样、实用、美观的Header和Footer。</p><h1 id="功能特点"><a href="#功能特点" class="headerlink" title="功能特点"></a>功能特点</h1><ol><li>支持多点触摸</li><li>支持淘宝二楼和二级刷新</li><li>支持嵌套多层的视图结构 Layout (LinearLayout,FrameLayout…)</li><li>支持所有的 View（AbsListView、RecyclerView、WebView….View）</li><li>支持自定义并且已经集成了很多炫酷的 Header 和 Footer.</li><li>支持和ListView的无缝同步滚动 和 CoordinatorLayout 的嵌套滚动 .</li><li>支持自动刷新、自动上拉加载（自动检测列表惯性滚动到底部，而不用手动上拉）.</li><li>支持自定义回弹动画的插值器，实现各种炫酷的动画效果.</li><li>支持设置主题来适配任何场景的App，不会出现炫酷但很尴尬的情况.</li><li>支持设多种滑动方式：平移、拉伸、背后固定、顶层固定、全屏</li><li>支持所有可滚动视图的越界回弹  </li></ol><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><h2 id="导包"><a href="#导包" class="headerlink" title="导包"></a>导包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;com.scwang.smartrefresh:SmartRefreshLayout:1.1.0-alpha-3&apos;</span><br><span class="line">compile &apos;com.scwang.smartrefresh:SmartRefreshHeader:1.1.0-alpha-3&apos;//没有使用特殊Header，可以不加这行</span><br></pre></td></tr></table></figure><h2 id="xml"><a href="#xml" class="headerlink" title="xml"></a>xml</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;com.scwang.smartrefresh.layout.SmartRefreshLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:id=&quot;@+id/refreshLayout&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line">    &lt;android.support.v7.widget.RecyclerView</span><br><span class="line">        android:id=&quot;@+id/recyclerView&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:overScrollMode=&quot;never&quot;</span><br><span class="line">        android:background=&quot;#fff&quot; /&gt;</span><br><span class="line">&lt;/com.scwang.smartrefresh.layout.SmartRefreshLayout&gt;</span><br></pre></td></tr></table></figure><h2 id="java代码"><a href="#java代码" class="headerlink" title="java代码"></a>java代码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">RefreshLayout refreshLayout = (RefreshLayout)findViewById(R.id.refreshLayout);</span><br><span class="line">refreshLayout.setOnRefreshListener(new OnRefreshListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onRefresh(RefreshLayout refreshlayout) &#123;</span><br><span class="line">        new Handler() &#123;</span><br><span class="line">                &#125;.postDelayed(new Runnable() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    public void run() &#123;</span><br><span class="line">                        refreshLayout.finishRefresh();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, 2000);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">refreshLayout.setOnLoadMoreListener(new OnLoadMoreListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onLoadMore(RefreshLayout refreshlayout) &#123;</span><br><span class="line">        new Handler() &#123;</span><br><span class="line">                &#125;.postDelayed(new Runnable() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    public void run() &#123;</span><br><span class="line">                        refreshLayout.finishLoadMore();</span><br><span class="line">                        //adapter.update(getList());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, 2000);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="属性设置"><a href="#属性设置" class="headerlink" title="属性设置"></a>属性设置</h2><p><a href="https://github.com/scwang90/SmartRefreshLayout/blob/master/art/md_property.md" title="属性" target="_blank" rel="noopener">属性设置</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">refreshLayout.setPrimaryColorsId(R.color.colorPrimary, android.R.color.white);//颜色设置</span><br><span class="line">refreshLayout.setDragRate(0.5f);//阻尼效果</span><br><span class="line">refreshLayout.setHeaderHeight(60);//Header高度dp</span><br><span class="line">refreshLayout.setFooterHeight(40);//Footer高度dp</span><br></pre></td></tr></table></figure></p><h2 id="Header-Footer-设置"><a href="#Header-Footer-设置" class="headerlink" title="Header Footer 设置"></a>Header Footer 设置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//设置指定的 Header 和 Footer</span><br><span class="line">//设置 Header 为 贝塞尔雷达 样式</span><br><span class="line">refreshLayout.setRefreshHeader(new ClassicsHeader(this).setTimeFormat(new SimpleDateFormat(&quot;上次更新 HH:mm:ss&quot;)));</span><br><span class="line">//设置 Footer 为 球脉冲 样式</span><br><span class="line">refreshLayout.setRefreshFooter(new BallPulseFooter(this));</span><br></pre></td></tr></table></figure><h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><p><img src="/2018/04/12/SmartRefreshLayout-刷新加载数据（listview，recycleview，webivew-）/1.gif" alt=""></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android 第三方框架 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>EventBus 使用</title>
      <link href="/2018/03/06/EventBus-%E4%BD%BF%E7%94%A8/"/>
      <url>/2018/03/06/EventBus-%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>EventBus是一款针对Android优化的发布/订阅事件总线。简化了应用程序内各组件间、组件与后台线程间的通信。优点是开销小，代码更优雅，以及将发送者和接收者解耦。如果Activity和Activity进行交互还好说，如果Fragment和Fragment进行交互着实令人头疼，我们会使用广播来处理，但是使用广播稍显麻烦并且效率也不高，如果传递的数据是实体类需要序列化，那么很显然成本会有点高。今天我们就来学习下EventBus3.0的使用方法。</p><h1 id="EventBus的三要素"><a href="#EventBus的三要素" class="headerlink" title="EventBus的三要素"></a>EventBus的三要素</h1><ol><li>Event:事件，可以是任意类型的对象</li><li>Subscriber:事件订阅者，事件处理的方法可以随便命名，需要价格注解@Subscribe,并且要指定线程模型（默认为POSTING）</li><li>Publisher：事件发布者，EventBus.getDefault().post()</li></ol><h1 id="EventBus的5种ThreadMode-线程模型"><a href="#EventBus的5种ThreadMode-线程模型" class="headerlink" title="EventBus的5种ThreadMode(线程模型)"></a>EventBus的5种ThreadMode(线程模型)</h1><ol><li>POSTING(默认)：事件在哪个线程发出，事件就在哪个线程处理</li><li>MAIN：事件处理会在UI线程中执行。事件处理时间不能太长（ANR），阻塞式</li><li>MAIN_ORDERED:事件处理会在UI线程中执行,非阻塞式</li><li>BACKGROUND:事件发出在UI线程时，处理在新线程中运行；事件发出在子线程，处理在该子线程</li><li>AYSNC:无论事件在哪个线程发出，处理都会在新建的子线程中运行</li></ol><h1 id="EventBus基本用法"><a href="#EventBus基本用法" class="headerlink" title="EventBus基本用法"></a>EventBus基本用法</h1><ol><li><p>导包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;org.greenrobot:eventbus:3.1.1&apos;</span><br></pre></td></tr></table></figure></li><li><p>自定义一个事件类</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class MessageEvent &#123;</span><br><span class="line"></span><br><span class="line">    private String msg;</span><br><span class="line"></span><br><span class="line">    public MessageEvent(String msg) &#123;</span><br><span class="line">        this.msg = msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getMsg() &#123;</span><br><span class="line">        return msg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在需要订阅事件的地方注册事件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventBus.getDefault.regist(this);</span><br></pre></td></tr></table></figure></li><li><p>取消事件订阅</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventBus.getDefault.unregist(this);</span><br></pre></td></tr></table></figure></li><li><p>发送事件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventBus.getDefault().post(new MessageEvent(&quot;发送事件&quot;));</span><br></pre></td></tr></table></figure></li><li><p>处理事件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Subscribe(threadMode = ThreadMode.MAIN_ORDERED)</span><br><span class="line">public void XXX(MessageEvent messageEvent) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h1 id="EventBus-应用"><a href="#EventBus-应用" class="headerlink" title="EventBus 应用"></a>EventBus 应用</h1><ol><li>添加依赖</li><li>定义消息事件类</li><li><p>注册，取消订阅事件，事件处理事件 （都在MainActivity类中，就写一起了）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private TextView tv;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        EventBus.getDefault().register(this);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        tv = findViewById(R.id.tv);</span><br><span class="line">        tv.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">                startActivity(new Intent(MainActivity.this, SecActivity.class));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onDestroy() &#123;</span><br><span class="line">        super.onDestroy();</span><br><span class="line">        EventBus.getDefault().unregister(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Subscribe(threadMode = ThreadMode.MAIN_ORDERED)</span><br><span class="line">    public void cal(MessageEvent messageEvent)&#123;</span><br><span class="line">        tv.setText(messageEvent.getMsg());</span><br><span class="line">        Toast.makeText(this,messageEvent.getMsg(),Toast.LENGTH_LONG).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>事件发布(为了简写：SecActivity 进入就发布)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class SecActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(@Nullable Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">        EventBus.getDefault().post(new MessageEvent(&quot;SecActivity ~&quot;));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>看看效果：<br><img src="/2018/03/06/EventBus-使用/1.gif" alt=""><br>点击MainActivity的“helloworld” 进入 SecActivity，SecActivity onCreate（）中 post发布事件，MainActivity cal()执行，“helloworld”被改成“SecActivity ~”，同时Toast “SecActivity ~”</p><h1 id="粘性事件"><a href="#粘性事件" class="headerlink" title="粘性事件"></a>粘性事件</h1><p>除了上面讲的普通事件外，EventBus还支持发送黏性事件，就是在发送事件之后再订阅该事件也能收到该事件，跟黏性广播类似。为了验证粘性事件我们修改以前的代码：</p><h3 id="订阅粘性事件"><a href="#订阅粘性事件" class="headerlink" title="订阅粘性事件"></a>订阅粘性事件</h3><p>在MainActivity中我们将注册事件移到到button的点击事件中：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bt_subscription.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">                //注册事件</span><br><span class="line">                EventBus.getDefault().register(MainActivity.this);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></p><h3 id="订阅者处理粘性事件"><a href="#订阅者处理粘性事件" class="headerlink" title="订阅者处理粘性事件"></a>订阅者处理粘性事件</h3><p>在MainActivity中新写一个方法用来处理粘性事件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Subscribe(threadMode = ThreadMode.POSTING，sticky = true)</span><br><span class="line">    public void ononMoonStickyEvent(MessageEvent messageEvent)&#123;</span><br><span class="line">        tv_message.setText(messageEvent.getMessage());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><h3 id="发送黏性事件"><a href="#发送黏性事件" class="headerlink" title="发送黏性事件"></a>发送黏性事件</h3><p>在SecondActivity中发送粘性事件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventBus.getDefault().postSticky(new MessageEvent(&quot;粘性事件&quot;));</span><br></pre></td></tr></table></figure></p><h1 id="混淆"><a href="#混淆" class="headerlink" title="混淆"></a>混淆</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-keepattributes *Annotation*</span><br><span class="line">-keepclassmembers class * &#123;</span><br><span class="line">    @org.greenrobot.eventbus.Subscribe &lt;methods&gt;;</span><br><span class="line">&#125;</span><br><span class="line">-keep enum org.greenrobot.eventbus.ThreadMode &#123; *; &#125;</span><br><span class="line"> </span><br><span class="line"># Only required if you use AsyncExecutor</span><br><span class="line">-keepclassmembers class * extends org.greenrobot.eventbus.util.ThrowableFailureEvent &#123;</span><br><span class="line">    &lt;init&gt;(java.lang.Throwable);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android 第三方框架 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Retrofit-RxJava-OkHttp基础篇</title>
      <link href="/2018/01/06/Retrofit-RxJava-OkHttp%E5%9F%BA%E7%A1%80%E7%AF%87/"/>
      <url>/2018/01/06/Retrofit-RxJava-OkHttp%E5%9F%BA%E7%A1%80%E7%AF%87/</url>
      <content type="html"><![CDATA[<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>Retrofit: Retrofit是Square 公司开发的一款正对Android 网络请求的框架。底层基于OkHttp 实现，OkHttp 已经得到了google 官方的认可。<a href="http://square.github.io/retrofit/" title="Retrofit官网" target="_blank" rel="noopener">Retrofit官网</a></p><p>OkHttp: 也是Square 开源的网络请求库</p><p>RxJava:RxJava 在 GitHub 主页上的自我介绍是 “a library for composing asynchronous and event-based programs using observable sequences for the Java VM”（一个在 Java VM 上使用可观测的序列来组成异步的、基于事件的程序的库）。这就是 RxJava ，概括得非常精准。总之就是让异步操作变得非常简单。</p><p>各自的职责：Retrofit 负责请求的数据和请求的结果，使用接口的方式呈现，OkHttp 负责请求的过程，RxJava 负责异步，各种线程之间的切换。</p><p>RxJava + Retrofit + okHttp 已成为当前Android 网络请求最流行的方式。</p><h1 id="Retrofit-写一个网络请求"><a href="#Retrofit-写一个网络请求" class="headerlink" title="Retrofit 写一个网络请求"></a>Retrofit 写一个网络请求</h1><p>以获取豆瓣 Top250 榜单为例，地址：<a href="https://api.douban.com/v2/movie/" target="_blank" rel="noopener">https://api.douban.com/v2/movie/</a></p><ol><li><p>导包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//rxjava相关依赖</span><br><span class="line">compile &apos;io.reactivex:rxjava:1.2.1&apos;</span><br><span class="line">compile &apos;io.reactivex:rxandroid:1.2.1&apos;</span><br><span class="line">//retrofit相关依赖</span><br><span class="line">compile &apos;com.squareup.retrofit2:retrofit:2.1.0&apos;</span><br><span class="line">compile &apos;com.squareup.retrofit2:converter-gson:2.1.0&apos;</span><br><span class="line">compile &apos;com.squareup.retrofit2:adapter-rxjava:2.1.0&apos;</span><br><span class="line">//okhttp相关依赖</span><br><span class="line">compile &apos;com.squareup.okhttp3:okhttp:3.4.1&apos;</span><br><span class="line">compile &apos;com.squareup.okhttp3:logging-interceptor:3.4.1&apos;</span><br></pre></td></tr></table></figure></li><li><p>创建一个Retrofit实例，并且完成相关的配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">                .baseUrl(BASE_URL)</span><br><span class="line">                .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">                .build();</span><br></pre></td></tr></table></figure></li></ol><p><em>说明：配置了接口的baseurl和一个converter，GsonConverterFactory是默认的Gson转换器，也支持其他转换器</em></p><h2 id="创建接受结果的javabean"><a href="#创建接受结果的javabean" class="headerlink" title="创建接受结果的javabean"></a>创建接受结果的javabean</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class MovieSubject &#123;</span><br><span class="line"></span><br><span class="line">    public String title;</span><br><span class="line">    public String start;</span><br><span class="line">    public String total;</span><br><span class="line">    public String count;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;MovieSubject&#123;&quot; +</span><br><span class="line">                &quot;title=&apos;&quot; + title + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, start=&apos;&quot; + start + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, total=&apos;&quot; + total + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, count=&apos;&quot; + count + &apos;\&apos;&apos; +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>创建一个接口<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface Service &#123;</span><br><span class="line"></span><br><span class="line">    @GET(&quot;top250&quot;)</span><br><span class="line">    Call&lt;MovieSubject&gt; getTop250(@Query(&quot;start&quot;) int start,@Query(&quot;count&quot;) int count);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p><em>说明：定义一个方法getTop250，使用get请求方式（@GET标签），标签后面是这个接口的尾址top250，完整的地址应该是baseUrl+尾址，参数使用@Query标签，如果参数多的话可以使用@QueryMap标签，接受一个Map</em></p><h2 id="用Retrofit创建接口实例MoveService，并且调用接口中的方法进行网络请求"><a href="#用Retrofit创建接口实例MoveService，并且调用接口中的方法进行网络请求" class="headerlink" title="用Retrofit创建接口实例MoveService，并且调用接口中的方法进行网络请求"></a>用Retrofit创建接口实例MoveService，并且调用接口中的方法进行网络请求</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//retrofit创建接口实例</span><br><span class="line">Service service = retrofit.create(Service.class);</span><br><span class="line">//调用getTop250方法</span><br><span class="line">Call&lt;MovieSubject&gt; top250 = service.getTop250(0, 5);</span><br><span class="line">//进行网络请求</span><br><span class="line">top250.enqueue(new Callback&lt;MovieSubject&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void onResponse(Call&lt;MovieSubject&gt; call, Response&lt;MovieSubject&gt; response) &#123;</span><br><span class="line">Log.d(&quot;TAG&quot;,&quot;onResponse: &quot;+response.body().toString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void onFailure(Call&lt;MovieSubject&gt; call, Throwable t) &#123;</span><br><span class="line">Log.d(&quot;TAG&quot;,&quot;onFailure&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="POST请求"><a href="#POST请求" class="headerlink" title="POST请求"></a>POST请求</h1><p>上面的是GET请求，下面将它换成POST请求<br>修改MoveService类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public interface Service &#123;</span><br><span class="line"></span><br><span class="line">    @FormUrlEncoded //使用POST必须加上此标签</span><br><span class="line">    @POST(&quot;top250&quot;)</span><br><span class="line">    Call&lt;MovieSubject&gt; getTop250(@Field(&quot;start&quot;) int start, @Field(&quot;count&quot;) int count);//@Query 改成了 @Field</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="配合RxJava使用"><a href="#配合RxJava使用" class="headerlink" title="配合RxJava使用"></a>配合RxJava使用</h1><ol><li><p>更改定义的接口，返回值Call-&gt;Observable</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface Service &#123;</span><br><span class="line"></span><br><span class="line">    @GET(&quot;top250&quot;)</span><br><span class="line">    Observable&lt;MovieSubject&gt; getTop250(@Query(&quot;start&quot;) int start, @Query(&quot;count&quot;) int count);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>创建Retrofit时添加代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addCallAdapterFactory(RxJavaCallAdapterFactory.create())</span><br></pre></td></tr></table></figure></li><li><p>Subscriber订阅</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//retrofit创建接口实例</span><br><span class="line">Service service = retrofit.create(Service.class);</span><br><span class="line">service.getTop250(0,5)</span><br><span class="line">.subscribeOn(Schedulers.io())</span><br><span class="line">.observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">.subscribe(new Subscriber&lt;MovieSubject&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void onCompleted() &#123;</span><br><span class="line">Log.d(TAG,&quot;onCompleted&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void onError(Throwable e) &#123;</span><br><span class="line">Log.d(TAG,&quot;onError: &quot;+e.toString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void onNext(MovieSubject movieSubject) &#123;</span><br><span class="line">Log.d(TAG,&quot;onNext: &quot;+movieSubject.title);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ol><p><em>以上加入RxJava后的网络请求，返回的不再是Call，而是一个Observable，在Activity或Fragment中传入一个Subscriber建立订阅关系，就可以在onNext中处理结果了。<br>RxJava的好处是处理线程间的切换</em></p><h1 id="加入OkHttp配置"><a href="#加入OkHttp配置" class="headerlink" title="加入OkHttp配置"></a>加入OkHttp配置</h1><p>通过OkHttpClient可以配置很多东西，比如超时，缓存，拦截器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">OkHttpClient.Builder builder = new OkHttpClient.Builder()</span><br><span class="line">.connectTimeout(60, TimeUnit.SECONDS);</span><br><span class="line"></span><br><span class="line">//拦截器</span><br><span class="line">builder.addInterceptor(new BasicParamsInterceptop());</span><br></pre></td></tr></table></figure></p><h2 id="拦截器-应用拦截器添加公共参数"><a href="#拦截器-应用拦截器添加公共参数" class="headerlink" title="拦截器(应用拦截器添加公共参数)"></a>拦截器(应用拦截器添加公共参数)</h2><ol><li>新建类BasicParamsInterceptop implements Interceptor实现intercept方法</li><li>添加公共参数参数<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public Response intercept(Chain chain) throws IOException &#123;</span><br><span class="line">Request request = chain.request();</span><br><span class="line">String method = request.method();</span><br><span class="line">Log.d(TAG,&quot;method :&quot;+method);</span><br><span class="line"></span><br><span class="line">//添加headder</span><br><span class="line">request = request.newBuilder()</span><br><span class="line">.addHeader(&quot;channel&quot;,&quot;android&quot;).build();</span><br><span class="line"></span><br><span class="line">//GET请求</span><br><span class="line">if (method.equals(&quot;GET&quot;))&#123;</span><br><span class="line">HttpUrl httpUrl = request.url().newBuilder()</span><br><span class="line">                    .addQueryParameter(&quot;version&quot;, &quot;version&quot;)</span><br><span class="line">                    .build();</span><br><span class="line">request = request.newBuilder().url(httpUrl).build();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//POST请求</span><br><span class="line">if(method.equals(&quot;POST&quot;))&#123;</span><br><span class="line">if (request.body() instanceof FormBody)&#123;</span><br><span class="line">FormBody.Builder builder = new FormBody.Builder();</span><br><span class="line"></span><br><span class="line">//把原来的参数添加到新的构造器</span><br><span class="line">FormBody request_formBody = (FormBody) request.body();</span><br><span class="line">for (int i=0;i&lt;request_formBody.size();i++)&#123;</span><br><span class="line">builder.addEncoded(request_formBody.encodedName(i),request_formBody.encodedValue(i));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//添加新的参数</span><br><span class="line">builder.add(&quot;type&quot;,&quot;app&quot;);</span><br><span class="line">request = request.newBuilder().post(builder.build()).build();</span><br><span class="line">&#125;</span><br><span class="line">//打印参数</span><br><span class="line">FormBody body = (FormBody) request.body();</span><br><span class="line">for (int i=0;i&lt;body.size();i++)&#123;</span><br><span class="line">Log.d(TAG,&quot;new_body :&quot;+body.encodedName(i));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return chain.proceed(request);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android 第三方框架 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>RxJava + Retrofit 完成网络请求</title>
      <link href="/2017/11/29/RxJava-Retrofit-%E5%AE%8C%E6%88%90%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/"/>
      <url>/2017/11/29/RxJava-Retrofit-%E5%AE%8C%E6%88%90%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/</url>
      <content type="html"><![CDATA[<h1 id="RxJava使用"><a href="#RxJava使用" class="headerlink" title="RxJava使用"></a>RxJava使用</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>一个在Java VM上使用可观测的序列来组成异步的,基于事件的程序的库.<br>简单说它就是一个实现异步操作的库.</p><h2 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h2><ol><li>观察者: 监视被观察者的行为,当被观察组某个状态改变的时候会通知观察者,观察组执行对应的操作;</li><li>被观察者: 被监视的对象</li><li>订阅(或注册): 将观察者和被观察者建立联系</li></ol><p>例子: 按钮点击事件(OnClickListener中的onClick()事件)</p><ol><li>观察者: OnClickListener;  </li><li>被观察者: Button;  </li><li>订阅(或注册): setOnClickListener();  </li></ol><p>对应RxJava中</p><ol><li>观察者: Observer;</li><li>被观察者: Observable;</li><li>订阅(或注册): subscribe;</li></ol><h3 id="观察者"><a href="#观察者" class="headerlink" title="观察者"></a>观察者</h3><p>Observer 即观察者,它决定事件触发的时候将有怎样的行为.<br>RxJava 观察者的事件回调方法除了普通事件onNext()[相当于onClick()/onEvent()]之外,还定义了两个特殊的事件:onCompleted()和onError().</p><ol><li>onCompleted() 事件队列完结.RxJava不仅把每个事件单独处理,还会把它们看成一个队列.RxJava规定,当不会再有新的onNext()发出时,需要触发onCompleted()方法作为标示.</li><li>onError() 事件队列异常.在事件处理过程中出现异常时,onError()会被触发,同时队列自动终止,不允许再有事件发出.</li><li>在一个正确运行的事件序列中,onCompleted()和onError()有且只有一个,并且是事件序列中的最后一个.onCompleted()和onError()在队列中只会调用其中一个.</li></ol><h3 id="被观察者"><a href="#被观察者" class="headerlink" title="被观察者"></a>被观察者</h3><p>Observable 即被观察者,它决定什么时候触发事件以及触发怎样的事件.可以使用create(),just(T…),from(T[]),from(Iterable&lt;? extends T&gt;)来创建一个Observable,并为它定义事件触发规则.</p><h3 id="订阅"><a href="#订阅" class="headerlink" title="订阅"></a>订阅</h3><p>创建了Observable 和 Observer之后,再用subscribe()方法将他们连接起来</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>1.导包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;io.reactivex:rxjava:1.0.14&apos;</span><br><span class="line">compile &apos;io.reactivex:rxandroid:1.0.1</span><br></pre></td></tr></table></figure></p><p>2.创建一个观察者<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Observer&lt;String&gt; observer = new Observer&lt;String&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void onCompleted() &#123;</span><br><span class="line">Log.i(TAG, &quot;Completed&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">public void onError(Throwable e) &#123;</span><br><span class="line">Log.i(TAG, &quot;Error&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">public void onNext(String s) &#123;</span><br><span class="line">Log.i(TAG, s);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>3.创建被观察者<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Observable observable1 = Observable.create(new  Observable.OnSubscribe&lt;String&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void call(Subscriber&lt;? super String&gt; subscriber) &#123;</span><br><span class="line">subscriber.onNext(&quot;Hello&quot;);</span><br><span class="line">subscriber.onNext(&quot;Wrold&quot;);</span><br><span class="line">subscriber.onCompleted();</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>4.订阅<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">observable1.subscribe(observer);</span><br></pre></td></tr></table></figure></p><p>5.Observable其它几种创建方法</p><ol><li><p>Observable.just()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Observable observable = Observable.just(&quot;hi&quot;, &quot;le&quot;, &quot;ho&quot;);</span><br></pre></td></tr></table></figure></li><li><p>Observable.from()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = new ArrayList&lt;String&gt;();</span><br><span class="line">list.add(&quot;Hellow&quot;);</span><br><span class="line">list.add(&quot;Wrold&quot;);</span><br><span class="line">String [] words = &#123;&quot;Hello&quot;, &quot;World&quot;&#125;;</span><br><span class="line">Observable observable3 = Observable.from(words|list);</span><br></pre></td></tr></table></figure></li></ol><h2 id="RxJava-Action-使用"><a href="#RxJava-Action-使用" class="headerlink" title="RxJava Action 使用"></a>RxJava Action 使用</h2><p>回顾上节知识,介绍RxJava基本用法<br>例:分别打印”hello” “world”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Observable.just(&quot;hello&quot;,&quot;world&quot;)</span><br><span class="line">.subscribe(new Subscriber&lt;String&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void onCompleted() &#123;</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">public void onError(Throwable e) &#123;</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">public void onNext(String s) &#123;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>从上面可以看出我们只用了onNext(obj),还有两个重新的onError()和onCompleted()并没有用到,可是使用Action代替Subscriber.</p><h3 id="Action代替Subscriber"><a href="#Action代替Subscriber" class="headerlink" title="Action代替Subscriber"></a>Action代替Subscriber</h3><p>用Action代替Subscriber<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Observable.just(&quot;Hello&quot;, &quot;World&quot;)</span><br><span class="line">.subscribe(new Action1&lt;String&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void call(String s) &#123;</span><br><span class="line">Log.i(TAG, s);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h2 id="RxJava-转换-map-flatMap"><a href="#RxJava-转换-map-flatMap" class="headerlink" title="RxJava 转换 -map -flatMap"></a>RxJava 转换 -map -flatMap</h2><h3 id="map"><a href="#map" class="headerlink" title="map"></a>map</h3><p>在使用map之前先了解一个接口: Func1, Func1和上文的Action1相似.Func1和Action1的区别在于,Func1包装的是有返回值的方法.<br>例: 得到多个Studeng对象中的name,保存到nameList中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Observable.just(student1, student2, student2)</span><br><span class="line">                //使用map进行转换，参数1：转换前的类型，参数2：转换后的类型</span><br><span class="line">                .map(new Func1&lt;Student, String&gt;() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    public String call(Student i) &#123;</span><br><span class="line">                        String name = i.getName();//获取Student对象中的name</span><br><span class="line">                        return name;//返回name</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .subscribe(new Action1&lt;String&gt;() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    public void call(String s) &#123;</span><br><span class="line">                        nameList.add(s);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br></pre></td></tr></table></figure></p><p>可以看出Observable中原来的参数是Student对象,而最后我们需要的是name,这里使用了map来实现这一转换的过程.map也可以多次使用</p><h3 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h3><p>flatMap是一个比教难理解的一个转换，在这里先假设一个需求，需要打印多个Student所学的课程。这跟之前获取Student的name又不同了，这里先确定一下关系，一个Student类中只有一个name，而一个Student却有多门课程（Course），Student我们可以理解成这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* 学生类</span><br><span class="line">*/</span><br><span class="line">class Student &#123;</span><br><span class="line">private String name;//姓名</span><br><span class="line">private List&lt;Course&gt; coursesList;//所修的课程</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line">/**</span><br><span class="line">* 课程类</span><br><span class="line">*/</span><br><span class="line">class  Course &#123;</span><br><span class="line">private String name;//课程名</span><br><span class="line">private String id;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>如何使用map实现打印所有学生所修的课程名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Observable.from(students)</span><br><span class="line">.flatMap(new Func1&lt;Student, Observable&lt;Course&gt;&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public Observable&lt;Course&gt; call(Student student) &#123;</span><br><span class="line">return Observable.from(student.getCoursesList());</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">.subscribe(new Action1&lt;Course&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void call(Course course) &#123;</span><br><span class="line">Log.i(TAG, course.getName());</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h2 id="RxJava-线程控制-Scheduler"><a href="#RxJava-线程控制-Scheduler" class="headerlink" title="RxJava 线程控制 - Scheduler"></a>RxJava 线程控制 - Scheduler</h2><p>由Observable发起事件,经过中间的处理后由Observer消费,之前的代码事件发起和消费都是在同一个线程中执行,也就是说之前我们使用的RxJava是同步的<br>而观察者模式本身的目的是后台处理,将处理结果回调给前台<br>上例中flatMap处理是在主线程中进行的,若flatMap中有耗时的操作,这样会导致主线程阻塞  </p><p>Scheduler: 线程控制器,可以指定每一段代码在什么样的线程中执行<br>例: 在新的线程中发起事件,在主线程中消费<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Observable.just(&quot;Hello&quot;, &quot;Word&quot;)</span><br><span class="line">.subscribeOn(Schedulers.newThread())//指定 subscribe() 发生在新的线程</span><br><span class="line">.observeOn(AndroidSchedulers.mainThread())// 指定 Subscriber 的回调发生在主线程</span><br><span class="line">.subscribe(new Action1&lt;String&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void call(String s) &#123;</span><br><span class="line">Log.i(TAG, s);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>上面用到了subscribeOn()发起,observeOn()消费<br>subscribeOn()：指定subscribe() 所发生的线程，即 Observable.OnSubscribe 被激活时所处的线程。或者叫做事件产生的线程.<br>observeOn()：指定Subscriber 所运行在的线程。或者叫做事件消费的线程。  </p><p>多次切换线程<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Observable.just(&quot;hello&quot;,&quot;hi&quot;)</span><br><span class="line">.subscribeOn(Schedulers.newThread())</span><br><span class="line">.observeOn(Schedulers.io())</span><br><span class="line">.filter(new Func1&lt;String, Boolean&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public Boolean call(String s) &#123;</span><br><span class="line">Log.d(TAG,&quot;filter thread: &quot;+Thread.currentThread().getId());</span><br><span class="line">return true;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">.observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">.subscribe(new Action1&lt;String&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void call(String s) &#123;</span><br><span class="line">Log.d(TAG,&quot;Thread: &quot;+Thread.currentThread().getId()+&quot;  &quot;+s);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>可以看出subserveOn()被调用两次,分别指定fliter处理和subscribe消费的线程<br>如果去掉后面的.observeOn(AndroidSchedulers.mainThread()),那么 .subscribe将会在io线程中执行<br>observeOn()可以多次使用，可以随意变换线程</p><h1 id="Retrofit-使用"><a href="#Retrofit-使用" class="headerlink" title="Retrofit 使用"></a>Retrofit 使用</h1><p>Retrofit是Square公司开发的一个类型安全的Java和Android的REST客户端库(A type-safe HTTP client for Android and Java)<br>RestAPI是一种软件设计风格,服务器作为资源存放地.客户端去请求GET POST PUT DELETE…资源.并且是无状态的,没有session的参与.  </p><p>Retrofit模型如下:<br><img src="/2017/11/29/RxJava-Retrofit-完成网络请求/t1.png" alt=""></p><p>1.POJO或模型实体类: 从服务器获取的JSON数据将被填充到这种类的实例中<br>2.接口: 我们需要创建一个接口来管理像GET POST…请求的URL,这是一个服务类.<br>3.RestAdapter类: 这是一个REST客户端(RestClient)类,retrofit中默认用的是Gson来解析JSON数据,你也可以设置自己的JSON解析器.</p><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>在发起请求时,主要通过Call来封装每一次的请求;<br>调用同步方法时,会使用应用线程来发送请求;<br>调用异步方法时,会通过 OkHttp 的 <strong>Dispatcher</strong> 提供的线程来执行请求.  </p><p><em>Dispatcher: r内部实现了懒加载无边界限制的线程池方式，同时该线程池采用了SynchronousQueue这种阻塞队列。SynchronousQueue每个插入操作必须等待另一个线程的移除操作，同样任何一个移除操作都等待另一个线程的插入操作。显然这是一种快速传递元素的方式，也就是说在这种情况下元素总是以最快的方式从插入者（生产者）传递给移除者（消费者），这在多任务队列中是最快处理任务的方式。</em></p><h2 id="Retrofit-使用-1"><a href="#Retrofit-使用-1" class="headerlink" title="Retrofit 使用"></a>Retrofit 使用</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作:"></a>准备工作:</h3><p>1.添加依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;com.squareup.retrofit2:retrofit:2.0.2&apos;</span><br><span class="line">compile &apos;com.squareup.retrofit2:converter-gson:2.0.2&apos;</span><br></pre></td></tr></table></figure></p><p>2.添加权限<br>由于是网络请求,需要添加访问网络权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;</span><br></pre></td></tr></table></figure></p><h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p>1.创建实体类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class User &#123;</span><br><span class="line">private String name;</span><br><span class="line">private String age;</span><br><span class="line">public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">public String getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(String age) &#123;</span><br><span class="line">        this.age = ge</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>创建一个User类, name age<br>POJO的转换推荐使用GsonFormat  </p><p>2.创建Retrofit对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">.addConverterFactory(GsonConverterFactory.create())//解析方法</span><br><span class="line">//这里建议：- Base URL: 总是以/结尾；- @Url: 不要以/开头</span><br><span class="line">.baseUrl(&quot;http://www.xxx.com/&quot;)</span><br><span class="line">.build();</span><br></pre></td></tr></table></figure></p><p>3.接口申明<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public interface Service &#123;</span><br><span class="line">    /**</span><br><span class="line">     * 根据id获取对应的用户数据</span><br><span class="line">     * 如果不需要转换成Json数据,可以用了ResponseBody;</span><br><span class="line">     * @param id</span><br><span class="line">     * @return call</span><br><span class="line">     */</span><br><span class="line">    @GET(&quot;user/&#123;id&#125;&quot;)</span><br><span class="line">    Call&lt;User&gt; getUser(@Path(&quot;id&quot;) String id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>4.创建访问API的请求<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Service api = retrofit.create(Service .class);</span><br><span class="line">Call&lt;User&gt; call = api.getUser(&quot;123456&quot;);</span><br></pre></td></tr></table></figure></p><p>5.调用<br>5.1 同步调用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">News news = call.execute();</span><br></pre></td></tr></table></figure></p><p>5.2 异步调用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">call.enqueue(new Callback&lt;News&gt;()&#123;  </span><br><span class="line">@Override  </span><br><span class="line">public void onResponse(Response&lt;News&gt; response) &#123;  </span><br><span class="line">//成功返回数据后在这里处理，使用response.body();获取得到的结果</span><br><span class="line">News news = response.body();</span><br><span class="line">&#125;  </span><br><span class="line">@Override  </span><br><span class="line">public voidonFailure(Throwable t) &#123;  </span><br><span class="line">//请求失败在这里处理  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>6.取消请求<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call.cancel();</span><br></pre></td></tr></table></figure></p><h1 id="RxJava-Retrofit-结合使用"><a href="#RxJava-Retrofit-结合使用" class="headerlink" title="RxJava + Retrofit 结合使用"></a>RxJava + Retrofit 结合使用</h1><h2 id="单独使用Retrofit"><a href="#单独使用Retrofit" class="headerlink" title="单独使用Retrofit"></a>单独使用Retrofit</h2><p>1.service接口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface MyService &#123;</span><br><span class="line">  @GET(&quot;user/login&quot; )</span><br><span class="line">  Call&lt;UserInfo&gt; login(</span><br><span class="line">          @Query(&quot;username&quot;) String username,</span><br><span class="line">          @Query(&quot;password&quot;) String password</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>2.获取Call执行网络请求<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">.addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">.baseUrl(BASE_URL)</span><br><span class="line">.build();</span><br><span class="line"></span><br><span class="line">MyService service = retrofit.create(MyService.class);</span><br><span class="line"></span><br><span class="line">Call&lt;UserInfo&gt; call = service.login(&quot;1111&quot;, &quot;ssss&quot;);</span><br><span class="line">call.enqueue(new Callback&lt;UserInfo&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void onResponse(Call&lt;UserInfo&gt; call, Response&lt;UserInfo&gt; response) &#123;</span><br><span class="line">//请求成功操作</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">public void onFailure(Call&lt;UserInfo&gt; call, Throwable t) &#123;</span><br><span class="line">//请求失败操作</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h2 id="RxJava-Retrofit-完成网络请求"><a href="#RxJava-Retrofit-完成网络请求" class="headerlink" title="RxJava + Retrofit 完成网络请求"></a>RxJava + Retrofit 完成网络请求</h2><p>1.添加依赖 前四个分别是RxJava、RxAndroid、Retrofit以及Gson的库，最后那个才是新加入的，RxJava + Retrofit的使用需要用到最后那个包。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;io.reactivex:rxjava:x.y.z&apos;</span><br><span class="line">compile &apos;io.reactivex:rxandroid:1.0.1&apos;</span><br><span class="line">compile &apos;com.squareup.retrofit2:retrofit:2.0.2&apos;</span><br><span class="line">compile &apos;com.squareup.retrofit2:converter-gson:2.0.2&apos;</span><br><span class="line">compile &apos;com.squareup.retrofit2:adapter-rxjava:2.0.2&apos;</span><br></pre></td></tr></table></figure></p><p><strong>注意: 最后三个包的版本号必须一样</strong><br>2.修改service(Call改为Observable)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface MyService &#123;</span><br><span class="line">  @GET(&quot;user/login&quot; )</span><br><span class="line">  Observable&lt;UserInfo&gt; login(</span><br><span class="line">          @Query(&quot;username&quot;) String username,</span><br><span class="line">          @Query(&quot;password&quot;) String password</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>3.网络请求<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">.addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">.baseUrl(BASE_URL)</span><br><span class="line">.build();</span><br><span class="line"></span><br><span class="line">MyService service = retrofit.create(MyService.class);</span><br><span class="line"></span><br><span class="line">service.loging(username,password)</span><br><span class="line">.subscribeOn(Schedulers.newThread())//请求在新的线程中执行</span><br><span class="line">.observeOn(Schedulers.io())         //请求完成后在io线程中执行</span><br><span class="line">.doOnNext(new Action1&lt;UserInfo&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void call(UserInfo userInfo) &#123;</span><br><span class="line">saveUserInfo(userInfo);//保存用户信息到本地</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">.observeOn(AndroidSchedulers.mainThread())//最后在主线程中执行</span><br><span class="line">.subscribe(new Subscriber&lt;UserInfo&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void onCompleted() &#123;</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">public void onError(Throwable e) &#123;</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">public void onNext(UserInfo userInfo) &#123;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>Retrofit把请求封装进Observable,在请求结束后调用onNext() onError() 或 onCompleted().<br>在调用service的login方法后得到Observable对象, .subscribeOn(Scheduler.newThread())在新的线程中执行网络请求,请求成功后切换到io线程执行保存用户信息动作,最后再切换到主线程执行请求失败,成功动作.<br>整体逻辑都在一条链中,即使有变更也好添加修改.逻辑清晰.</p><h1 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h1><p><a href="http://www.jianshu.com/p/1fb294ec7e3b" target="_blank" rel="noopener">【Android】RxJava + Retrofit完成网络请求</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android 第三方框架 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>RecyclerView</title>
      <link href="/2017/11/09/RecyclerView/"/>
      <url>/2017/11/09/RecyclerView/</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>谷歌在support v7中,加入了新的控件-RecyclerView用来代替ListView GridView,结合了ListView GridView的特点,并实现了瀑布流效果.</p><h1 id="导包"><a href="#导包" class="headerlink" title="导包"></a>导包</h1><p>需要v7 包支持<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation &apos;com.android.support:appcompat-v7:26.1.0&apos;</span><br></pre></td></tr></table></figure></p><h1 id="几个重要的类"><a href="#几个重要的类" class="headerlink" title="几个重要的类"></a>几个重要的类</h1><ol><li>RecyclerView.Adapter:抽象类，为RecyclerView提供数据，一般根据不同的业务需求来编写具体的实现类。</li><li>RecyclerView.LayoutManager:抽象类，主要用于测量RecyclerView的子Item，以及根据不同的布局方式来实现Item的布局效果，v 7包自带的实现类有：LinearLayoutManager、StaggeredGridLayoutManager、GridLayoutManager…</li><li>RecyclerView.ItemDecoration:抽象类，这个主要用于不同的Item之间添加分割线（可选）。官方没有实现类，所以如果要添加分割线，我们需要手动实现这个抽象类</li><li>RecyclerView.ItemAnimator:抽象类，这个主要用于当一个item添加或者删除的时候出现的动画效果，官方提供一个默认的实现类。如果想要使我们的RecyclerView在添加、删除数据的时候有炫酷的动画，可以实现这个抽象类</li></ol><h1 id="xml布局"><a href="#xml布局" class="headerlink" title="xml布局"></a>xml布局</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;android.support.design.widget.CoordinatorLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.design.widget.AppBarLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;android.support.v7.widget.Toolbar</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;?attr/actionBarSize&quot;</span><br><span class="line">            app:titleTextColor=&quot;@color/white&quot;</span><br><span class="line">            app:title=&quot;RecyclerView&quot;/&gt;</span><br><span class="line">    &lt;/android.support.design.widget.AppBarLayout&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;android.support.v7.widget.RecyclerView</span><br><span class="line">        android:id=&quot;@+id/recyclerview&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/android.support.v7.widget.RecyclerView&gt;</span><br><span class="line"></span><br><span class="line">&lt;/android.support.design.widget.CoordinatorLayout&gt;</span><br></pre></td></tr></table></figure><p>这里使用了4个控件, <a href="/2017/11/08/CoordinatorLayout/" title="CoordinatorLayout">CoordinatorLayout</a>, <a href="/2017/11/08/AppBarLayout/" title="AppBarLayout">AppBarLayout</a>, <a href="/2017/11/06/Toolbar/" title="Toolbar">Toolbar</a><br>和本文的RecyclerView  </p><p>item_recyclerview.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=&quot;@+id/tv_item&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;70dp&quot;</span><br><span class="line">        android:background=&quot;#ccc&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/RelativeLayout&gt;</span><br></pre></td></tr></table></figure></p><p>item布局只有一个TextView, 背景颜色灰色</p><h1 id="java代码-初试"><a href="#java代码-初试" class="headerlink" title="java代码(初试)"></a>java代码(初试)</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RecyclerView recyclerview = findViewById(R.id.recyclerview);</span><br><span class="line">recyclerview.setLayoutManager(new LinearLayoutManager(this,LinearLayoutManager.VERTICAL,false));</span><br><span class="line">MyAdapter myAdapter = new MyAdapter(data);</span><br><span class="line">recyclerview.setAdapter(myAdapter);</span><br></pre></td></tr></table></figure><p>代码解析:<br>recyclerview.setLayoutManager:设置布局管理器  </p><ol><li>LinearLayoutManager 以垂直或水平列表方式展示</li><li>GridLayoutManager 以网格方式展示</li><li>StaggeredGridLayoutManager 以瀑布流方式展示  </li></ol><p>recyclerview.setAdapter:设置适配器,适配器代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">private class MyAdapter extends RecyclerView.Adapter&lt;MyAdapter.ViewHolder&gt;&#123;</span><br><span class="line"></span><br><span class="line">        private ArrayList&lt;String&gt; mData;</span><br><span class="line"></span><br><span class="line">        public MyAdapter(ArrayList&lt;String&gt; data) &#123;</span><br><span class="line">            this.mData = data;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void updateData(ArrayList&lt;String&gt; data) &#123;//用户数据更新</span><br><span class="line">            this.mData = data;</span><br><span class="line">            notifyDataSetChanged();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public MyAdapter.ViewHolder onCreateViewHolder(ViewGroup parent, int viewType) &#123;</span><br><span class="line">//实例化展示的View, </span><br><span class="line">            View inflate = View.inflate(RecyclerViewActivity.this, R.layout.item_recyclerview, null);</span><br><span class="line">//实例化ViewHolder</span><br><span class="line">            ViewHolder viewHolder = new ViewHolder(inflate);</span><br><span class="line">            return viewHolder;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void onBindViewHolder(ViewHolder holder, int position) &#123;</span><br><span class="line">//holder就是onCreateViewHolder返回, 绑定数据</span><br><span class="line">            holder.textView.setText(mData.get(position));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public int getItemCount() &#123;</span><br><span class="line">            return mData.size();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public class ViewHolder extends RecyclerView.ViewHolder&#123;</span><br><span class="line"></span><br><span class="line">            TextView textView;</span><br><span class="line"></span><br><span class="line">            public ViewHolder(View itemView) &#123;</span><br><span class="line">                super(itemView);</span><br><span class="line">                textView = itemView.findViewById(R.id.tv_item);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>效果图:<br><img src="/2017/11/09/RecyclerView/t1.png" alt=""><br>效果和ListView一样,但是item直接没有分割线,xml文件中也不能设置分割线,可以通过mRecyclerView.addItemDecoration()来设置我们定义好的间隔样式.</p><h1 id="添加分割线"><a href="#添加分割线" class="headerlink" title="添加分割线"></a>添加分割线</h1><h2 id="LinearLayoutManager-分割线"><a href="#LinearLayoutManager-分割线" class="headerlink" title="LinearLayoutManager 分割线"></a>LinearLayoutManager 分割线</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">public class DividerItemDecoration extends RecyclerView.ItemDecoration&#123;</span><br><span class="line">    private static final int[] ATTRS = new int[]&#123;</span><br><span class="line">            android.R.attr.listDivider</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    public static final int HORIZONTAL_LIST = LinearLayoutManager.HORIZONTAL;</span><br><span class="line"></span><br><span class="line">    public static final int VERTICAL_LIST = LinearLayoutManager.VERTICAL;</span><br><span class="line"></span><br><span class="line">    private Drawable mDivider;</span><br><span class="line"></span><br><span class="line">    private int mOrientation;</span><br><span class="line"></span><br><span class="line">    public DividerItemDecoration(Context context, int orientation) &#123;</span><br><span class="line">        final TypedArray a = context.obtainStyledAttributes(ATTRS);</span><br><span class="line">        mDivider = a.getDrawable(0);</span><br><span class="line">        a.recycle();</span><br><span class="line">        setOrientation(orientation);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setOrientation(int orientation) &#123;</span><br><span class="line">        if (orientation != HORIZONTAL_LIST &amp;&amp; orientation != VERTICAL_LIST) &#123;</span><br><span class="line">            throw new IllegalArgumentException(&quot;invalid orientation&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        mOrientation = orientation;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onDraw(Canvas c, RecyclerView parent) &#123;</span><br><span class="line">        if (mOrientation == VERTICAL_LIST) &#123;</span><br><span class="line">            drawVertical(c, parent);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            drawHorizontal(c, parent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public void drawVertical(Canvas c, RecyclerView parent) &#123;</span><br><span class="line">        final int left = parent.getPaddingLeft();</span><br><span class="line">        final int right = parent.getWidth() - parent.getPaddingRight();</span><br><span class="line"></span><br><span class="line">        final int childCount = parent.getChildCount();</span><br><span class="line">        for (int i = 0; i &lt; childCount; i++) &#123;</span><br><span class="line">            final View child = parent.getChildAt(i);</span><br><span class="line">            android.support.v7.widget.RecyclerView v = new android.support.v7.widget.RecyclerView(parent.getContext());</span><br><span class="line">            final RecyclerView.LayoutParams params = (RecyclerView.LayoutParams) child</span><br><span class="line">                    .getLayoutParams();</span><br><span class="line">            final int top = child.getBottom() + params.bottomMargin;</span><br><span class="line">            final int bottom = top + mDivider.getIntrinsicHeight();</span><br><span class="line">            mDivider.setBounds(left, top, right, bottom);</span><br><span class="line">            mDivider.draw(c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void drawHorizontal(Canvas c, RecyclerView parent) &#123;</span><br><span class="line">        final int top = parent.getPaddingTop();</span><br><span class="line">        final int bottom = parent.getHeight() - parent.getPaddingBottom();</span><br><span class="line"></span><br><span class="line">        final int childCount = parent.getChildCount();</span><br><span class="line">        for (int i = 0; i &lt; childCount; i++) &#123;</span><br><span class="line">            final View child = parent.getChildAt(i);</span><br><span class="line">            final RecyclerView.LayoutParams params = (RecyclerView.LayoutParams) child</span><br><span class="line">                    .getLayoutParams();</span><br><span class="line">            final int left = child.getRight() + params.rightMargin;</span><br><span class="line">            final int right = left + mDivider.getIntrinsicHeight();</span><br><span class="line">            mDivider.setBounds(left, top, right, bottom);</span><br><span class="line">            mDivider.draw(c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void getItemOffsets(Rect outRect, int itemPosition, RecyclerView parent) &#123;</span><br><span class="line">        if (mOrientation == VERTICAL_LIST) &#123;</span><br><span class="line">            outRect.set(0, 0, 0, mDivider.getIntrinsicHeight());</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            outRect.set(0, 0, mDivider.getIntrinsicWidth(), 0);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">recyclerview.setLayoutManager(new LinearLayoutManager(this,LinearLayoutManager.VERTICAL,false));</span><br><span class="line">recyclerview.addItemDecoration(new com.newyulong.materialdesignstu.DividerItemDecoration.DividerItemDecoration(this, com.newyulong.materialdesignstu.DividerItemDecoration.DividerItemDecoration.VERTICAL_LIST));</span><br></pre></td></tr></table></figure><p>效果图:<br><img src="/2017/11/09/RecyclerView/t2.png" alt=""></p><h2 id="GridLayoutManager分割线"><a href="#GridLayoutManager分割线" class="headerlink" title="GridLayoutManager分割线"></a>GridLayoutManager分割线</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line">public class DividerGridItemDecoration extends RecyclerView.ItemDecoration &#123;</span><br><span class="line">    private static final int[] ATTRS = new int[] &#123; android.R.attr.listDivider &#125;;</span><br><span class="line">    private Drawable mDivider;</span><br><span class="line"></span><br><span class="line">    private int divider_height = 2;</span><br><span class="line"></span><br><span class="line">    public DividerGridItemDecoration(Context context)</span><br><span class="line">    &#123;</span><br><span class="line">        final TypedArray a = context.obtainStyledAttributes(ATTRS);</span><br><span class="line">        mDivider = a.getDrawable(0);</span><br><span class="line">        a.recycle();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public DividerGridItemDecoration(Context context,int px_divider_height)</span><br><span class="line">    &#123;</span><br><span class="line">        final TypedArray a = context.obtainStyledAttributes(ATTRS);</span><br><span class="line">        mDivider = a.getDrawable(0);</span><br><span class="line">        mDivider.setColorFilter(Color.WHITE,PorterDuff.Mode.SRC);</span><br><span class="line">        divider_height = px_divider_height;</span><br><span class="line">        a.recycle();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public DividerGridItemDecoration(Context context,int px_divider_height,int divider_color)</span><br><span class="line">    &#123;</span><br><span class="line">        final TypedArray a = context.obtainStyledAttributes(ATTRS);</span><br><span class="line">        mDivider = a.getDrawable(0);</span><br><span class="line">        mDivider.setColorFilter(divider_color,PorterDuff.Mode.SRC);</span><br><span class="line">        divider_height = px_divider_height;</span><br><span class="line">        a.recycle();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onDraw(Canvas c, RecyclerView parent, RecyclerView.State state)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        drawHorizontal(c, parent);</span><br><span class="line">        drawVertical(c, parent);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private int getSpanCount(RecyclerView parent)</span><br><span class="line">    &#123;</span><br><span class="line">        // 列数</span><br><span class="line">        int spanCount = -1;</span><br><span class="line">        RecyclerView.LayoutManager layoutManager = parent.getLayoutManager();</span><br><span class="line">        if (layoutManager instanceof GridLayoutManager)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            spanCount = ((GridLayoutManager) layoutManager).getSpanCount();</span><br><span class="line">        &#125; else if (layoutManager instanceof StaggeredGridLayoutManager)</span><br><span class="line">        &#123;</span><br><span class="line">            spanCount = ((StaggeredGridLayoutManager) layoutManager)</span><br><span class="line">                    .getSpanCount();</span><br><span class="line">        &#125;</span><br><span class="line">        return spanCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void drawHorizontal(Canvas c, RecyclerView parent)</span><br><span class="line">    &#123;</span><br><span class="line">        int childCount = parent.getChildCount();</span><br><span class="line">        for (int i = 0; i &lt; childCount; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            final View child = parent.getChildAt(i);</span><br><span class="line">            final RecyclerView.LayoutParams params = (RecyclerView.LayoutParams) child</span><br><span class="line">                    .getLayoutParams();</span><br><span class="line">            final int left = child.getLeft() - params.leftMargin;</span><br><span class="line">            final int right = child.getRight() + params.rightMargin</span><br><span class="line">                    + divider_height;</span><br><span class="line">            final int top = child.getBottom() + params.bottomMargin;</span><br><span class="line">            final int bottom = top + divider_height;</span><br><span class="line">            mDivider.setBounds(left, top, right, bottom);</span><br><span class="line">            mDivider.draw(c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void drawVertical(Canvas c, RecyclerView parent)</span><br><span class="line">    &#123;</span><br><span class="line">        final int childCount = parent.getChildCount();</span><br><span class="line">        for (int i = 0; i &lt; childCount; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            final View child = parent.getChildAt(i);</span><br><span class="line"></span><br><span class="line">            final RecyclerView.LayoutParams params = (RecyclerView.LayoutParams) child</span><br><span class="line">                    .getLayoutParams();</span><br><span class="line">            final int top = child.getTop() - params.topMargin;</span><br><span class="line">            final int bottom = child.getBottom() + params.bottomMargin;</span><br><span class="line">            final int left = child.getRight() + params.rightMargin;</span><br><span class="line">            final int right = left + divider_height;</span><br><span class="line"></span><br><span class="line">            mDivider.setBounds(left, top, right, bottom);</span><br><span class="line">            mDivider.draw(c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean isLastColum(RecyclerView parent, int pos, int spanCount,</span><br><span class="line">                                int childCount)</span><br><span class="line">    &#123;</span><br><span class="line">        RecyclerView.LayoutManager layoutManager = parent.getLayoutManager();</span><br><span class="line">        if (layoutManager instanceof GridLayoutManager)</span><br><span class="line">        &#123;</span><br><span class="line">            if ((pos + 1) % spanCount == 0)// 如果是最后一列，则不需要绘制右边</span><br><span class="line">            &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (layoutManager instanceof StaggeredGridLayoutManager)</span><br><span class="line">        &#123;</span><br><span class="line">            int orientation = ((StaggeredGridLayoutManager) layoutManager)</span><br><span class="line">                    .getOrientation();</span><br><span class="line">            if (orientation == StaggeredGridLayoutManager.VERTICAL)</span><br><span class="line">            &#123;</span><br><span class="line">                if ((pos + 1) % spanCount == 0)// 如果是最后一列，则不需要绘制右边</span><br><span class="line">                &#123;</span><br><span class="line">                    return true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else</span><br><span class="line">            &#123;</span><br><span class="line">                childCount = childCount - childCount % spanCount;</span><br><span class="line">                if (pos &gt;= childCount)// 如果是最后一列，则不需要绘制右边</span><br><span class="line">                    return true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean isLastRaw(RecyclerView parent, int pos, int spanCount,</span><br><span class="line">                              int childCount)</span><br><span class="line">    &#123;</span><br><span class="line">        RecyclerView.LayoutManager layoutManager = parent.getLayoutManager();</span><br><span class="line">        if (layoutManager instanceof GridLayoutManager)</span><br><span class="line">        &#123;</span><br><span class="line">            childCount = childCount - childCount % spanCount;</span><br><span class="line">            if (pos &gt;= childCount)// 如果是最后一行，则不需要绘制底部</span><br><span class="line">                return true;</span><br><span class="line">        &#125; else if (layoutManager instanceof StaggeredGridLayoutManager)</span><br><span class="line">        &#123;</span><br><span class="line">            int orientation = ((StaggeredGridLayoutManager) layoutManager)</span><br><span class="line">                    .getOrientation();</span><br><span class="line">            // StaggeredGridLayoutManager 且纵向滚动</span><br><span class="line">            if (orientation == StaggeredGridLayoutManager.VERTICAL)</span><br><span class="line">            &#123;</span><br><span class="line">                childCount = childCount - childCount % spanCount;</span><br><span class="line">                // 如果是最后一行，则不需要绘制底部</span><br><span class="line">                if (pos &gt;= childCount)</span><br><span class="line">                    return true;</span><br><span class="line">            &#125; else</span><br><span class="line">            // StaggeredGridLayoutManager 且横向滚动</span><br><span class="line">            &#123;</span><br><span class="line">                // 如果是最后一行，则不需要绘制底部</span><br><span class="line">                if ((pos + 1) % spanCount == 0)</span><br><span class="line">                &#123;</span><br><span class="line">                    return true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void getItemOffsets(Rect outRect, int itemPosition,</span><br><span class="line">                               RecyclerView parent)</span><br><span class="line">    &#123;</span><br><span class="line">        int spanCount = getSpanCount(parent);</span><br><span class="line">        int childCount = parent.getAdapter().getItemCount();</span><br><span class="line">        if (isLastRaw(parent, itemPosition, spanCount, childCount))// 如果是最后一行，则不需要绘制底部</span><br><span class="line">        &#123;</span><br><span class="line">            outRect.set(0, 0, divider_height, 0);</span><br><span class="line">        &#125; else if (isLastColum(parent, itemPosition, spanCount, childCount))// 如果是最后一列，则不需要绘制右边</span><br><span class="line">        &#123;</span><br><span class="line">            outRect.set(0, 0, 0, divider_height);</span><br><span class="line">        &#125; else</span><br><span class="line">        &#123;</span><br><span class="line">            outRect.set(0, 0, divider_height,divider_height);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">recyclerview.addItemDecoration(new com.newyulong.materialdesignstu.DividerItemDecoration.DividerItemDecoration(this, com.newyulong.materialdesignstu.DividerItemDecoration.DividerItemDecoration.VERTICAL_LIST));</span><br><span class="line">//recyclerview.setLayoutManager(new GridLayoutManager(this,4,LinearLayoutManager.HORIZONTAL,false));//横向GridView</span><br><span class="line">recyclerview.addItemDecoration(new DividerGridItemDecoration(this));</span><br></pre></td></tr></table></figure><p>效果图:<br><img src="/2017/11/09/RecyclerView/t3.png" alt=""></p><h1 id="瀑布流"><a href="#瀑布流" class="headerlink" title="瀑布流"></a>瀑布流</h1><p>StaggeredGridLayoutManager:瀑布流布局管理器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">recyclerview.setLayoutManager(new StaggeredGridLayoutManager(3,StaggeredGridLayoutManager.VERTICAL));</span><br></pre></td></tr></table></figure></p><p>效果图:<br><img src="/2017/11/09/RecyclerView/t3.png" alt=""><br>居然和GridLayoutManager的效果一样!修改第二项item的高度为80,其他的为160<br><img src="/2017/11/09/RecyclerView/t4.png" alt=""></p><h1 id="item点击事件"><a href="#item点击事件" class="headerlink" title="item点击事件"></a>item点击事件</h1><h2 id="在MyAdapter中定义如下接口-模拟ListView的OnItemClickListener："><a href="#在MyAdapter中定义如下接口-模拟ListView的OnItemClickListener：" class="headerlink" title="在MyAdapter中定义如下接口,模拟ListView的OnItemClickListener："></a>在MyAdapter中定义如下接口,模拟ListView的OnItemClickListener：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public static interface OnItemClickListener &#123;</span><br><span class="line">        void onItemClick(View view , int position);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="在onCreateViewHolder-中为每个item添加点击事件"><a href="#在onCreateViewHolder-中为每个item添加点击事件" class="headerlink" title="在onCreateViewHolder()中为每个item添加点击事件"></a>在onCreateViewHolder()中为每个item添加点击事件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">    public ViewHolder onCreateViewHolder(ViewGroup viewGroup,  int viewType) &#123;</span><br><span class="line">        View view = LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.item, viewGroup, false);</span><br><span class="line">        ViewHolder vh = new ViewHolder(view);</span><br><span class="line">        //将创建的View注册点击事件</span><br><span class="line">        view.setOnClickListener(this);</span><br><span class="line">        return vh;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="将点击事件转移给外面的调用者："><a href="#将点击事件转移给外面的调用者：" class="headerlink" title="将点击事件转移给外面的调用者："></a>将点击事件转移给外面的调用者：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">    public void onClick(View v) &#123;</span><br><span class="line">        if (mOnItemClickListener != null) &#123;</span><br><span class="line">            //注意这里使用getTag方法获取position</span><br><span class="line">            mOnItemClickListener.onItemClick(v,(int)v.getTag());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="注意上面调用接口的onItemClick-中的v-getTag-方法，这需要在onBindViewHolder-方法中设置和item的position"><a href="#注意上面调用接口的onItemClick-中的v-getTag-方法，这需要在onBindViewHolder-方法中设置和item的position" class="headerlink" title="注意上面调用接口的onItemClick()中的v.getTag()方法，这需要在onBindViewHolder()方法中设置和item的position"></a>注意上面调用接口的onItemClick()中的v.getTag()方法，这需要在onBindViewHolder()方法中设置和item的position</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">    public void onBindViewHolder(ViewHolder viewHolder,  int position) &#123;</span><br><span class="line">        viewHolder.mTextView.setText(datas[position]);</span><br><span class="line">        //将position保存在itemView的Tag中，以便点击时进行获取</span><br><span class="line">        viewHolder.itemView.setTag(position);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="最后暴露给外面的调用者，定义一个设置Listener的方法（）："><a href="#最后暴露给外面的调用者，定义一个设置Listener的方法（）：" class="headerlink" title="最后暴露给外面的调用者，定义一个设置Listener的方法（）："></a>最后暴露给外面的调用者，定义一个设置Listener的方法（）：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">private OnItemClickListener mOnItemClickListener = null;</span><br><span class="line">public void setOnItemClickListener(OnItemClickListener listener) &#123;</span><br><span class="line">        this.mOnItemClickListener = listener;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本文讲的是RecycView布局,列表形式,网格形式,瀑布流形式.<br>使用RecycView需要设置布局管理器(LinearLayoutManager,GridLayoutManager,StaggeredGridLayoutManager)<br>同样需要适配器(继承RecyclerView.Adapter), 需要重写onCreateViewHolder方法(实例化ViewHolder), onBindViewHolder方法(得到ViewHolder,绑定数据), 以及getItemCount方法,<br>还需要定义ViewHolder类继承RecyclerView.ViewHolder类<br>设置分割线<br>设置动画(删除,增加item时的动画)</p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CollapsingToolbarLayout</title>
      <link href="/2017/11/08/CollapsingToolbarLayout/"/>
      <url>/2017/11/08/CollapsingToolbarLayout/</url>
      <content type="html"><![CDATA[<h1 id="简介CollapsingToolbarLayout"><a href="#简介CollapsingToolbarLayout" class="headerlink" title="简介CollapsingToolbarLayout"></a>简介CollapsingToolbarLayout</h1><p>CollapsingToolbarLayout作用是提供一个可以折叠的Toolbar,给它设置layout_scrollFlags,就可以控制其内的控件(如:ImageView,Toolbar)在响应layout_behavior事件时做出相应的scrollFlags滚动事件.</p><h1 id="xml布局文件"><a href="#xml布局文件" class="headerlink" title="xml布局文件"></a>xml布局文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;android.support.design.widget.CoordinatorLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.design.widget.AppBarLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;android.support.design.widget.CollapsingToolbarLayout</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;300dp&quot;</span><br><span class="line">            app:contentScrim=&quot;@color/colorPrimary&quot;</span><br><span class="line">            app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;</span><br><span class="line">            app:title=&quot;Toolbar&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:layout_width=&quot;match_parent&quot;</span><br><span class="line">                android:layout_height=&quot;match_parent&quot;</span><br><span class="line">                android:scaleType=&quot;centerCrop&quot;</span><br><span class="line">                android:src=&quot;@mipmap/coll&quot;</span><br><span class="line">                app:layout_collapseMode=&quot;parallax&quot;</span><br><span class="line">                app:layout_collapseParallaxMultiplier=&quot;0.5&quot; /&gt;</span><br><span class="line"></span><br><span class="line">            &lt;android.support.v7.widget.Toolbar</span><br><span class="line">                android:layout_width=&quot;match_parent&quot;</span><br><span class="line">                android:layout_height=&quot;?attr/actionBarSize&quot;</span><br><span class="line">                app:layout_collapseMode=&quot;pin&quot;</span><br><span class="line">                app:navigationIcon=&quot;@mipmap/back_black_arra&quot; /&gt;</span><br><span class="line">        &lt;/android.support.design.widget.CollapsingToolbarLayout&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/android.support.design.widget.AppBarLayout&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.v4.widget.NestedScrollView</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;match_parent&quot;</span><br><span class="line">            android:text=&quot;@string/txt_appbar&quot; /&gt;</span><br><span class="line">    &lt;/android.support.v4.widget.NestedScrollView&gt;</span><br><span class="line"></span><br><span class="line">&lt;/android.support.design.widget.CoordinatorLayout&gt;</span><br></pre></td></tr></table></figure><p>CollapsingToolbarLayout包含一个ImageView和一个Toolbar,把这个CollapsingToolbarLayout放到AppBarLayout中作为一个整体。</p><ol><li>在CollapsingToolbarLayout中:<br> <strong>我们必须设置layout_scrollFlags</strong></li><li>ImageView中:<br> layout_collapseMode(折叠模式):<br> pin: 当CollapsingToolbarLayout完全收缩后,Toolbar还可以保留在屏幕上.<br> parallax: 在内容滚动时，CollapsingToolbarLayout中的View（比如ImageView)也可以同时滚动，实现视差滚动效果，通常和layout_collapseParallaxMultiplier(设置视差因子)搭配使用<br> layout_collapseParallaxMultiplier: 设置视差滚动因子，值为：0~1</li><li>Toolbar中:<br> layout_collapseMode(折叠模式)：为pin(Toolbar保留在屏幕上)</li></ol><p>上例分析: 当向上滚动时,ImageView会有视觉差的向上滚出屏幕,最后Toolbar会固定在最顶端<br>效果图:<br><img src="/2017/11/08/CollapsingToolbarLayout/ctl1.gif" alt=""></p><h1 id="样式修改"><a href="#样式修改" class="headerlink" title="样式修改"></a>样式修改</h1><p>修改Toolbar title颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctl.setExpandedTitleColor(getResources().getColor(R.color.white));</span><br><span class="line">ctl.setCollapsedTitleTextColor(getResources().getColor(R.color.white));</span><br></pre></td></tr></table></figure></p><p>修改折叠后Toolbar背景颜色 (app:contentScrim)<br>上例xml文件中已经将Toolbar背景颜色修改过,<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.design.widget.CollapsingToolbarLayout</span><br><span class="line">android:id=&quot;@+id/ctl&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;300dp&quot;</span><br><span class="line">app:contentScrim=&quot;@color/colorPrimary&quot;</span><br><span class="line">app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;</span><br><span class="line">app:title=&quot;Toolbar&quot;&gt;</span><br></pre></td></tr></table></figure></p><p>不然会显示ImageView内容,去掉看看<br><img src="/2017/11/08/CollapsingToolbarLayout/ctl2.gif" alt=""></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>CollapsingToolbarLayout是Toolbar的扩充,提供折叠功能.使用时,用它包含Toolbar和其他内容(如ImageView)达到炫酷的效果.</p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>AppBarLayout</title>
      <link href="/2017/11/08/AppBarLayout/"/>
      <url>/2017/11/08/AppBarLayout/</url>
      <content type="html"><![CDATA[<h1 id="官方文档介绍"><a href="#官方文档介绍" class="headerlink" title="官方文档介绍"></a>官方文档介绍</h1><p>AppBarLayout是一个垂直的LinearLayout，实现了Material Design中app bar的scrolling gestures特性。AppBarLayout的子View应该声明想要具有的“滚动行为”，这可以通过layout_scrollFlags属性或是setScrollFlags()方法来指定。AppBarLayout只有作为CoordinatorLayout的直接子View时才能正常工作，为了让AppBarLayout能够知道何时滚动其子View，我们还应该在CoordinatorLayout布局中提供一个可滚动View，我们称之为scrolling view。scrolling view和AppBarLayout之间的关联，通过将scrolling view的Behavior设为AppBarLayout.ScrollingViewBehavior来建立。<br>根据上文我们知道,AppBarLayout主要功能是当位于同一父容器中的可滚动View发生滚动式,APPBarLayout会根据scolling view声明的滚动行为来对其子View进行相应的滚动.<br>先来看张图:AppBarLayout包含Toolbar和一个TextView(没有设置scrollFlags)<br><img src="/2017/11/08/AppBarLayout/abl1.gif" alt=""><br>当向上滚动式,ToolBar会消失;向下滚动时,ToolBar会出现.AppBarLayout就是这么神奇</p><h1 id="xml布局文件"><a href="#xml布局文件" class="headerlink" title="xml布局文件"></a>xml布局文件</h1><p>上面例子的xml布局文件:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;android.support.design.widget.CoordinatorLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.design.widget.AppBarLayout</span><br><span class="line">        android:id=&quot;@+id/abl&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;&gt;</span><br><span class="line">        &lt;android.support.v7.widget.Toolbar</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            app:title=&quot;Toolbar&quot;</span><br><span class="line">            app:layout_scrollFlags=&quot;scroll&quot;</span><br><span class="line">            android:layout_height=&quot;?attr/actionBarSize&quot;&gt;</span><br><span class="line">        &lt;/android.support.v7.widget.Toolbar&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:padding=&quot;15dp&quot;</span><br><span class="line">            android:text=&quot;toolbar 下方的textview&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/android.support.design.widget.AppBarLayout&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.v4.widget.NestedScrollView</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;</span><br><span class="line">        &gt;</span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;match_parent&quot;</span><br><span class="line">            android:text=&quot;@string/txt_appbar&quot;</span><br><span class="line">            android:lineSpacingMultiplier=&quot;1.5&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/android.support.v4.widget.NestedScrollView&gt;</span><br><span class="line"></span><br><span class="line">&lt;/android.support.design.widget.CoordinatorLayout&gt;</span><br></pre></td></tr></table></figure></p><p>布局文件中,NestedScrollView是scrolling view,scrolling view需要支持嵌套滚动.  </p><p>上面的Toolbar的layout_scrollFlags属性被设置为了”scroll”,Toolbar就会随着scrolling view的滚动而滚动,下面解释下scrollFlags:</p><ol><li>scroll<br> 设置成这个值就好比Toolbar和scrolling view是一体的.</li><li>exitUntilCollapsed<br> 当Toolbar向上滚出屏幕时,会被折叠直到达到最小高度停止折叠<br> 下图为了演示,将Toolbar的高度设置成200dp,注释掉Toolbar下方的TextView<br> <img src="/2017/11/08/AppBarLayout/abl2.gif" alt=""></li><li>enterAlways<br> 只要向下滚动时,先滚动Toolbar,完全展开后才会去滚动scrolling view<br> <img src="/2017/11/08/AppBarLayout/abl3.gif" alt=""></li><li>enterAlwaysCollapsed<br> 在enterAlways基础上加了折叠效果.当我们开始向下滚动scrolling view是,Toolbar会跟着滚动知道达到其”折叠高度”(即最小高度).然后当scrolling view滚动到完全显示后,再向下滚动scrolling view,Toolbar会接着滚动到完全显示出来<br> <img src="/2017/11/08/AppBarLayout/abl4.gif" alt=""><br> 注意,要达到上图效果,需要把layout_scrollFlags指定为”scroll|enterAlways|enterAlwaysCollapsed”.</li><li>snap<br> 在一次滚动结束时，Toolbar很可能只处于“部分显示”的状态，加上这个标记能够达到“要么完全隐藏，要么完全显示”的效果。  </li></ol><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ol><li>AppBarLayout是一个垂直的LinearLayout  </li><li>AppBarLayout需要和CoordinatorLayout一起使用,并作为它的直接子View</li><li>为了实现滚动还应在Coordinator布局中提供一个可滚动View(scrolling view),scrolling view还需设置app:layout_behavior=”@string/appbar_scrolling_view_behavior”建立联系</li><li>设置AppBarLayout子View的scrollFlag属性,控制其可以根据scrolling view的滚到而滚动</li></ol>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CoordinatorLayout</title>
      <link href="/2017/11/08/CoordinatorLayout/"/>
      <url>/2017/11/08/CoordinatorLayout/</url>
      <content type="html"><![CDATA[<p>CoordinatorLayout并不局限于与AppbarLayout,CollapsingToolbarLayout,Toolbar配合使用,它的功能强大着呢.<br>CoordinatorLayout:behaivor协调view,它是帮助协调各个子View的布局.<br>其中Behavior就是一个应用于View的观察者模式,一个View跟随着另一个View的变化而变化,或者说一个View监听另一个View.<br>在Behavior中,被观察View也就是事件源被称为denpendcy,而观察View,则被称为clild. clild跟随denpendcy</p><h1 id="CoordinatorLayout使用"><a href="#CoordinatorLayout使用" class="headerlink" title="CoordinatorLayout使用"></a>CoordinatorLayout使用</h1><h2 id="xml"><a href="#xml" class="headerlink" title="xml"></a>xml</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;android.support.design.widget.CoordinatorLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;Button</span><br><span class="line">        android:id=&quot;@+id/btn&quot;</span><br><span class="line">        android:layout_width=&quot;100dp&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:text=&quot;btn&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_marginTop=&quot;100dp&quot;</span><br><span class="line">        android:text=&quot;跟随btn&quot;</span><br><span class="line">         /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/android.support.design.widget.CoordinatorLayout&gt;</span><br></pre></td></tr></table></figure><h2 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class CoordinatorLayoutActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(@Nullable Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_coordinatorlayout);</span><br><span class="line">        Button btn = findViewById(R.id.btn);</span><br><span class="line">        btn.setOnTouchListener(new View.OnTouchListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public boolean onTouch(View v, MotionEvent event) &#123;</span><br><span class="line">                switch (event.getAction())&#123;</span><br><span class="line">                    case MotionEvent.ACTION_MOVE:</span><br><span class="line">                        v.setX(event.getRawX()-v.getWidth()/2);</span><br><span class="line">                        v.setY(event.getRawY()-v.getHeight()/2);</span><br><span class="line">                        break;</span><br><span class="line">                &#125;</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>按钮可以跟随手指移动  </p><h2 id="自定义类集成Behavior类"><a href="#自定义类集成Behavior类" class="headerlink" title="自定义类集成Behavior类"></a>自定义类集成Behavior类</h2><p>创建一MyBehavior类,集成Behavior<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public class MyBehavior extends CoordinatorLayout.Behavior&lt;TextView&gt; &#123;</span><br><span class="line"></span><br><span class="line">    public MyBehavior(Context context, AttributeSet attrs) &#123;//必不可少</span><br><span class="line">        super(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean layoutDependsOn(CoordinatorLayout parent, TextView child, View dependency) &#123;</span><br><span class="line">        return dependency instanceof Button;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onDependentViewChanged(CoordinatorLayout parent, TextView child, View dependency) &#123;</span><br><span class="line">        child.setX(dependency.getX());//此处的denpendency就是btn1</span><br><span class="line">        child.setY(dependency.getY()+200);</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>注意:<br>layoutDependsOn() 代表寻找被观察View,本例是Button<br>onDependentViewChanged() 被观察View变化的时候回调用的方法,本例是TextView.其中dependency就是Button,于是我们让TextView跟随Button的移动而移动<br>必须重写带双参的构造器，因为从xml反射需要调用。<br>然后，在xml中，给TextView设置我们的Behavior。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_marginTop=&quot;100dp&quot;</span><br><span class="line">    android:text=&quot;跟随btn&quot;</span><br><span class="line">    app:layout_behavior=&quot;.behavior.MyBehavior&quot; /&gt;</span><br></pre></td></tr></table></figure></p><p>效果图:<br><img src="/2017/11/08/CoordinatorLayout/cl1.gif" alt=""></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本文讲解CoordinatorLayout的使用,一个Child(TextView) 跟随 dependency移动,定义一个继承Behavior的类,Child(TextView)增加app:layout_behavior属性指向这个类,那么就可实现跟随动作</p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>TabLayout</title>
      <link href="/2017/11/07/TabLayout/"/>
      <url>/2017/11/07/TabLayout/</url>
      <content type="html"><![CDATA[<p>TabLayout是Android Support Design Library库中的一个控件,提供了一个水平的布局用来展示Tabs。</p><h1 id="导包"><a href="#导包" class="headerlink" title="导包"></a>导包</h1><p>使用Snackbar要导入com.android.support:design库。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;com.android.support:design:26.1.0&apos;</span><br></pre></td></tr></table></figure></p><h1 id="一般使用"><a href="#一般使用" class="headerlink" title="一般使用"></a>一般使用</h1><ol><li><p>xml文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.design.widget.TabLayout</span><br><span class="line">    android:id=&quot;@+id/tabLayout&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:background=&quot;#eee&quot;</span><br><span class="line">    app:tabSelectedTextColor=&quot;#666&quot;</span><br><span class="line">    app:tabTextColor=&quot;#ccc&quot;&gt;</span><br><span class="line">&lt;/android.support.design.widget.TabLayout&gt;</span><br></pre></td></tr></table></figure></li><li><p>java代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TabLayout tabLayout = findViewById(R.id.tabLayout);</span><br><span class="line">tabLayout.addTab(tabLayout.newTab().setText(&quot;tab1&quot;));</span><br><span class="line">tabLayout.addTab(tabLayout.newTab().setText(&quot;tab2&quot;));</span><br><span class="line">tabLayout.addTab(tabLayout.newTab().setText(&quot;tab3&quot;));</span><br></pre></td></tr></table></figure></li><li><p>效果图<br><img src="/2017/11/07/TabLayout/t1.png" alt=""></p></li></ol><h1 id="样式修改"><a href="#样式修改" class="headerlink" title="样式修改"></a>样式修改</h1><ol><li><p>设置未选择时字体颜色</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:tabTextColor=&quot;#0f0&quot;</span><br></pre></td></tr></table></figure></li><li><p>设置选中时的字体颜色</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:tabSelectedTextColor=&quot;@color/colorAccent&quot;</span><br></pre></td></tr></table></figure></li><li><p>设置指示器颜色</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:tabIndicatorColor=&quot;#f00&quot;</span><br></pre></td></tr></table></figure></li><li><p>设置Tab背景颜色</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:tabBackground=&quot;@color/blue&quot;</span><br></pre></td></tr></table></figure><p> 看看效果:<br><img src="/2017/11/07/TabLayout/t2.png" alt=""></p></li><li><p>设置TabItem字体大小</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:tabTextAppearance=&quot;@android:style/TextAppearance.Large&quot;</span><br></pre></td></tr></table></figure></li><li><p>设置指示器下标高度</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:tabIndicatorHeight=&quot;5dp&quot;</span><br></pre></td></tr></table></figure></li><li><p>Tab模式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:tabMode=&quot;scrollable&quot; //默认为fixed</span><br></pre></td></tr></table></figure></li><li><p>添加图标</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tabLayout.addTab(tabLayout.newTab().setText(&quot;icon&quot;).setIcon(R.mipmap.ic_launcher));</span><br></pre></td></tr></table></figure><p> 多添加几个tag,看看效果:<br><img src="/2017/11/07/TabLayout/tl1.gif" alt=""></p></li><li>Tab宽度限制<br>设置最小宽度:<br>app:tabMinWidth=”100dp”<br><img src="/2017/11/07/TabLayout/t3.png" alt=""><br>可以看出每个Tab的宽度变宽了</li></ol><h1 id="TabLayout的监听事件"><a href="#TabLayout的监听事件" class="headerlink" title="TabLayout的监听事件"></a>TabLayout的监听事件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() &#123;</span><br><span class="line">public void onTabSelected(TabLayout.Tab tab) &#123;</span><br><span class="line">//tab被选中</span><br><span class="line">Log.d(TAG,&quot;onTabSelected: &quot;+tab.getPosition());</span><br><span class="line">&#125;</span><br><span class="line">public void onTabUnselected(TabLayout.Tab tab) &#123;</span><br><span class="line">//tab取消选中</span><br><span class="line">Log.d(TAG,&quot;onTabUnselected: &quot;+tab.getPosition());</span><br><span class="line">&#125;</span><br><span class="line">public void onTabReselected(TabLayout.Tab tab) &#123;</span><br><span class="line">//tab再次被选中</span><br><span class="line">Log.d(TAG,&quot;onTabReselected: &quot;+tab.getPosition());</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>切换Tab,看看日志:<br><img src="/2017/11/07/TabLayout/tl2.gif" alt=""><br>0 -&gt; 1: 0unSelected 1selected<br>1 -&gt; 3: 1unSelected 3selected<br>3 -&gt; 0: 3unSelected 0selected  </p><h1 id="TabLayout与ViewPager联动"><a href="#TabLayout与ViewPager联动" class="headerlink" title="TabLayout与ViewPager联动"></a>TabLayout与ViewPager联动</h1><ol><li>配置viewpage的adapter,<strong>实现getPageTitle(position)方法</strong></li><li>使用setupWithViewPager(viewpager)关联<br>代码如下:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">public class TabLayoutActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private final static String TAG = &quot;TabLayoutActivity&quot;;</span><br><span class="line"></span><br><span class="line">    private String[] mTitleArray = &#123;&quot;item1&quot;, &quot;xitem2&quot;, &quot;xxxitem3&quot;, &quot;xxxxitem4&quot;,&quot;xxxxxitem5&quot;&#125;;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(@Nullable Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_tablayout);</span><br><span class="line">        TabLayout tabLayout = findViewById(R.id.tabLayout);</span><br><span class="line">        ViewPager vp = findViewById(R.id.vp);</span><br><span class="line">        vp.setAdapter(new MyAdapter());</span><br><span class="line">//  去掉addTab(),从viewpage 的 getPageTitle()中获取</span><br><span class="line">//        tabLayout.addTab(tabLayout.newTab().setText(&quot;icon&quot;).setIcon(R.mipmap.ic_launcher));</span><br><span class="line">//        tabLayout.addTab(tabLayout.newTab().setText(&quot;tab1&quot;));</span><br><span class="line">//        tabLayout.addTab(tabLayout.newTab().setText(&quot;tab2&quot;));</span><br><span class="line">//        tabLayout.addTab(tabLayout.newTab().setText(&quot;tab3&quot;));</span><br><span class="line">//        tabLayout.addTab(tabLayout.newTab().setText(&quot;tab4&quot;));</span><br><span class="line">//        tabLayout.addTab(tabLayout.newTab().setText(&quot;tab5&quot;));</span><br><span class="line">//        tabLayout.addTab(tabLayout.newTab().setText(&quot;tab6&quot;));</span><br><span class="line"></span><br><span class="line">        tabLayout.setupWithViewPager(vp);//关联viewpager</span><br><span class="line"></span><br><span class="line">        tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() &#123;</span><br><span class="line">            public void onTabSelected(TabLayout.Tab tab) &#123;</span><br><span class="line">                //tab被选中</span><br><span class="line">                Log.d(TAG,&quot;onTabSelected: &quot;+tab.getPosition());</span><br><span class="line">            &#125;</span><br><span class="line">            public void onTabUnselected(TabLayout.Tab tab) &#123;</span><br><span class="line">                //tab取消选中</span><br><span class="line">                Log.d(TAG,&quot;onTabUnselected: &quot;+tab.getPosition());</span><br><span class="line">            &#125;</span><br><span class="line">            public void onTabReselected(TabLayout.Tab tab) &#123;</span><br><span class="line">                //tab再次被选中</span><br><span class="line">                Log.d(TAG,&quot;onTabReselected: &quot;+tab.getPosition());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private class MyAdapter extends PagerAdapter &#123;</span><br><span class="line">        public int getCount() &#123;</span><br><span class="line">            return mTitleArray.length;</span><br><span class="line">        &#125;</span><br><span class="line">        public boolean isViewFromObject(View view, Object object) &#123;</span><br><span class="line">            return view == object;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public Object instantiateItem(ViewGroup container, int position) &#123;</span><br><span class="line">            TextView tv = new TextView(TabLayoutActivity.this);</span><br><span class="line">            tv.setText(mTitleArray[position]);</span><br><span class="line">            tv.setGravity(Gravity.CENTER);</span><br><span class="line">            container.addView(tv, ViewPager.LayoutParams.MATCH_PARENT, ViewPager.LayoutParams.WRAP_CONTENT);</span><br><span class="line">            return tv;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void destroyItem(ViewGroup container, int position, Object object) &#123;</span><br><span class="line">            container.removeView((View) object);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public CharSequence getPageTitle(int position) &#123;</span><br><span class="line">            return mTitleArray[position];//title给TabLayout使用</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>效果图:<br><img src="/2017/11/07/TabLayout/tl3.gif" alt="">  </p><h1 id="扩展-设置下划线宽度和文字一样长"><a href="#扩展-设置下划线宽度和文字一样长" class="headerlink" title="扩展(设置下划线宽度和文字一样长)"></a>扩展(设置下划线宽度和文字一样长)</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">public void reflex(final TabLayout tabLayout, final int margin, final int padding) &#123;</span><br><span class="line">    //了解源码得知 线的宽度是根据 tabView的宽度来设置的</span><br><span class="line">    tabLayout.post(new Runnable() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void run() &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                //拿到tabLayout的mTabStrip属性</span><br><span class="line">                LinearLayout mTabStrip = (LinearLayout) tabLayout.getChildAt(0);</span><br><span class="line"></span><br><span class="line">                //计算总长度</span><br><span class="line">                float sumWith = 0;</span><br><span class="line"></span><br><span class="line">                for (int i = 0; i &lt; mTabStrip.getChildCount(); i++) &#123;</span><br><span class="line">                    View tabView = mTabStrip.getChildAt(i);</span><br><span class="line"></span><br><span class="line">                    //拿到tabView的mTextView属性  tab的字数不固定一定用反射取mTextView</span><br><span class="line">                    Field mTextViewField = tabView.getClass().getDeclaredField(&quot;mTextView&quot;);</span><br><span class="line">                    mTextViewField.setAccessible(true);</span><br><span class="line"></span><br><span class="line">                    TextView mTextView = (TextView) mTextViewField.get(tabView);</span><br><span class="line"></span><br><span class="line">                    tabView.setPadding(0, 0, 0, 0);</span><br><span class="line"></span><br><span class="line">                    //因为我想要的效果是   字多宽线就多宽，所以测量mTextView的宽度</span><br><span class="line">                    int width = 0;</span><br><span class="line">                    width = mTextView.getWidth();</span><br><span class="line">                    if (width == 0) &#123;</span><br><span class="line">                        mTextView.measure(0, 0);</span><br><span class="line">                        width = mTextView.getMeasuredWidth();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    //设置tab左右间距为10dp  注意这里不能使用Padding 因为源码中线的宽度是根据 tabView的宽度来设置的</span><br><span class="line">                    LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) tabView.getLayoutParams();</span><br><span class="line">                    params.width = width + 2 * padding;</span><br><span class="line">                    params.leftMargin = margin;</span><br><span class="line">                    params.rightMargin = margin;</span><br><span class="line">                    tabView.setLayoutParams(params);</span><br><span class="line"></span><br><span class="line">                    tabView.invalidate();</span><br><span class="line">                    sumWith += 2 * margin + 2 * padding + width;</span><br><span class="line">                &#125;</span><br><span class="line">                int sc_with = getWindowManager().getDefaultDisplay().getWidth();</span><br><span class="line">                if (sumWith &lt;= sc_with) &#123;//总长度小于屏幕宽度时MODE_FIXED,否则MODE_SCROLLABLE</span><br><span class="line">                    tabLayout.setTabMode(TabLayout.MODE_FIXED);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    tabLayout.setTabMode(TabLayout.MODE_SCROLLABLE);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (NoSuchFieldException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; catch (IllegalAccessException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下划线和文字一样长,并且可以设置所tabitem的数量动态调整TabMode(MODE_FIXED|MODE_SCROLLABLE),可以设置margin和padding.</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本文讲解了TabLayout的常规使用:背景颜色,选中未选中颜色,指示器高度颜色…属性介绍<br>TabLayout大多和ViewPager配合使用:使用setupWithViewPager(viewpager)关联ViewPager,适配器还要实现getPagerTitle(position)方法返回title供TabLayout tabItem使用</p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>FloatingActionButton</title>
      <link href="/2017/11/07/FloatingActionButton/"/>
      <url>/2017/11/07/FloatingActionButton/</url>
      <content type="html"><![CDATA[<p>FloatingActionButton是Android Support Design Library库中的一个控件,类似一个圆形图片按钮</p><h1 id="导包"><a href="#导包" class="headerlink" title="导包"></a>导包</h1><p>使用FloatingActionButton要导入com.android.support:design库。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;com.android.support:design:26.1.0&apos;</span><br></pre></td></tr></table></figure></p><h1 id="xml布局文件"><a href="#xml布局文件" class="headerlink" title="xml布局文件"></a>xml布局文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;android.support.design.widget.CoordinatorLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.design.widget.FloatingActionButton</span><br><span class="line">        android:id=&quot;@+id/fab&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        app:fabSize=&quot;auto&quot;</span><br><span class="line">        app:elevation=&quot;1dp&quot;</span><br><span class="line">        android:src=&quot;@mipmap/add&quot;</span><br><span class="line">        android:clickable=&quot;true&quot;</span><br><span class="line">        app:backgroundTint=&quot;#33ce33&quot;</span><br><span class="line">        app:rippleColor=&quot;#0000ff&quot;</span><br><span class="line">        /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/android.support.design.widget.CoordinatorLayout&gt;</span><br></pre></td></tr></table></figure><p>使用简单,当做ImageBubbon使用,设置src 白色的”+”号.</p><h1 id="FloatingActionButton常用属性"><a href="#FloatingActionButton常用属性" class="headerlink" title="FloatingActionButton常用属性"></a>FloatingActionButton常用属性</h1><ol><li>app:fabSize:为了符合Material Design的设计风格，Google给出了FloatingActionButton的三种大小值：mini、normal、auto.</li><li>app:elevation=”6dp”：为了有投影悬浮效果，为FloatingActionButton设置一个高度值.<br>高度值越大，投影效果越淡，投影范围越大.高度值越小，投影效果越浓，投影范围越小.</li><li>app:rippleColor：为了符合Material Design的设计风格，为了使可点击的选项给用户反馈，点击时会有水波纹扩散的效果.<br>默认值是灰色的水波纹效果。如果设置rippleColor没有效果，记得设置属性android:clickable=”true”.</li><li>app:pressedTranslationZ=”10dp”：设置阴影的点击效果。与elevation控制的同一地方的阴影，不过elevation是非按压时的阴影效果，而pressedTranslationZ是点击按钮时阴影的效果.</li><li>app:backgroundTint： 改变FloatingActionButton的背景颜色.</li><li>android:src: 设置FloatingActionButton的背景内容<br>当然也可以在java代码中设置这些参数</li></ol><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>FloatingActionButton使用简单,和ImageBotton类似,多一些ripple,投影效果</p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Snackbar</title>
      <link href="/2017/11/07/Snackbar/"/>
      <url>/2017/11/07/Snackbar/</url>
      <content type="html"><![CDATA[<p>Snackbar是Android Support Design Library库中的一个控件，可以在屏幕底部快速弹出消息，比Toast更加好用。</p><h1 id="导包"><a href="#导包" class="headerlink" title="导包"></a>导包</h1><p>使用Snackbar要导入com.android.support:design库。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;com.android.support:design:26.1.0&apos;</span><br></pre></td></tr></table></figure></p><h1 id="一般使用"><a href="#一般使用" class="headerlink" title="一般使用"></a>一般使用</h1><p>Snackbar基本使用和Toast类似<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Snackbar.make(view,&quot;hello world&quot;,Snackbar.LENGTH_INDEFINITE)</span><br><span class="line">        .setAction(&quot;你好&quot;, new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">//点击后关闭Snackbar</span><br><span class="line">Toast.makeText(SnackbarActivity.this,&quot;Snackbar被点击了&quot;,Toast.LENGTH_LONG).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .show();</span><br></pre></td></tr></table></figure></p><p>属性解析:<br>make()生成Snackbar.<br>第一个参数是容纳view,推荐使用CoordinatorLayout来确保Snackbar和其他组件的交互,比如向右右滑动Snackbar可取消,Snackbar出现时FloatingActionButton上移.<br>第二个参数是提示内容.<br>第三个参数是显示时间:LENGTH_SHORT、LENGTH_LONG和LENGTH_INDEFINITE。<br>setAction()设置右侧按钮,可增加点击事件.如果不写setAction()则只显示左侧提示内容.<br>下图演示右滑Snackbar取消和点击Action弹出Toast提示<br><img src="/2017/11/07/Snackbar/snackbar1.gif" alt=""></p><h1 id="颜色修改"><a href="#颜色修改" class="headerlink" title="颜色修改"></a>颜色修改</h1><ol><li>Action 文字颜色修改<br>.setActionTextColor(color)即可</li><li>修改Snackbar背景颜色<br>api中并不能直接修改背景颜色,通过查看源码Snackbar加载了R.layout.design_layout_snackbar_include布局文件  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;merge xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">&lt;TextView</span><br><span class="line">        android:id=&quot;@+id/snackbar_text&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_weight=&quot;1&quot;</span><br><span class="line">        android:paddingTop=&quot;14dp&quot;</span><br><span class="line">        android:paddingBottom=&quot;14dp&quot;</span><br><span class="line">        android:paddingLeft=&quot;12dp&quot;</span><br><span class="line">        android:paddingRight=&quot;12dp&quot;</span><br><span class="line">        android:textAppearance=&quot;@style/TextAppearance.Design.Snackbar.Message&quot;</span><br><span class="line">        android:maxLines=&quot;2&quot;</span><br><span class="line">        android:layout_gravity=&quot;center_vertical|left|start&quot;</span><br><span class="line">        android:ellipsize=&quot;end&quot;</span><br><span class="line">        android:textAlignment=&quot;viewStart&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">        android:id=&quot;@+id/snackbar_action&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_marginLeft=&quot;0dp&quot;</span><br><span class="line">        android:layout_marginStart=&quot;0dp&quot;</span><br><span class="line">        android:layout_gravity=&quot;center_vertical|right|end&quot;</span><br><span class="line">        android:paddingTop=&quot;14dp&quot;</span><br><span class="line">        android:paddingBottom=&quot;14dp&quot;</span><br><span class="line">        android:paddingLeft=&quot;12dp&quot;</span><br><span class="line">        android:paddingRight=&quot;12dp&quot;</span><br><span class="line">        android:visibility=&quot;gone&quot;</span><br><span class="line">        android:textColor=&quot;?attr/colorAccent&quot;</span><br><span class="line">        style=&quot;?attr/borderlessButtonStyle&quot;/&gt;</span><br><span class="line">&lt;/merge&gt;</span><br></pre></td></tr></table></figure></li></ol><p>TextView:Snackbar左侧的message,Button是右侧的Action<br>修改Snackbar背景颜色和message字体颜色就是这样:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public static void setSnackbarColor(Snackbar snackbar, int messageColor, int backgroundColor) &#123;</span><br><span class="line">    View view = snackbar.getView();//获取Snackbar的view</span><br><span class="line">    if(view!=null)&#123;</span><br><span class="line">        view.setBackgroundColor(backgroundColor);//修改view的背景色</span><br><span class="line">        ((TextView) view.findViewById(R.id.snackbar_text)).setTextColor(messageColor);//获取Snackbar的message控件，修改字体颜色</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>简单修改代码就能改变背景颜色,message字体颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">final Snackbar make = Snackbar.make(coordinatorLayout, &quot;hello world&quot;, Snackbar.LENGTH_INDEFINITE);</span><br><span class="line">setSnackbarColor(make,getResources().getColor(R.color.black),getResources().getColor(R.color.colorAccent));</span><br><span class="line">make.setActionTextColor(getResources().getColor(R.color.blue));</span><br><span class="line">tv.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onClick(View v) &#123;</span><br><span class="line">        make.setAction(&quot;你好&quot;, new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">                Toast.makeText(SnackbarActivity.this,&quot;Snackbar Action被点击了&quot;,Toast.LENGTH_LONG).show();</span><br><span class="line">             &#125;</span><br><span class="line">     &#125;)</span><br><span class="line">     .show();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>效果图:<br><img src="/2017/11/07/Snackbar/1.png" alt=""><br>背景变成了红色,Message字体颜色为黑色,Action字体颜色蓝色</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>Snackbar使用和Toast很是相似,出现在所有屏幕其他元素之上,make()生成Snackbar,show()显示.<br>可以设置action设置右侧按钮,增加交互<br>Snackbar样式修改,可直接通过setActionTextColor()修改action按钮颜色,要想修改背景和message颜色,就需要snackbar.getView()修改背景颜色,findviewbyid修改snackbar_text颜色<br>最后推荐Snackbar和CoordinatioLayout配合使用,以达到和其他组件(比如FloatingActionButton)交互效果,后面会讲到CoorinationLayout  </p><p>参考:<a href="http://www.jianshu.com/p/cd1e80e64311/" target="_blank" rel="noopener">http://www.jianshu.com/p/cd1e80e64311/</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Toolbar</title>
      <link href="/2017/11/06/Toolbar/"/>
      <url>/2017/11/06/Toolbar/</url>
      <content type="html"><![CDATA[<h1 id="Toolbar简介"><a href="#Toolbar简介" class="headerlink" title="Toolbar简介"></a>Toolbar简介</h1><p>ToolBar是Android 5.0推出的一个新的导航控件用于取代之前的ActionBar，由于其高度的可定制性、灵活性、具有Material Design风格等优点，越来越多的应用也用上了ToolBar，比如常用的知乎软件其顶部导航栏正是使用ToolBar。官方考虑到仍有一部分用户的手机版本号低于5.0，所以，ToolBar也放进了support v7包内，使得低版本的系统也能使用上ToolBar。本文将使用support v7支持包的ToolBar来进行讲解，包括其基本用法、样式定制等知识点。</p><h1 id="引入support-v7支持包"><a href="#引入support-v7支持包" class="headerlink" title="引入support v7支持包"></a>引入support v7支持包</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation &apos;com.android.support:appcompat-v7:26.1.0&apos;</span><br></pre></td></tr></table></figure><h1 id="更改主题"><a href="#更改主题" class="headerlink" title="更改主题"></a>更改主题</h1><p>需要使用此支持包内主题Theme.AppCompat<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;style name=&quot;AppTheme&quot; parent=&quot;Theme.AppCompat.Light.NoActionBar&quot;&gt;    </span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p><h1 id="xml布局文件"><a href="#xml布局文件" class="headerlink" title="xml布局文件"></a>xml布局文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.v7.widget.Toolbar</span><br><span class="line">        android:id=&quot;@+id/tbar&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/tv_title&quot;</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:text=&quot;tv标题&quot; /&gt;</span><br><span class="line">    &lt;/android.support.v7.widget.Toolbar&gt;</span><br><span class="line">&lt;/RelativeLayout&gt;</span><br></pre></td></tr></table></figure><p>效果图:<br><img src="/2017/11/06/Toolbar/t1.png" alt=""><br>Toolbar正常显示,没有设置背景色所以看不到具体高度.继续</p><h1 id="属性设置"><a href="#属性设置" class="headerlink" title="属性设置"></a>属性设置</h1><h2 id="背景颜色"><a href="#背景颜色" class="headerlink" title="背景颜色"></a>背景颜色</h2><p>可以直接添加background,但是为了统一,使用?attr/colorPrimary. Toolbar中添加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:background=&quot;?attr/colorPrimary&quot;</span><br></pre></td></tr></table></figure></p><p><img src="/2017/11/06/Toolbar/t2.png" alt=""></p><h2 id="title-subtitle-logo-navigation…"><a href="#title-subtitle-logo-navigation…" class="headerlink" title="title,subtitle,logo,navigation…"></a>title,subtitle,logo,navigation…</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Toolbar toolbar = findViewById(R.id.tbar);</span><br><span class="line">toolbar.setLogo(R.mipmap.ic_launcher);</span><br><span class="line">toolbar.setTitle(&quot;Title&quot;);</span><br><span class="line">toolbar.setSubtitle(&quot;Subtitle&quot;);</span><br><span class="line">setSupportActionBar(toolbar);//把toolbar作为操作栏,必不可少</span><br><span class="line">toolbar.setNavigationIcon(R.mipmap.nav);</span><br></pre></td></tr></table></figure><p>效果图:<br><img src="/2017/11/06/Toolbar/t3.png" alt=""><br>如果你想修改标题和子标题的字体大小、颜色等，可以调用 setTitleTextColor 、 setTitleTextAppearance 、 setSubtitleTextColor 、 setSubtitleTextAppearance 这些API。  </p><p>这些属性也可在.xml文件中设置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.v7.widget.Toolbar</span><br><span class="line">        ...</span><br><span class="line">        app:logo=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">        app:subtitle=&quot;subtitle&quot;</span><br><span class="line">        app:title=&quot;Title&quot;&gt;</span><br></pre></td></tr></table></figure></p><h2 id="添加菜单选项"><a href="#添加菜单选项" class="headerlink" title="添加菜单选项"></a>添加菜单选项</h2><p>新建res/menu/menu_toolbar.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/share&quot;</span><br><span class="line">        android:title=&quot;分析&quot;</span><br><span class="line">        android:icon=&quot;@mipmap/share&quot;</span><br><span class="line">        app:showAsAction=&quot;ifRoom&quot;/&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/search&quot;</span><br><span class="line">        android:title=&quot;搜索&quot;</span><br><span class="line">        android:icon=&quot;@mipmap/search&quot;</span><br><span class="line">        app:showAsAction=&quot;ifRoom&quot;/&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/collection&quot;</span><br><span class="line">        android:title=&quot;收藏&quot;</span><br><span class="line">        android:icon=&quot;@mipmap/collection&quot;</span><br><span class="line">        app:showAsAction=&quot;ifRoom&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/setting&quot;</span><br><span class="line">        android:title=&quot;设置&quot;</span><br><span class="line">        app:showAsAction=&quot;never&quot;/&gt;</span><br><span class="line">&lt;/menu&gt;</span><br></pre></td></tr></table></figure></p><p>app:showAsAction=”ifRoom|never”;ifRoom:toolbar能放得下,就显示在toolbar,否则折叠到更多;never直接折叠到更多  </p><p>Activity重新onCreateOptionMenu(),将此菜单加载进去<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public boolean onCreateOptionsMenu(Menu menu) &#123;</span><br><span class="line">    getMenuInflater().inflate(R.menu.menu_toolbar,menu);</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>效果图:<br><img src="/2017/11/06/Toolbar/t4.png" alt=""></p><p>若没有出现menu,请检查是否有将toolbar作为操作栏:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setSupportActionBar(toolbar);//把toolbar作为操作栏,必不可少</span><br></pre></td></tr></table></figure></p><h2 id="添加点击事件"><a href="#添加点击事件" class="headerlink" title="添加点击事件"></a>添加点击事件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">toolbar.setOnMenuItemClickListener(new Toolbar.OnMenuItemClickListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public boolean onMenuItemClick(MenuItem item) &#123;</span><br><span class="line">        int itemId = item.getItemId();</span><br><span class="line">        String s = &quot;&quot;;</span><br><span class="line">        switch (itemId)&#123;</span><br><span class="line">            case R.id.share:</span><br><span class="line">                s = &quot;share&quot;;</span><br><span class="line">                break;</span><br><span class="line">            case R.id.search:</span><br><span class="line">                s = &quot;search&quot;;</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">        Toast.makeText(ToolBarActivity.this,s+&quot; 被点击&quot;,Toast.LENGTH_SHORT).show();</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="样式修改-美化"><a href="#样式修改-美化" class="headerlink" title="样式修改(美化)"></a>样式修改(美化)</h2><ol><li>上图可以看出右边3个竖排圆点式黑色的,如果想修改为白色?<br>主题中设置: android:textColorSecondary  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;style name=&quot;AppTheme&quot; parent=&quot;Theme.AppCompat.Light.NoActionBar&quot;&gt;</span><br><span class="line">    ...</span><br><span class="line">    &lt;item name=&quot;android:textColorSecondary&quot;&gt;#ffffff&lt;/item&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></li></ol><p><img src="/2017/11/06/Toolbar/t6.png" alt=""></p><ol start="2"><li>popup menu背景颜色字体颜色修改  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- toolbar弹出菜单样式 --&gt;</span><br><span class="line">&lt;style name=&quot;ToolbarPopupTheme&quot; parent=&quot;@style/ThemeOverlay.AppCompat.Dark&quot;&gt;</span><br><span class="line">    &lt;item name=&quot;android:colorBackground&quot;&gt;#000000&lt;/item&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></li></ol><p>toolbar添加属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">toolbar:popupTheme=&quot;@style/toolbarpopuptheme&quot;</span><br></pre></td></tr></table></figure></p><p>效果图<br><img src="/2017/11/06/Toolbar/t7.png" alt=""><br>如此就能改变menu弹出菜单的背景颜色,同时文字颜色也会自动调整  </p><ol start="3"><li>修改popup menu 弹出位置<br>默认情况popup menu覆盖在toolbar上,如上图.想要其在toolbar下方<br>修改styles.xml:  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;style name=&quot;ToolbarPopupTheme&quot; parent=&quot;@style/ThemeOverlay.AppCompat.Dark&quot;&gt;    </span><br><span class="line">    &lt;item name=&quot;android:colorBackground&quot;&gt;#000000&lt;/item&gt;    </span><br><span class="line">    &lt;item name=&quot;actionOverflowMenuStyle&quot;&gt;@style/OverflowMenuStyle&lt;/item&gt; &lt;!--新增一个item，用于控制menu--&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;style name=&quot;OverflowMenuStyle&quot; parent=&quot;Widget.AppCompat.Light.PopupMenu.Overflow&quot;&gt;   </span><br><span class="line">     &lt;item name=&quot;overlapAnchor&quot;&gt;false&lt;/item&gt;  &lt;!--把该属性改为false即可使menu位置位于toolbar之下--&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></li></ol><p>效果图:<br><img src="/2017/11/06/Toolbar/t8.png" alt=""></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>Toolbar使用比较简单(设置title,logo…,popup menu),美化.<br>做个小结  </p><ol><li>向下兼容用v7包(引入support v7包)</li><li>主题使用v7包的Theme.AppCompay</li><li>一系列的参数设置(title,logo…),可以在代码中写,也可以做xml文件中写</li><li>添加菜单项:新建menu文件,Activity重写onCreateOptionMenu方法,并在此方法中加载menu</li><li>menu点击事件setOnMenuItemClickListener()</li><li>样式修改(美化):更多选项图标颜色修改;popup menu背景颜色修改;弹出框弹出位置修改.</li></ol>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>DrawerLayout</title>
      <link href="/2017/11/03/DrawerLayout/"/>
      <url>/2017/11/03/DrawerLayout/</url>
      <content type="html"><![CDATA[<p>DrawerLayout:抽屉布局;DrawerLayout + NavigationView 效果绝佳.<br>使用DrawerLayout需要导入Design包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;com.android.support:design:26.1.0&apos;</span><br></pre></td></tr></table></figure></p><h1 id="xml"><a href="#xml" class="headerlink" title=".xml"></a>.xml</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.v4.widget.DrawerLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    android:id=&quot;@+id/dl&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;RelativeLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:paddingTop=&quot;@dimen/tool_bar_top_padding&quot;</span><br><span class="line">        android:background=&quot;#33ff0000&quot;&gt;</span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:text=&quot;content&quot;</span><br><span class="line">            android:textSize=&quot;24sp&quot;/&gt;</span><br><span class="line">    &lt;/RelativeLayout&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.design.widget.NavigationView</span><br><span class="line">        android:id=&quot;@+id/nav&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:layout_gravity=&quot;start&quot;</span><br><span class="line">        app:menu=&quot;@menu/draw_menu&quot;</span><br><span class="line">app:headerLayout=&quot;@layout/nav_headerlayout&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/android.support.design.widget.NavigationView&gt;</span><br></pre></td></tr></table></figure><p>最外层是DrawerLayout,包含2部分内容:<br>主内容一定要是DrawerLayout的第一个子视图,并且宽高都是math_parent[上例RelativeLayout为主内容];<br>NavigationView为抽屉. 关键:此属性android:layout_gravity=”start”定义抽屉从左滑出,或”end”从右滑出,不推荐使用left和right.<br>NavigationView:为导航菜单,后面会具体讲解.</p><h1 id="监听事件"><a href="#监听事件" class="headerlink" title="监听事件"></a>监听事件</h1><p>DrawerLayout.DrawerLayoutListener作为监听器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">drawerLayout.addDrawerListener(new MyDrawerListener());</span><br><span class="line">private class MyDrawerListener implements DrawerLayout.DrawerListener&#123;</span><br><span class="line">        public void onDrawerSlide(View drawerView, float slideOffset) &#123;</span><br><span class="line">            //当抽屉被滑动时调用 滑动幅度0-1</span><br><span class="line">        &#125;</span><br><span class="line">        public void onDrawerOpened(View drawerView) &#123;</span><br><span class="line">            //抽屉完全被打开</span><br><span class="line">        &#125;</span><br><span class="line">        public void onDrawerClosed(View drawerView) &#123;</span><br><span class="line">            //抽屉完全被关闭</span><br><span class="line">        &#125;</span><br><span class="line">        public void onDrawerStateChanged(int newState) &#123;</span><br><span class="line">            //当抽屉状态改变时候被调用</span><br><span class="line">            //状态是state:0(闲置);1(拖拽);2(固定)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>或设置DrawerListener的子类SimpleDrawerListener，使用这个类的时候不必实现全部的回调函数，可以根据自己的需要重写相应的方法。</p><h1 id="NavigationView"><a href="#NavigationView" class="headerlink" title="NavigationView"></a>NavigationView</h1><p>上例xml中的NavigationView可以换成别的来定义侧滑菜单部分,但是需要花费时间.使用NavigationView简单,统一.<br>NavigationView分为两部分,上面一部分叫做HeaderLayout,下面的是Menu</p><h2 id="NavigationView属性"><a href="#NavigationView属性" class="headerlink" title="NavigationView属性"></a>NavigationView属性</h2><p>上例NavigationView部分<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.design.widget.NavigationView</span><br><span class="line">        android:id=&quot;@+id/nav&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:layout_gravity=&quot;start&quot;</span><br><span class="line">        app:menu=&quot;@menu/draw_menu&quot;</span><br><span class="line">app:headerLayout=&quot;@layout/nav_headerlayout&quot;&gt;</span><br></pre></td></tr></table></figure></p><p>属性解释:</p><ol><li>android:layout_gravity=”start”:表示该view从左侧滑出(end:右侧),<strong>必须指定</strong>.</li><li>app:headerLayout=”@layout/nav_headerlayout”:引用一个头部布局,就是图1上面的蓝色背景部分,包含背景和用户名welau.</li><li>app:menu=”@menu/draw_menu”:引用一个menu作为下面的点击项.<br>HeaderLayout布局nav_headerlayout.xml:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;100dp&quot;</span><br><span class="line">    android:background=&quot;#4400ffff&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=&quot;@+id/tv_headerlayout&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">        android:layout_marginTop=&quot;@dimen/tool_bar_top_padding&quot;</span><br><span class="line">        android:text=&quot;welau&quot;</span><br><span class="line">        android:textSize=&quot;24sp&quot; /&gt;</span><br><span class="line">&lt;/RelativeLayout&gt;</span><br></pre></td></tr></table></figure></li></ol><p>Menu文件draw_menu.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/item1&quot;</span><br><span class="line">        android:icon=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">        android:title=&quot;定制&quot;/&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/item2&quot;</span><br><span class="line">        android:icon=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">        android:title=&quot;我的&quot;/&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/item3&quot;</span><br><span class="line">        android:icon=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">        android:title=&quot;设置&quot;/&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/item4&quot;</span><br><span class="line">        android:icon=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">        android:title=&quot;关于&quot;/&gt;</span><br><span class="line">&lt;/menu&gt;</span><br></pre></td></tr></table></figure></p><p>看看效果<br><img src="/2017/11/03/DrawerLayout/demo1.png" alt=""><br>问题:图片都变成了灰色!!!</p><ol><li>NavigationView布局中添加app:itemIconTint=”#f00”,那么图标就变成了红色!!!<br><img src="/2017/11/03/DrawerLayout/demo2.png" alt=""></li><li>使用原图显示,在java代码中设置:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigationView.setItemIconTintList(null);</span><br></pre></td></tr></table></figure></li></ol><p><img src="/2017/11/03/DrawerLayout/demo3.png" alt=""></p><p>还有2个常用属性:</p><ol><li>app:itemBackground=”@color/colorAccent”设置item的背景颜色</li><li>app:itemTextColor=””设置item的文字颜色</li></ol><h2 id="Menu属性"><a href="#Menu属性" class="headerlink" title="Menu属性"></a>Menu属性</h2><p>menu item间添加分割线:<br>使用group,并给该group设置id(必须设置,不然无效)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">    &lt;group android:id=&quot;@+id/g1&quot;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id=&quot;@+id/item1&quot;</span><br><span class="line">            android:icon=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">            android:title=&quot;定制&quot; /&gt;</span><br><span class="line">    &lt;/group&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/item2&quot;</span><br><span class="line">        android:icon=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">        android:title=&quot;我的&quot; /&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/item3&quot;</span><br><span class="line">        android:icon=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">        android:title=&quot;设置&quot; /&gt;</span><br><span class="line">    &lt;group android:id=&quot;@+id/g2&quot;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id=&quot;@+id/item4&quot;</span><br><span class="line">            android:icon=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">            android:title=&quot;关于&quot; /&gt;</span><br><span class="line">    &lt;/group&gt;</span><br><span class="line">&lt;/menu&gt;</span><br></pre></td></tr></table></figure></p><p>效果图:<br><img src="/2017/11/03/DrawerLayout/demo4.png" alt=""></p><h2 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h2><h3 id="头部点击事件"><a href="#头部点击事件" class="headerlink" title="头部点击事件"></a>头部点击事件</h3><p>获取头部控件HeaderLayout:例子中的nav_headerlayout.layout<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//获取头布局文件  </span><br><span class="line">View headerView = navigationView.getHeaderView(0);</span><br></pre></td></tr></table></figure></p><p>通过headerView.findViewById()获取HeaderLayout中的view<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">View headerView = navigationView.getHeaderView(0);</span><br><span class="line">        TextView tv_name = headerView.findViewById(R.id.tv_name);</span><br><span class="line">        tv_name.setText(&quot;header&quot;);</span><br></pre></td></tr></table></figure></p><p>效果图:<br><img src="/2017/11/03/DrawerLayout/demo5.png" alt=""></p><h3 id="Menu-item点击事件"><a href="#Menu-item点击事件" class="headerlink" title="Menu item点击事件"></a>Menu item点击事件</h3><p>navigationView.setNavigationItemSelectedListener(NavigationItemSelectedListener)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">navigationView.setNavigationItemSelectedListener(new NavigationView.OnNavigationItemSelectedListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public boolean onNavigationItemSelected(@NonNull MenuItem item) &#123;</span><br><span class="line">                int itemId = item.getItemId();</span><br><span class="line">                switch (itemId) &#123;</span><br><span class="line">                    case R.id.item1:</span><br><span class="line">                        Toast.makeText(DrawerLayoutActivity.this,&quot;item1被点击&quot;,Toast.LENGTH_LONG).show();</span><br><span class="line">                        break;</span><br><span class="line">                    case R.id.item2:</span><br><span class="line">                        break;</span><br><span class="line">                    case R.id.item3:</span><br><span class="line">                        break;</span><br><span class="line">                    case R.id.item4:</span><br><span class="line">                        break;</span><br><span class="line">                &#125;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></p><p>效果图:<br><img src="/2017/11/03/DrawerLayout/demo6.png" alt=""></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ol><li>DrawerLayout:抽屉布局,第一个Layout为主内容区域,侧滑菜单必须指定android:layout_gravity=”start|end”;  </li><li>DrawerLayout事件:drawerLayout.addDrawerListener(DrawerListener)</li><li>侧滑菜单可是自己写也可以使用NavigationView;</li><li>NavigationView中app:headerLayout引入头部布局,常见app显示图片加文字; app:menu引入item;</li><li>NavigationView 通过getHeaderView获取引入的头部布局;</li><li>NavigationView menu item的点击事件:setNavigationItemSelectedListener()</li></ol>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>TextInputLayout</title>
      <link href="/2017/11/03/TextInputLayout/"/>
      <url>/2017/11/03/TextInputLayout/</url>
      <content type="html"><![CDATA[<p><img src="/2017/11/03/TextInputLayout/til.gif" alt=""><br>TextInputLayout是用来增强Edittext[TextInputEditText]，使用的时候包裹Edittext。当edittext获取焦点是，edittext的hint值就会浮到edittext的上方;setError(str)下方出现提示</p><a id="more"></a><h1 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h1><p>TextInputLayout是在Material Design中的,如果我们要使用的话,必须在gradle文件中配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    compile &apos;com.android.support:appcompat-v7:25.0.1&apos;</span><br><span class="line">    compile &apos;com.android.support:design:25.0.1&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="使用-（xml）"><a href="#使用-（xml）" class="headerlink" title="使用 （xml）"></a>使用 （xml）</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.design.widget.TextInputLayout</span><br><span class="line">        android:id=&quot;@+id/til_1&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        app:layout_constraintEnd_toEndOf=&quot;parent&quot;</span><br><span class="line">        app:layout_constraintStart_toStartOf=&quot;parent&quot;</span><br><span class="line">        app:layout_constraintTop_toTopOf=&quot;parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;EditText</span><br><span class="line">            android:id=&quot;@+id/et_1&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:hint=&quot;name&quot; /&gt;</span><br><span class="line">    &lt;/android.support.design.widget.TextInputLayout&gt;</span><br></pre></td></tr></table></figure><p>使用TextInputLayout包裹一个（只能是一个）EdiTtext。hint可以在TextInputLayout或EditText中设置。</p><h1 id="属性说明"><a href="#属性说明" class="headerlink" title="属性说明"></a>属性说明</h1><h2 id="浮动标签（hintEnable）"><a href="#浮动标签（hintEnable）" class="headerlink" title="浮动标签（hintEnable）"></a>浮动标签（hintEnable）</h2><p>若想关闭浮动标签（默认开启）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:hintEnable=&quot;false&quot;</span><br></pre></td></tr></table></figure></p><h2 id="浮动标签过渡动画"><a href="#浮动标签过渡动画" class="headerlink" title="浮动标签过渡动画"></a>浮动标签过渡动画</h2><p>浮动标签显示与隐藏之间有一个过渡动画(默认是开启的),可以通过以下方法设置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:hintAnimationEnabled=&quot;false&quot;</span><br></pre></td></tr></table></figure></p><h2 id="计数器（counterEnable）"><a href="#计数器（counterEnable）" class="headerlink" title="计数器（counterEnable）"></a>计数器（counterEnable）</h2><p>如果我们想要在账号那栏后面加个字数统计,例如当我们的账号是固定位数时(例如手机号码,),我们可以让用户看到自己当前输入的长度,我们只需要在TextInputLayout加入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:counterEnabled=&quot;true&quot;</span><br></pre></td></tr></table></figure></p><h2 id="设置最大长度"><a href="#设置最大长度" class="headerlink" title="设置最大长度"></a>设置最大长度</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:counterMaxLength=&quot;11&quot;</span><br></pre></td></tr></table></figure><p><img src="/2017/11/03/TextInputLayout/til_counter.png" alt=""><br>此属性并不能限制用户输入，而是用另一种颜色提示用户输入长度超过了设置长度</p><h2 id="setError-错误提示"><a href="#setError-错误提示" class="headerlink" title="setError() 错误提示"></a>setError() 错误提示</h2><p>TextInputLayout提供了错误提示的方法，出现在EditText下方；setError（null）取消错误提示</p><h2 id="密码可见按钮"><a href="#密码可见按钮" class="headerlink" title="密码可见按钮"></a>密码可见按钮</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:passwordToggleEnabled=&quot;true&quot; //默认是关闭的</span><br></pre></td></tr></table></figure><p>需要在子EditText中加入属性android:inpuTtype=”textPassword”<br><img src="/2017/11/03/TextInputLayout/til_pwdtoggle.png" alt=""></p><h3 id="自定义密码可见按钮图标"><a href="#自定义密码可见按钮图标" class="headerlink" title="自定义密码可见按钮图标"></a>自定义密码可见按钮图标</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:passwordToggleDrawable=&quot;@mipmap/ic_launcher&quot;</span><br></pre></td></tr></table></figure><h3 id="密码可见按钮上色"><a href="#密码可见按钮上色" class="headerlink" title="密码可见按钮上色"></a>密码可见按钮上色</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:passwordToggleTint=&quot;@color/colorAccent&quot;</span><br></pre></td></tr></table></figure><h3 id="密码可见按钮设置模式"><a href="#密码可见按钮设置模式" class="headerlink" title="密码可见按钮设置模式"></a>密码可见按钮设置模式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//screen,src_in,src_atop,src_over,multiply等几种设计模式</span><br><span class="line">app:passwordToggleTintMode=&quot;screen&quot; //screen</span><br></pre></td></tr></table></figure><h2 id="自定义浮动标签"><a href="#自定义浮动标签" class="headerlink" title="自定义浮动标签"></a>自定义浮动标签</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:hintTextAppearance=&quot;@style/hintAppearance&quot;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;style name=&quot;hintAppearance&quot; parent=&quot;TextAppearance.AppCompat&quot;&gt;</span><br><span class="line">        &lt;item name=&quot;android:textSize&quot;&gt;14sp&lt;/item&gt;</span><br><span class="line">        &lt;item name=&quot;android:textColor&quot;&gt;#ffee00&lt;/item&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h2 id="自定义错误提示样式"><a href="#自定义错误提示样式" class="headerlink" title="自定义错误提示样式"></a>自定义错误提示样式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:errorTextAppearance=&quot;@style/errorAppearance&quot;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;style name=&quot;errorAppearance&quot; parent=&quot;TextAppearance.AppCompat&quot;&gt;</span><br><span class="line">        &lt;item name=&quot;android:textSize&quot;&gt;14sp&lt;/item&gt;</span><br><span class="line">        &lt;item name=&quot;android:textColor&quot;&gt;@color/red&lt;/item&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h1 id="补充（EditText-和-TextInputEditText区别）"><a href="#补充（EditText-和-TextInputEditText区别）" class="headerlink" title="补充（EditText 和 TextInputEditText区别）"></a>补充（EditText 和 TextInputEditText区别）</h1><p>继承关系：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java.lang.Object</span><br><span class="line">   ↳    android.view.View</span><br><span class="line">        ↳    android.widget.TextView</span><br><span class="line">             ↳    android.widget.EditText</span><br><span class="line">                  ↳    android.support.v7.widget.AppCompatEditText</span><br><span class="line">                       ↳    android.support.design.widget.TextInputEditText</span><br></pre></td></tr></table></figure></p><p>TextInputEditText作为EditText的子类，为TextInputLayout设计的一个子容器。输入法在’extract’模式的时候，使用TextInputEditText类允许显示提示，而EditText则没有。<br><img src="/2017/11/03/TextInputLayout/textinputedittext.gif" alt=""><br>上图，用户名使用的事EditText。密码使用的是TextInputEditText,可以看到输入的时候都变成了全屏模式，用户名使用EidtText的时候hint就隐藏了，而密码使用TextInputEditText的时候hint可以正常显示。<br>由此可见TextInputEditText的设计就是修复了这个缺陷，所以TextInputLayout和TextInputEditText配合使用的效果最好!</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>TextInputLayout包裹EditText，帮助EditText做些事情：<br>1.hint提到EditText头上去；<br>2.错误提示放在下发；EditTEXT原本也有错误提示，在输入框右边；<br>3.密码小眼睛（app:passwordToggleEnabled=”true”）。<br>4.TextInputLayout应和TextInputEditText配合使用，不推荐配合EditText使用。  </p><p>参考:<br><a href="http://blog.csdn.net/johnny901114/article/details/51918436" target="_blank" rel="noopener">http://blog.csdn.net/johnny901114/article/details/51918436</a><br><a href="http://www.jianshu.com/p/a9b48dee86e0" target="_blank" rel="noopener">http://www.jianshu.com/p/a9b48dee86e0</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ConstraintLayout-进阶的RelativeLayout</title>
      <link href="/2017/11/02/ConstraintLayout-%E8%BF%9B%E9%98%B6%E7%9A%84RelativeLayout/"/>
      <url>/2017/11/02/ConstraintLayout-%E8%BF%9B%E9%98%B6%E7%9A%84RelativeLayout/</url>
      <content type="html"><![CDATA[<p>伴随着Android Studio 2.2的正式推送,最大的亮点是布局的蓝图模式以及与之配套的ConstraintLayout关注度一下子高了起来.  </p><p>ConstraintLayout,翻译过来,可以叫约束布局,其子view就是通过一个个属性的约束,来决定自己的位置,大小,而传统的RelativeLayout也类似,所以可以看成是RelativeLayout的一种进化版版本,属性布局用法相对RelativeLayout来说较为复杂,但是当你熟悉之后你会爱上它的.  </p><p>众所周知,Android APP的布局复杂度会极大的影响程序的流畅度,传统的ViewGroup用的最多的就是RelativeLayout与LineaLayout.  </p><p>一般能用RelativeLayout替换LineaLayout就替换,因为LinearLayout虽然简单,但是会加深层级.  </p><p>而有时候却不得不使用LinearLayout,在于LinearLayout有一个layout_weight属性,可以设置LinearLayout的ChildView按照一定的比例布局,这是RelativeLayout做不到的.  </p><p>ConstraintLayout的其他的属性和用法基本与RelativeLayout一致,如果对RelativeLayout比较熟悉的童鞋很容易上手,而ConstraintLayout<strong>最大的优点便是可以添加比例的控制</strong>.  </p><h1 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h1><p>ConstraintLayout约束布局的含义: 根据布局中的其他元素或视图, 确定View在屏幕中的位置, 受到三类约束, 即其他视图, 父容器(parent), 基准线(Guideline).<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">layout_constraint[本源位置]_[目标位置]=&quot;[目标ID]&quot;</span><br></pre></td></tr></table></figure></p><p>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:layout_constraintBottom_toBottomOf=&quot;@+id/constraintLayout&quot;</span><br></pre></td></tr></table></figure></p><p>约束当前View的底部至目标View的底部, 目标View是constraintLayout. 即, 把当前View的底部对齐到constraintLayout的底部.  </p><h1 id="基本约束属性"><a href="#基本约束属性" class="headerlink" title="基本约束属性"></a>基本约束属性</h1><p>ConstraintLayout是RelativeLayout的进化版,如果RelativeLayout的子view没有设置任何基本属性,则置于左上角,ConstraintLayout同理.  </p><p>ConstraintLayout基本属性的值可以是某个控件的id,也可以是”parent”,简单的概括就是top,bottom,left,right,baseline.  </p><h1 id="约束属性值为id时对照表"><a href="#约束属性值为id时对照表" class="headerlink" title="约束属性值为id时对照表"></a>约束属性值为id时对照表</h1><p><img src="/2017/11/02/ConstraintLayout-进阶的RelativeLayout/duizhao.png" alt="对照表"></p><h1 id="约束属性值等于parent"><a href="#约束属性值等于parent" class="headerlink" title="约束属性值等于parent"></a>约束属性值等于parent</h1><p>当基本属性值为parent时,必须成对出现才有意义,即top与bottom,left与right,start与end成对.  </p><h1 id="比例属性闪亮登场"><a href="#比例属性闪亮登场" class="headerlink" title="比例属性闪亮登场"></a>比例属性闪亮登场</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">layout_constraintHorizontal_bias=&quot;0.4&quot;</span><br><span class="line">layout_constraintVertical_bias=&quot;0.6&quot;</span><br></pre></td></tr></table></figure><p>这两个属性接受浮点型,是一个比例,数值在0-1之间,如不写这属性,默认为0.5  </p><p>点击左下角切换的Design,再点击Button选中这个控件,右边栏会出现约束属性图  </p><p><img src="/2017/11/02/ConstraintLayout-进阶的RelativeLayout/constraintVertical_bias.png" alt=""></p><p>属性理解：</p><ol><li>箭头向里 表示控件的宽度/高度是适应内容的,弹簧状（“工”字形） 表示控件是宽度/高度是具体数值</li><li>上下两个0表示控件的上下margin是0dp</li><li>小球50这个数值表示在垂直方向上,上下的比例是0.5:0.5<br>鼠标拖动小球,上下移动会发现数值,控件垂直方向上的位置都跟着改变.拖动到20,切换到代码,会发现代码新增了一个属性,此时控件的上下比例是:0.2<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:layout_constraintVertical_bias=&quot;0.2&quot;</span><br></pre></td></tr></table></figure></li></ol><h1 id="控件大小比例属性"><a href="#控件大小比例属性" class="headerlink" title="控件大小比例属性"></a>控件大小比例属性</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:layout_constraintDimensionRatio=&quot;1:2&quot;</span><br></pre></td></tr></table></figure><p>子view控制自身的宽高比（宽高1:2）<br>**注意：</p><ol><li>这个属性生效需要以下条件：left，right，top，bottom 四条边中至少一个约束</li><li>宽高有且只有一个是0dp**</li></ol><h1 id="Guideline导航线"><a href="#Guideline导航线" class="headerlink" title="Guideline导航线"></a>Guideline导航线</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app:layout_constraintGuide_begin=&quot;50dp&quot;</span><br><span class="line">app:layout_constraintGuide_end=&quot;50dp&quot;</span><br><span class="line">app:layout_constraintGuide_percent=&quot;50&quot;</span><br></pre></td></tr></table></figure><p>介绍导航线之前,先想一下,根据上面对ConstraintLayout的介绍,要你布置一个菜单控件,菜单栏每一项均分屏幕宽度,按照以前使用LinearLayout,会把每一个子view的weight设置为1,则均分了屏幕宽度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout&gt;</span><br><span class="line">    &lt;View/&gt;</span><br><span class="line">    &lt;View/&gt;</span><br><span class="line">    &lt;View/&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p><p>而使用ConstraintLayout则会发现前面介绍的比例,是相对parent来说的,如果要均分屏幕宽度,必须借助透明的分割线来布局<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;ConstraintLayout&gt;</span><br><span class="line">    &lt;View,右边约束分割线1/&gt;</span><br><span class="line">    &lt;分割线1,距离左边33%/&gt;</span><br><span class="line">    &lt;View,左边约束分割线1,右边约束分割线2/&gt;</span><br><span class="line">    &lt;分割线2,距离左边66%/&gt;</span><br><span class="line">    &lt;View,左边约束分割线2/&gt;</span><br><span class="line">&lt;/ConstraintLayout&gt;</span><br></pre></td></tr></table></figure></p><p>而这个分割线其实谷歌已经帮我们写好了,就是Guideline.蓝图介绍中,6对应的就是添加导航线.切换到蓝图模式,点击6,就可以添加一个水平/垂直的导航线  </p><p><img src="/2017/11/02/ConstraintLayout-进阶的RelativeLayout/guide.png" alt=""></p><p>添加垂直导航线</p><p><img src="/2017/11/02/ConstraintLayout-进阶的RelativeLayout/guide_ver.png" alt=""></p><p>Guideline属性对照表</p><p><img src="/2017/11/02/ConstraintLayout-进阶的RelativeLayout/guide_dzb.png" alt=""></p><p>Guideline属性值</p><p>Guideline本身对于用户来说是不可见的,所以其宽高的值没有任何意义,也不起作用.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.constraint.Guideline</span><br><span class="line">    android:id=&quot;@+id/guideline&quot;</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;//无意义</span><br><span class="line">    android:layout_height=&quot;10dp&quot;//无意义</span><br><span class="line">    android:orientation=&quot;vertical&quot;//决定这是一条水平导航线还是垂直导航线</span><br><span class="line">    app:layout_constraintGuide_percent=&quot;0.333&quot;//决定导航线的位置</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p><p>此时再添加一条比例为0.666的导航线,即可三等分屏幕<br><img src="/2017/11/02/ConstraintLayout-进阶的RelativeLayout/guide_menu.png" alt=""></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>有了GuideLine就可以抛弃LinearLayout。单单使用ConstraintLayout写布局，减少布局层级。  </p><p>参考：<a href="http://www.jianshu.com/p/d64d845b6b90" target="_blank" rel="noopener">http://www.jianshu.com/p/d64d845b6b90</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>android material design组件学习</title>
      <link href="/2017/11/02/android-material-design%E7%BB%84%E4%BB%B6%E5%AD%A6%E4%B9%A0/"/>
      <url>/2017/11/02/android-material-design%E7%BB%84%E4%BB%B6%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a><a href="/2017/11/03/TextInputLayout/" title="TextInputLayout">TextInputLayout</a></h1><h1 id="-1"><a href="#-1" class="headerlink" title=""></a><a href="/2017/11/06/Toolbar/" title="Toolbar">Toolbar</a></h1><h1 id="-2"><a href="#-2" class="headerlink" title=""></a><a href="/2017/11/03/DrawerLayout/" title="DrawerLayout">DrawerLayout</a></h1><h1 id="-3"><a href="#-3" class="headerlink" title=""></a><a href="/2017/11/07/Snackbar/" title="Snackbar">Snackbar</a></h1><h1 id="-4"><a href="#-4" class="headerlink" title=""></a><a href="/2017/11/07/FloatingActionButton/" title="FloatingActionButton">FloatingActionButton</a></h1><h1 id="-5"><a href="#-5" class="headerlink" title=""></a><a href="/2017/11/07/TabLayout/" title="TabLayout">TabLayout</a></h1><h1 id="-6"><a href="#-6" class="headerlink" title=""></a><a href="/2017/11/08/CoordinatorLayout/" title="CoordinatorLayout">CoordinatorLayout</a></h1>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>android material design</title>
      <link href="/2017/11/02/android-material-design/"/>
      <url>/2017/11/02/android-material-design/</url>
      <content type="html"><![CDATA[<h1 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h1><p>material design的核心思想，就是把物理世界的体验带进屏幕。去掉现实中的杂质和随机性，保留其最原始纯净的形态、空间关系、变化与过渡，配合虚拟世界的灵活特性，还原最贴近真实的体验，达到简洁与直观的效果。</p><p>参考：<a href="http://www.uisdc.com/comprehensive-material-design-note" target="_blank" rel="noopener">http://www.uisdc.com/comprehensive-material-design-note</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>GreenDao 使用</title>
      <link href="/2017/05/27/GreenDao-%E4%BD%BF%E7%94%A8/"/>
      <url>/2017/05/27/GreenDao-%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>GreenDao是一个对象关系映射（ORM）的框架，能够提供一个接口通过操作对象的方式去操作关系型数据库，它能够让你操作数据库时更加单、方便。<br><img src="/2017/05/27/GreenDao-使用/orm.png" alt="ORM"></p><a id="more"></a><h1 id="GreenDao-优点"><a href="#GreenDao-优点" class="headerlink" title="GreenDao 优点"></a>GreenDao 优点</h1><ul><li>性能高，号称Android最快的关系型数据库</li><li>内存占用小</li><li>库文件比较小，小于100k，编译时间短，而且可以避免65k方法限制</li><li>支持数据库加密</li><li>简洁易用的API</li></ul><h1 id="GreenDao-3-0使用方法"><a href="#GreenDao-3-0使用方法" class="headerlink" title="GreenDao 3.0使用方法"></a>GreenDao 3.0使用方法</h1><h2 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h2><p>Project build.gradle<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">repositories &#123;</span><br><span class="line">mavenCentral()</span><br><span class="line">&#125;</span><br><span class="line">dependencies &#123;</span><br><span class="line">classpath &apos;org.greenrobot:greendao-gradle-plugin:3.2.2&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>app build.gradle<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: &apos;org.greenrobot.greendao&apos;</span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">greendao &#123;</span><br><span class="line">        schemaVersion 1  //版本</span><br><span class="line">        daoPackage &apos;om.example.test.db&apos; // 一般为app包名+生成文件的文件夹名</span><br><span class="line">        targetGenDir &apos;src/main/java&apos; //生成文件路径</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="新建实体类（Shop）"><a href="#新建实体类（Shop）" class="headerlink" title="新建实体类（Shop）"></a>新建实体类（Shop）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Shop &#123;</span><br><span class="line"></span><br><span class="line">    @Id(autoincrement = true)</span><br><span class="line">    private Long id;//id 主键 自增</span><br><span class="line"></span><br><span class="line">    @Unique</span><br><span class="line">    private String name;//商品名称 唯一</span><br><span class="line"></span><br><span class="line">    @Property(nameInDb = &quot;price&quot;)//自定义字段名</span><br><span class="line">    private String pro_price;</span><br><span class="line"></span><br><span class="line">    private int sell_num;//销售数量</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注解解释：  </p><ol><li>@entity：告诉GreenDao该对象为实体，只有被@Entity注释的Bean类才能被dao类操作</li><li>@id：对象的id，必须使用Long类型作为id，否则会报错</li><li>@Property：可以自定义字段名，注意外键不能使用该属性</li><li>@NotNull：属性不能为空</li><li>@Transient：使用该注释的属性不会被存入数据库的字段中</li><li>@Unique：唯一值</li><li>@Generated：编译后自动生成的构造函数、方法等的注释，提示构造函数、方法等不能被修改</li></ol><p>此时编译一下，自动生成Shop实体的构造方法和get、set方法，自动生成DaoMaster、DaoSession、ShopDao，在前面配置文件’daoPackage’，’targetGenDir’目录下<br><img src="/2017/05/27/GreenDao-使用/1.png" alt=""></p><p>此时相当于已经建好了数据表和字段都建好了，下面需要创建数据库。</p><h2 id="创建数据库（数据库名）"><a href="#创建数据库（数据库名）" class="headerlink" title="创建数据库（数据库名）"></a>创建数据库（数据库名）</h2><p>在程序启动的时候就去创建数据库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public class BaseApplication extends Application &#123;</span><br><span class="line"></span><br><span class="line">    private static DaoSession daoSession;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onCreate() &#123;</span><br><span class="line">        super.onCreate();</span><br><span class="line">        //配置数据库</span><br><span class="line">        setupDatabase();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 配置数据库</span><br><span class="line">     */</span><br><span class="line">    private void setupDatabase() &#123;</span><br><span class="line">        //创建数据库shop.db&quot;</span><br><span class="line">        DaoMaster.DevOpenHelper helper = new DaoMaster.DevOpenHelper(this, &quot;shop.db&quot;, null);</span><br><span class="line">        //获取可写数据库</span><br><span class="line">        SQLiteDatabase db = helper.getWritableDatabase();</span><br><span class="line">        //获取数据库对象</span><br><span class="line">        DaoMaster daoMaster = new DaoMaster(db);</span><br><span class="line">        //获取Dao对象管理者</span><br><span class="line">        daoSession = daoMaster.newSession();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static DaoSession getDaoInstant() &#123;</span><br><span class="line">        return daoSession;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>DevOpenHelper：创建SQLiteOpenHepler的具体实现<br>DaoMaster：GreenDao的顶级对象，作为数据库对象，用于创建表和删除表<br>DaoSession：管理所有的Dao对象，Dao对象中存在着增删改查等API</p><h2 id="数据库的增删改查"><a href="#数据库的增删改查" class="headerlink" title="数据库的增删改查"></a>数据库的增删改查</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">public class LoveDao &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 添加数据，如果有重复则覆盖</span><br><span class="line">     *</span><br><span class="line">     * @param shop</span><br><span class="line">     */</span><br><span class="line">    public static void insertLove(Shop shop) &#123;</span><br><span class="line">        BaseApplication.getDaoInstant().getShopDao().insertOrReplace(shop);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 删除数据</span><br><span class="line">     *</span><br><span class="line">     * @param id</span><br><span class="line">     */</span><br><span class="line">    public static void deleteLove(long id) &#123;</span><br><span class="line">        BaseApplication.getDaoInstant().getShopDao().deleteByKey(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 更新数据</span><br><span class="line">     *</span><br><span class="line">     * @param shop</span><br><span class="line">     */</span><br><span class="line">    public static void updateLove(Shop shop) &#123;</span><br><span class="line">        BaseApplication.getDaoInstant().getShopDao().update(shop);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 查询条件为Type=TYPE_LOVE的数据</span><br><span class="line">     *</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static List&lt;Shop&gt; queryLove() &#123;</span><br><span class="line">        return BaseApplication.getDaoInstant().getShopDao().queryBuilder().where(ShopDao.Properties.Type.eq(Shop.TYPE_LOVE)).list();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 查询全部数据</span><br><span class="line">     */</span><br><span class="line">    public static List&lt;Shop&gt; queryAll() &#123;</span><br><span class="line">        return BaseApplication.getDaoInstant().getShopDao().loadAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="操作介绍"><a href="#操作介绍" class="headerlink" title="操作介绍"></a>操作介绍</h3><p>增加单个数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">insert(shop)</span><br><span class="line">insertOrReplace(shop)</span><br></pre></td></tr></table></figure></p><p>增加多个数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">insertInTx(shopList)</span><br><span class="line">insertOrReplaceInTx(shopList)</span><br></pre></td></tr></table></figure></p><p>查询全部<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">loadAll()</span><br><span class="line">queryBuilder().list()</span><br></pre></td></tr></table></figure></p><p>查询附加单个/多个条件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">where(，，)</span><br><span class="line">whereOr(，，)</span><br></pre></td></tr></table></figure></p><p>查询附加排序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">orderDesc()</span><br><span class="line">orderAsc()</span><br></pre></td></tr></table></figure></p><p>查询限制当页个数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">limit()</span><br></pre></td></tr></table></figure></p><p>查询总个数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">count()</span><br></pre></td></tr></table></figure></p><p>修改单个/多个数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update(shop)</span><br><span class="line">updateInTx(shops)</span><br></pre></td></tr></table></figure></p><p>删除单个/多个数据/ByKey<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">delete(shop)</span><br><span class="line">deleteInTx(shops)</span><br><span class="line">deleteByKey(id)</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android 第三方框架 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>http和https的区别</title>
      <link href="/2017/05/25/http%E5%92%8Chttps%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/2017/05/25/http%E5%92%8Chttps%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      <content type="html"><![CDATA[<p>HTTPS（基于安全套接字层的超文本传输协议 或者是 HTTP over SSL）是一个Netscape开发的Web协议。<br>也可以说：HTTP = HTTP + SSL<br>HTTPS 在 HTTP 应用层的基础上使用安全套接字层作为自层</p><a id="more"></a><h1 id="TCP-三次握手、四次挥别："><a href="#TCP-三次握手、四次挥别：" class="headerlink" title="TCP 三次握手、四次挥别："></a>TCP 三次握手、四次挥别：</h1><h2 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h2><p>第一次握手：host1发送一个tcp标识位syn=1、ack=0的数据包给host2，并随机生成一个sequence number=3233.当host2接收到这个数据后，host2有syn=1可知host1是想建立连接；<br>第二次握手：host2对host1的请求进行确认，向host1发送应道好syn=1、ack=1、确认号ack newber=3234（此值是host1的序列化+1），并随机生成一个sequence number=36457，这样就告诉host1可以进行连接；<br>第三次握手：host1收到数据后检查ack nmuber是否是3233+1的值，以及ack的值是否为1，若为1，host1会发送ack=1、确认号码ack number=36457，告诉host2，你的请求连接被确认，连接可以建立。</p><h2 id="四次挥别"><a href="#四次挥别" class="headerlink" title="四次挥别"></a>四次挥别</h2><p>第一次挥手：当传输的数据到达尾部时，host1向host2发送fin=1标志位；可理解为host1向host2说，我这边的数据传送完了，我准备断开连接；<br>第二次挥手：因为tcp的连接是全双工的双向连接，关闭也是要从两边关闭，当host2收到host1发来的fin=1的标志位后，host2不会立刻向host1发送find=1的请求关闭信息，而是先向host1发送一个ack=1的应答信息；表示你请求关闭的请求我收到了，但我可能还有数据没有传送完，你再等下，等我数据传输完成了我就告诉你；<br>第三次挥手：host2完成了数据传输，向host1发送fin=1，host收到请求关闭连接的请求后，host1就明白host2的数据传输完成了，现在可以断开连接了；<br>第四次挥手：host1收到fin=1后，host1还是怕网络不稳定等原因，怕host2不知道他要断开连接，于是向host2发送ack=1确认信息进行确认，把自己设置成time_wait状态并启动定时器，若果host2没有收到ack，host2端tcp的定时器到达后，会要求host重新发送ack，当host收到ack后，host2就断开连接；当host等待2mls（2倍报文最大生存时间）后，没有收到host2的重传请求后，他就知道host2已收到ack，所以host1此时才关闭自己的连接。</p><h1 id="OSI-网络模型"><a href="#OSI-网络模型" class="headerlink" title="OSI 网络模型"></a>OSI 网络模型</h1><p>OSI网络模型：开放式通信系统互联参考模型。<br>物理层，数据链路层，网络层，传输层，会话层，表示层，应用层。</p><h1 id="http-和-https的不同之处"><a href="#http-和-https的不同之处" class="headerlink" title="http 和 https的不同之处"></a>http 和 https的不同之处</h1><ol><li>http的url以http://开头，而https 以https://开头</li><li>http是不安全的，而https是安全的</li><li>http的标准端口是80，https的是443</li><li>在osi网络模型中，http工作于应用层，而https工作于传输层</li><li>http无需加密，而https对传输的数据进行加密</li><li>http无需证书，而https需要认证证书</li></ol><h1 id="什么时候该使用https？"><a href="#什么时候该使用https？" class="headerlink" title="什么时候该使用https？"></a>什么时候该使用https？</h1><p>银行网站、支付网关、购物网站、登录页、电子邮件以及一些企业部门的网站应用应该使用https</p>]]></content>
      
      
        <tags>
            
            <tag> Http </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>git 使用</title>
      <link href="/2017/05/21/git-%E4%BD%BF%E7%94%A8/"/>
      <url>/2017/05/21/git-%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<h1 id="上传本地代码"><a href="#上传本地代码" class="headerlink" title="上传本地代码"></a>上传本地代码</h1><p>1.新建repository:<br>2.把github上面的仓库克隆到本地<br>git clone <a href="https://github.com/xxx/xxx.git（https://github.com/xxx/xxx.git仓库地址）" target="_blank" rel="noopener">https://github.com/xxx/xxx.git（https://github.com/xxx/xxx.git仓库地址）</a><br>这个步骤以后你的本地项目文件夹下面就会多出个文件夹，该文件夹名即为你github上面的项目名<br>然后把要上传的项目复制到本地项目文件夹中<br>3.git add .<br>4.git commit  -m  “提交信息”<br>5.git pull origin master<br>6.git push -u origin master  </p><h1 id="更新代码"><a href="#更新代码" class="headerlink" title="更新代码"></a>更新代码</h1><p>1.git status(查看当前的git仓库状态)<br>2.git add *(更新全部)<br>3.git commit -m “更新说明”<br>4.git pull(先git pull,拉取当前分支最新代码)<br>5.git push origin master(push到远程master分支上)  </p><p><em>参考</em><br><a href="https://www.cnblogs.com/zlxbky/p/7727895.html" target="_blank" rel="noopener">上传本地代码及更新代码到GitHub教程</a></p>]]></content>
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Android 性能优化</title>
      <link href="/2017/05/02/Android-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
      <url>/2017/05/02/Android-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
      <content type="html"><![CDATA[<p>前段时间公司主抓性能优化工作，借此春风也学习到了许多Android性能优化方面的知识。由于组内队友的给力，优化的成果也是比较喜人。同时也学习和实践了不少知识，特此记录。</p><a id="more"></a><h1 id="性能优化分析工具"><a href="#性能优化分析工具" class="headerlink" title="性能优化分析工具"></a>性能优化分析工具</h1><p>Android Profiler</p><h1 id="布局优化"><a href="#布局优化" class="headerlink" title="布局优化"></a>布局优化</h1><ol><li>减少布局嵌套</li><li>列表控件优化</li><li>使用include标签</li></ol><h1 id="算法优化"><a href="#算法优化" class="headerlink" title="算法优化"></a>算法优化</h1><p>查询考虑二分查找节省时间，尽量不要使用耗时的递归算法。必要的时候可以空间换时间来提高APP运行效率。</p><h1 id="谨慎使用抽象编程"><a href="#谨慎使用抽象编程" class="headerlink" title="谨慎使用抽象编程"></a>谨慎使用抽象编程</h1><p>抽象编程方式更加面向对象，需要编写额外的代码，虽然这些代码不会执行，但是却也要映射到内存当中会，不仅占用了更多内存，在执行效率上也会有所降低</p><h1 id="其他优化"><a href="#其他优化" class="headerlink" title="其他优化"></a>其他优化</h1><ol><li>异步处理耗时操作</li><li>替换矢量图：矢量图消耗内存</li><li>减少冗余log</li><li>尽量避免使用依赖注入框架</li><li>使用ProGuard简化代码</li></ol><h1 id="内存泄露"><a href="#内存泄露" class="headerlink" title="内存泄露"></a>内存泄露</h1><p>5中常见内存泄露及解决办法</p><h2 id="单例造成的内存泄露"><a href="#单例造成的内存泄露" class="headerlink" title="单例造成的内存泄露"></a>单例造成的内存泄露</h2><p>Android的单例模式非常受开发者的喜爱，不过使用的不恰当的话也会造成内存泄漏。因为单例的静态特性使得单例的生命周期和应用的生命周期一样长，这就说明了如果一个对象已经不需要使用了，而单例对象还持有该对象的引用，那么这个对象将不能被正常回收，这就导致了内存泄漏。</p><p>如果单例中需要传入context，如果传入Application的context，将没有问题，因为单例的生命周期和application的一样长；  如果传入Activity的context，当这个context所对应的Activity退出时，单例对象持有该Activity的引用不会被回收。</p><h2 id="非静态内部类创建静态实例"><a href="#非静态内部类创建静态实例" class="headerlink" title="非静态内部类创建静态实例"></a>非静态内部类创建静态实例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line">    private static TestResource mResource = null;//***</span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        if(mManager == null)&#123;</span><br><span class="line">            mManager = new TestResource();</span><br><span class="line">        &#125;</span><br><span class="line">        //...</span><br><span class="line">    &#125;</span><br><span class="line">    class TestResource &#123;</span><br><span class="line">        //...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>该静态实例一直会持有该Activity的引用，导致Activity不能正常回收</p><h2 id="Handler造成内存泄露"><a href="#Handler造成内存泄露" class="headerlink" title="Handler造成内存泄露"></a>Handler造成内存泄露</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line">    private Handler mHandler = new Handler() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void handleMessage(Message msg) &#123;</span><br><span class="line">            //...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        loadData();</span><br><span class="line">    &#125;</span><br><span class="line">    private void loadData()&#123;</span><br><span class="line">        //...request</span><br><span class="line">        Message message = Message.obtain();</span><br><span class="line">        mHandler.sendMessage(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这种写法就会造成内存泄露，由于mHandler是Handler的非静态匿名内部类的实例，所以它持有外部Activity的引用。消息队列是在一个Looper线程中不断轮询处理，当Activity退出消息队列还有未处理或正在处理消息，而消息队列中的Message持有mHandler实例的引用，mHandler又持有Activity的引用，所以导致该Activity无法及时回收。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">private MyHandler mHandler = new MyHandler(this);</span><br><span class="line">private static class MyHandler extends Handler &#123;</span><br><span class="line">private WeakReference&lt;Context&gt; reference;</span><br><span class="line">public MyHandler(Context context) &#123;</span><br><span class="line">reference = new WeakReference&lt;&gt;(context);</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">public void handleMessage(Message msg) &#123;</span><br><span class="line">MainActivity activity = (MainActivity) reference.get();</span><br><span class="line">if(activity != null)&#123;</span><br><span class="line">activity.mTextView.setText(&quot;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">protected void onDestroy() &#123;</span><br><span class="line">super.onDestroy();</span><br><span class="line">mHandler.removeCallbacksAndMessages(null);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="线程造成内存泄露"><a href="#线程造成内存泄露" class="headerlink" title="线程造成内存泄露"></a>线程造成内存泄露</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//——————test1</span><br><span class="line">        new AsyncTask&lt;Void, Void, Void&gt;() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            protected Void doInBackground(Void... params) &#123;</span><br><span class="line">                SystemClock.sleep(10000);</span><br><span class="line">                return null;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.execute();</span><br><span class="line">//——————test2</span><br><span class="line">        new Thread(new Runnable() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void run() &#123;</span><br><span class="line">                SystemClock.sleep(10000);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br></pre></td></tr></table></figure><p>上面的异步任务和Runable都是一个匿名内部类，因此它们对当前Activity都有一个隐式引用。如果Activity在销毁之前，任务还未完成，那么将导致Activity内存无法被回收，造成内存泄露。正确做法还是使用静态内部类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">static class MyAsyncTask extends AsyncTask&lt;Void, Void, Void&gt; &#123;</span><br><span class="line">        private WeakReference&lt;Context&gt; weakReference;</span><br><span class="line">  </span><br><span class="line">        public MyAsyncTask(Context context) &#123;</span><br><span class="line">            weakReference = new WeakReference&lt;&gt;(context);</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        @Override</span><br><span class="line">        protected Void doInBackground(Void... params) &#123;</span><br><span class="line">            SystemClock.sleep(10000);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        @Override</span><br><span class="line">        protected void onPostExecute(Void aVoid) &#123;</span><br><span class="line">            super.onPostExecute(aVoid);</span><br><span class="line">            MainActivity activity = (MainActivity) weakReference.get();</span><br><span class="line">            if (activity != null) &#123;</span><br><span class="line">                //...</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    static class MyRunnable implements Runnable&#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void run() &#123;</span><br><span class="line">            SystemClock.sleep(10000);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">//——————</span><br><span class="line">    new Thread(new MyRunnable()).start();</span><br><span class="line">    new MyAsyncTask(this).execute();</span><br></pre></td></tr></table></figure></p><p>这样就避免了Activity的内存资源泄漏，当然在Activity销毁时候也应该取消相应的任务AsyncTask::cancel()，避免任务在后台执行浪费资源。</p><h2 id="资源未关闭"><a href="#资源未关闭" class="headerlink" title="资源未关闭"></a>资源未关闭</h2><p>使用了BroadcastReceiver，ContentObserver,File,Cursor,Stream,Bitmap等资源时，应该在Activity销毁时及时关闭或者注销</p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>单例模式</title>
      <link href="/2016/07/07/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>/2016/07/07/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>因程序需要，有时候我们只需要某个类同时保留一个对象，不希望有更多对象，此时，需要用单例模式设计。<br>单例模式特点：</p><ol><li>只能有一个实例</li><li>单例类必须创建自己唯一的实例</li><li>单例类必须向其他对象提供这一实例</li></ol><h1 id="单例模式实现方式"><a href="#单例模式实现方式" class="headerlink" title="单例模式实现方式"></a>单例模式实现方式</h1><h2 id="1-饿汉模式"><a href="#1-饿汉模式" class="headerlink" title="1. 饿汉模式"></a>1. 饿汉模式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//饿汉模式</span><br><span class="line">private static SingletonDemo singletonDemo = new SingletonDemo();</span><br><span class="line">private SingletonDemo() &#123;&#125;</span><br><span class="line">public static SingletonDemo getInstance()&#123;</span><br><span class="line">return singletonDemo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>在运行这个类的时候进行一次loading，之后直接访问</em></p><h2 id="2-懒汉模式"><a href="#2-懒汉模式" class="headerlink" title="2. 懒汉模式"></a>2. 懒汉模式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//懒汉模式</span><br><span class="line">private static SingletonDemo singletonDemo;</span><br><span class="line">private SingletonDemo() &#123;&#125;</span><br><span class="line">public static SingletonDemo getInstance()&#123;</span><br><span class="line">if (null == singletonDemo)&#123;</span><br><span class="line">singletonDemo = new SingletonDemo();</span><br><span class="line">&#125;</span><br><span class="line">return singletonDemo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>线程不安全</em></p><h2 id="3-线程安全的懒汉模式"><a href="#3-线程安全的懒汉模式" class="headerlink" title="3. 线程安全的懒汉模式"></a>3. 线程安全的懒汉模式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">private static SingletonDemo singletonDemo;</span><br><span class="line">private SingletonDemo() &#123;&#125;</span><br><span class="line">public synchronized static SingletonDemo getInstance()&#123;</span><br><span class="line">if (null == singletonDemo)&#123;</span><br><span class="line">singletonDemo = new SingletonDemo();</span><br><span class="line">&#125;</span><br><span class="line">return singletonDemo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>使用synchronized线程安全了，但并发时这个锁占用了额外的资源，效率低</em></p><h2 id="4-DCL-双重校验锁法"><a href="#4-DCL-双重校验锁法" class="headerlink" title="4. DCL(双重校验锁法)"></a>4. DCL(双重校验锁法)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">private volatile static SingletonDemo singletonDemo;//声明成 volatile</span><br><span class="line">private SingletonDemo() &#123;&#125;</span><br><span class="line">public static SingletonDemo getInstance()&#123;</span><br><span class="line">if (null == singletonDemo)&#123;//第一次校验</span><br><span class="line">synchronized (SingletonDemo.class)&#123;</span><br><span class="line">if (null == singletonDemo)&#123;//第二次校验</span><br><span class="line">singletonDemo = new SingletonDemo();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return singletonDemo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>两次判断,这段代码看起来很完美，很可惜，它是有问题。主要在于instance = new Singleton()这句，这并非是一个原子操作，事实上在 JVM 中这句话大概做了下面 3 件事情。</p><ol><li>给 instance 分配内存</li><li>调用 Singleton 的构造函数来初始化成员变量</li><li>将instance对象指向分配的内存空间（执行完这步 instance 就为非 null 了)  </li></ol><p>但是在 JVM 的即时编译器中存在指令重排序的优化。也就是说上面的第二步和第三步的顺序是不能保证的，最终的执行顺序可能是 1-2-3 也可能是 1-3-2。如果是后者，则在 3 执行完毕、2 未执行之前，被线程二抢占了，这时 instance 已经是非 null 了（但却没有初始化），所以线程二会直接返回 instance，然后使用，然后顺理成章地报错。<br>我们只需要将 instance 变量声明成 volatile 就可以了。*</p><h2 id="5-静态内部类"><a href="#5-静态内部类" class="headerlink" title="5. 静态内部类"></a>5. 静态内部类</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//静态内部类</span><br><span class="line">private SingletonDemo() &#123;&#125;</span><br><span class="line">private static class SingletonHolder&#123;</span><br><span class="line">private static SingletonDemo singletonDemo = new SingletonDemo();</span><br><span class="line">&#125;</span><br><span class="line">public static SingletonDemo getInstance()&#123;</span><br><span class="line">return SingletonHolder.singletonDemo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>好处：内部类不会再类加载的时候就加载，而是在调用getInstance()方法时才加载，达到了懒汉模式的效果，而这种方式又是线程安全的</em></p><h2 id="6-枚举"><a href="#6-枚举" class="headerlink" title="6. 枚举"></a>6. 枚举</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public enum SingletonDemo2 &#123;</span><br><span class="line">    INSTANCE;</span><br><span class="line">    public void test()&#123;</span><br><span class="line">        Log.d(&quot;TAG&quot;,&quot;枚举法单例&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//调用方法</span><br><span class="line">SingletonDemo2.INSTANCE.test();</span><br></pre></td></tr></table></figure><p><em>好处：①自由序列化    ②保证只有一个实例    ③线程安全</em></p><p><strong>推荐使用4 5 6这三种方式</strong></p>]]></content>
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Service两种启动方式的区别</title>
      <link href="/2016/06/20/Service%E4%B8%A4%E7%A7%8D%E5%90%AF%E5%8A%A8%E6%96%B9%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/2016/06/20/Service%E4%B8%A4%E7%A7%8D%E5%90%AF%E5%8A%A8%E6%96%B9%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      <content type="html"><![CDATA[<p>启动服务的两种方式<br>startService（Intent）<br>bindService（Intent，ServiceConnection，Int）<br><a id="more"></a></p><h1 id="startService方式"><a href="#startService方式" class="headerlink" title="startService方式"></a>startService方式</h1><p>采用start的方式开启服务<br>步骤：</p><ol><li>定义一个类继承Service</li><li>在ManiFest.xml文件中配置该Service</li><li>使用Context.startService(Intent)方法启动该Service</li><li>不再使用时，调用stopService(Intent)方法停止该服务</li></ol><p>使用这个start方式启动的Service的生命周期：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">onCreate -&gt; onStartCommand -&gt; onDestory</span><br></pre></td></tr></table></figure></p><p>如果服务已经开启，不会重复的执行onCreate，而是调用onStartCommand。<br>服务停止的时候调用onDestory，服务只会被停止一次。</p><p><strong>特点：</strong>start方式 一旦服务开启，跟调用者就没有任何关系了，调用者退出，挂了，服务还在后台长期的运行，调用者不能调用服务里的方法。</p><h1 id="bindService"><a href="#bindService" class="headerlink" title="bindService"></a>bindService</h1><p>采用bind的方式开启服务<br>步骤：</p><ol><li>定义一个类继承Service</li><li>在Manifest.xml文件中配置该Service</li><li>使用Context的bindService(Intent，ServiceConnection，flags)方法启动服务</li><li>不再使用时，调用unbindService(ServiceConnection)方法停止该服务</li></ol><p>使用bindService方式启动的Service的生命周期如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">onCreate -&gt; onBind -&gt; onunbind -&gt; onDestory</span><br></pre></td></tr></table></figure></p><p><strong>注意：</strong>绑定服务不会调用onStartCommand（）方法。  </p><p><strong>特点：</strong>bind的方式开启服务，绑定服务，调用者挂了，服务也会跟着挂掉。绑定者可以调用服务里的方法。  </p><h1 id="绑定者调用服务里的方法"><a href="#绑定者调用服务里的方法" class="headerlink" title="绑定者调用服务里的方法"></a>绑定者调用服务里的方法</h1><p>首先定义一个Service的子类。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public class MyService extends Service &#123;</span><br><span class="line"></span><br><span class="line">    private MyBinder myBinder;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onCreate() &#123;</span><br><span class="line">        super.onCreate();</span><br><span class="line">        myBinder = new MyBinder();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public IBinder onBind(Intent intent) &#123;</span><br><span class="line">        return myBinder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public class MyBinder extends Binder &#123;</span><br><span class="line"></span><br><span class="line">        public void test()&#123;</span><br><span class="line">            Log.d(&quot;TAG&quot;,&quot;test()&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>绑定服务的Activity：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line">    </span><br><span class="line">    private MyService.MyBinder binder;</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        View tv = findViewById(R.id.tv);</span><br><span class="line">        tv.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">                binder.test();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        MyServiceConn myServiceConn = new MyServiceConn();</span><br><span class="line">        bindService(new Intent(this,MyService.class),myServiceConn,BIND_AUTO_CREATE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public class MyServiceConn implements ServiceConnection&#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void onServiceConnected(ComponentName name, IBinder service) &#123;</span><br><span class="line">            binder = (MyService.MyBinder) service;</span><br><span class="line">        &#125;</span><br><span class="line">        @Override</span><br><span class="line">        public void onServiceDisconnected(ComponentName name) &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>绑定服务调用的方法步骤：</p><ol><li>在服务创建一个类MyBinder继承自Binder（因为onBind（）需要返回一个IBinder，Binder实现了IBinder）</li><li>onCreate（）里面实例化MyBinder</li><li>在MyBinder里创建一个供调用的方法</li><li>在activity 绑定服务。bindService()</li><li>在服务成功绑定的回调方法onServiceConnected， 会传递过来一个 IBinder对象</li><li>强制类型转化为自定义的MyBinder类型，调用类里面的方法。</li></ol>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>UML 统一建模语言</title>
      <link href="/2016/06/16/UML-%E7%BB%9F%E4%B8%80%E5%BB%BA%E6%A8%A1%E8%AF%AD%E8%A8%80/"/>
      <url>/2016/06/16/UML-%E7%BB%9F%E4%B8%80%E5%BB%BA%E6%A8%A1%E8%AF%AD%E8%A8%80/</url>
      <content type="html"><![CDATA[<p>通过使用UML的面向对象图的方式来更明确、清晰的表达项目中的架设思想、项目结构、执行顺序等一些逻辑思维</p><a id="more"></a><h1 id="UML建模工具"><a href="#UML建模工具" class="headerlink" title="UML建模工具"></a>UML建模工具</h1><p>Rational Rose、PowerDesigner、Visual Paradigm for UML、Jude、SystemArchitect、StarUML</p><h1 id="UML统一了什么"><a href="#UML统一了什么" class="headerlink" title="UML统一了什么"></a>UML统一了什么</h1><p>UML统一了Booch、OMT、OOSE和其他面向对象方法所涉及的基本概念和建模符号。</p><h1 id="UML模型"><a href="#UML模型" class="headerlink" title="UML模型"></a>UML模型</h1><p>UML的模型主要由三部分构成：</p><ol><li>事物：UML模型中最基本的构成元素，是具有代表性的成分的抽象</li><li>关系：关系把事物紧密联系在一起</li><li>图：图是事物和关系的可视化表示</li></ol><h1 id="UML特点"><a href="#UML特点" class="headerlink" title="UML特点"></a>UML特点</h1><ol><li>面向对象</li><li>可视化，表达能力强</li><li>独立于过程</li><li>独立于程序设计</li><li>容易掌握使用</li></ol><h1 id="UML-5种类图定义"><a href="#UML-5种类图定义" class="headerlink" title="UML 5种类图定义"></a>UML 5种类图定义</h1><ol><li>用例图： 从用户角度描述系统功能，并指定各功能的操作者</li><li>静态图：包括类图，包图，对象图</li><li>行为图：描述系统动态模型和对象组成的交换关系。包括状态图和活动图</li><li>交互图：描述对象之间的交互关系</li><li>实现图：定义系统中软硬件的物理体系结构</li></ol><h1 id="UML-10种模型图"><a href="#UML-10种模型图" class="headerlink" title="UML 10种模型图"></a>UML 10种模型图</h1><ol><li>用例图：展示系统外部的各类执行者和系统提供的各种用例之间的关系</li><li>类图：展示系统中类的静态结构</li><li>对象图：是类图的一种实例化图</li><li>包图：是一种分组机制</li><li>状态图：描述一类对象具有的所有可能的状态及其转移关系</li><li>时序图：展示对象之间的一种动态协作关系</li><li>合作图：从另一个角度展示对象之间的动态协作关系</li><li>活动图：展示系统中各种活动的执行流程</li><li>构件图：展示程序代码的物理结构</li><li>配置图：展示软件在硬件环境中的配置关系</li></ol>]]></content>
      
      <categories>
          
          <category> 项目管理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> UML建模 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>排序算法</title>
      <link href="/2016/05/28/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"/>
      <url>/2016/05/28/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/</url>
      <content type="html"><![CDATA[<p><img src="/2016/05/28/排序算法/1.png" alt="排序算法"></p><a id="more"></a><h1 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h1><p>原理：比较两个相邻的元素，将值大的元素交换至右端。<br>思路：依次比较相邻的两个数，将小的数放在前面，大的数放在后面。即第一趟：比较1.和2.两个数，将小数放前，大数放后。然后比较2.和3.，将小数放前，大数放后；直至比较最后两个数；重复第一趟步骤，直至全部排序完成。<br>举例说明：要排序数组：int[] arr = {6,3,8,2,9,1}  </p><p>第一趟排序：</p><p>　　　　第一次排序：6和3比较，6大于3，交换位置：  3  6  8  2  9  1</p><p>　　　　第二次排序：6和8比较，6小于8，不交换位置：3  6  8  2  9  1</p><p>　　　　第三次排序：8和2比较，8大于2，交换位置：  3  6  2  8  9  1</p><p>　　　　第四次排序：8和9比较，8小于9，不交换位置：3  6  2  8  9  1</p><p>　　　　第五次排序：9和1比较：9大于1，交换位置：  3  6  2  8  1  9</p><p>　　　　第一趟总共进行了5次比较， 排序结果：      3  6  2  8  1  9</p><hr><p>第二趟排序：</p><p>　　　　第一次排序：3和6比较，3小于6，不交换位置：3  6  2  8  1  9</p><p>　　　　第二次排序：6和2比较，6大于2，交换位置：  3  2  6  8  1  9</p><p>　　　　第三次排序：6和8比较，6大于8，不交换位置：3  2  6  8  1  9</p><p>　　　　第四次排序：8和1比较，8大于1，交换位置：  3  2  6  1  8  9</p><p>　　　　第二趟总共进行了4次比较， 排序结果：      3  2  6  1  8  9</p><hr><p>第三趟排序：</p><p>　　　　第一次排序：3和2比较，3大于2，交换位置：  2  3  6  1  8  9</p><p>　　　　第二次排序：3和6比较，3小于6，不交换位置：2  3  6  1  8  9</p><p>　　　　第三次排序：6和1比较，6大于1，交换位置：  2  3  1  6  8  9</p><p>　　　　第二趟总共进行了3次比较， 排序结果：         2  3  1  6  8  9</p><hr><p>第四趟排序：</p><p>　　　　第一次排序：2和3比较，2小于3，不交换位置：2  3  1  6  8  9</p><p>　　　　第二次排序：3和1比较，3大于1，交换位置：  2  1  3  6  8  9</p><p>　　　　第二趟总共进行了2次比较， 排序结果：        2  1  3  6  8  9</p><hr><p>第五趟排序：</p><p>　　　　第一次排序：2和1比较，2大于1，交换位置：  1  2  3  6  8  9</p><p>　　　　第二趟总共进行了1次比较， 排序结果：  1  2  3  6  8  9</p><hr><p>最终结果：1  2  3  6  8  9</p><hr><p>由此可见：N个数字排序完成，总共进行N-1趟排序，每i趟的排序次数为（N-i）次，所以用双重循环语句，外层控制循环多少趟，内层控制每趟的循环次数，即<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">for (int i=0;i&lt;a.length-1;i++)&#123;//外层循环控制排序趟数</span><br><span class="line">for(int j=0;j&lt;a.length-1-i;j++)&#123;//内层循环控制每一趟排序多少次</span><br><span class="line">if (a[j]&gt;a[j+1])&#123;</span><br><span class="line">temp = a[j];</span><br><span class="line">a[j] = a[j+1];</span><br><span class="line">a[j+1]=temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>冒泡排序的优点：每进行一趟排序，就会少比较一次，因为每进行一趟排序就会找出一个较大值</p><h1 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h1><p>数据的顺序拍好之后，</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>基本知识讲解</title>
      <link href="/2016/05/23/%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%E8%AE%B2%E8%A7%A3/"/>
      <url>/2016/05/23/%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%E8%AE%B2%E8%A7%A3/</url>
      <content type="html"><![CDATA[<p>本节讲解android的基本知识：Activity启动过程、启动模式；Service启动方式；BroadCast注册；进程通信；<br>缓存；mvp框架；JNI；View；WebView；内存优化；设计模式；开源框架…<br><a id="more"></a></p><h1 id="Activity的启动过程"><a href="#Activity的启动过程" class="headerlink" title="Activity的启动过程"></a>Activity的启动过程</h1><h1 id="Activity启动模式及应用场景"><a href="#Activity启动模式及应用场景" class="headerlink" title="Activity启动模式及应用场景"></a>Activity启动模式及应用场景</h1><a href="/2016/04/21/Activity启动模式及应用场景/" title="Activity启动模式及应用场景">Activity启动模式及应用场景</a><p>延伸：栈与队列</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>BroadcastReceiver 广播</title>
      <link href="/2016/05/22/BroadcastReceiver-%E5%B9%BF%E6%92%AD/"/>
      <url>/2016/05/22/BroadcastReceiver-%E5%B9%BF%E6%92%AD/</url>
      <content type="html"><![CDATA[<p>在Android中，我们如果想接收到广播信息，必须自定义我们的广播接收者。要写一个类继承自BroadcastReceiver，并且重写其onReceive（）方法，实现接收到特定广播所要做的事情。<br><a id="more"></a></p><h1 id="广播接收者"><a href="#广播接收者" class="headerlink" title="广播接收者"></a>广播接收者</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class MyReceiver extends BroadcastReceiver &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onReceive(Context context, Intent intent) &#123;</span><br><span class="line">        //在这里可以写相应的逻辑来实现一些功能</span><br><span class="line">        //可以从Intent中获取数据、还可以调用BroadcastReceiver的getResultData()获取数据</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们已经定义好了一个广播接收者。要想使用它接收到广播，就要注册这个广播接收者。  </p><p>有两种方式祖册广播：</p><h1 id="代码中动态注册"><a href="#代码中动态注册" class="headerlink" title="代码中动态注册"></a>代码中动态注册</h1><ol><li>实例化自定义的广播接收者</li><li>实例化意图过滤器，并设置要过滤的广播类型</li><li>使用Context的registReceiver（）方法注册广播</li></ol><p>代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MyReceiver myReceiver = new MyReceiver();</span><br><span class="line">IntentFilter intentFilter = new IntentFilter(Intent.ACTION_SCREEN_ON);//系统解锁广播</span><br><span class="line">registerReceiver(myReceiver,intentFilter);</span><br></pre></td></tr></table></figure></p><h1 id="在Manifest-xml中静态注册"><a href="#在Manifest-xml中静态注册" class="headerlink" title="在Manifest.xml中静态注册"></a>在Manifest.xml中静态注册</h1><p>直接在Manifest.xml文件配置广播接收者。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;receiver android:name=&quot;.receiver.MyReceiver&quot;&gt;</span><br><span class="line">&lt;intent-filter&gt;</span><br><span class="line">&lt;action android:name=&quot;android.intent.action.SCREEN_ON&quot;/&gt;</span><br><span class="line">&lt;/intent-filter&gt;</span><br><span class="line">&lt;/receiver&gt;</span><br></pre></td></tr></table></figure></p><h1 id="两种注册方式的不同"><a href="#两种注册方式的不同" class="headerlink" title="两种注册方式的不同"></a>两种注册方式的不同</h1><p>第一种不是常驻广播，跟随程序的生命周期；<br>第二种是常驻广播，当程序关闭时，还是会接收到广播。</p><h1 id="广播的发送"><a href="#广播的发送" class="headerlink" title="广播的发送"></a>广播的发送</h1><p>当我们需要发送一个自定义的广播来通知程序中其他组件的一些状态是，就可以使用发送一条广播的方式。 </p><p>注册一个接收消息的广播<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MyReceiver myReceiver = new MyReceiver();</span><br><span class="line">IntentFilter intentFilter = new IntentFilter(&quot;test&quot;);//action名字可随意</span><br><span class="line">registerReceiver(myReceiver,intentFilter);</span><br><span class="line">或</span><br><span class="line">&lt;receiver android:name=&quot;.receiver.MyReceiver&quot;&gt;</span><br><span class="line">&lt;intent-filter&gt;</span><br><span class="line">&lt;action android:name=&quot;test&quot;/&gt;</span><br><span class="line">&lt;/intent-filter&gt;</span><br><span class="line">&lt;/receiver&gt;</span><br></pre></td></tr></table></figure></p><p>发送广播<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sendBroadcast(new Intent().setAction(&quot;test&quot;));</span><br></pre></td></tr></table></figure></p><p>发送无序广播：context.sendBroadcast(intent)或context.sendBroadcast(intent,string)<br>发送有序广播：context.sendOrderBroadcast(…)</p><p>区别：<br>无序广播：所有接收者都会接收到事件，不可以被拦截，不可以被修改；<br>有序广播：按照优先级，一级一级的向下传递，接收者可以修改广播数据，也可以终止广播事件。</p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Junit 单元测试</title>
      <link href="/2016/05/19/Junit-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"/>
      <url>/2016/05/19/Junit-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/</url>
      <content type="html"><![CDATA[<p>单元测试（unit testing），是指对软件中的最小可测试单元进行检查和验证。比如一个函数，一个方法等。</p><a id="more"></a><h1 id="添加junit依赖"><a href="#添加junit依赖" class="headerlink" title="添加junit依赖"></a>添加junit依赖</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">testImplementation &apos;junit:junit:4.12&apos;</span><br></pre></td></tr></table></figure><h1 id="写一个要测试的类"><a href="#写一个要测试的类" class="headerlink" title="写一个要测试的类"></a>写一个要测试的类</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Calculator &#123;</span><br><span class="line"></span><br><span class="line">     public int add(int one, int another) &#123;</span><br><span class="line">        return one + another;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="写测试类"><a href="#写测试类" class="headerlink" title="写测试类"></a>写测试类</h1><h2 id="手动写测试类"><a href="#手动写测试类" class="headerlink" title="手动写测试类"></a>手动写测试类</h2><p>单元测试代码放在src/test/java目录下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class CalculatorTest &#123;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void testAdd() throws Exception &#123;</span><br><span class="line">        Calculator calculator = new Calculator();</span><br><span class="line">        int sum = calculator.add(1, 2);</span><br><span class="line">        assertEquals(3, sum);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>右键testAdd方法，run “testAdd()”</p><h2 id="使用快捷方式自动创建测试类"><a href="#使用快捷方式自动创建测试类" class="headerlink" title="使用快捷方式自动创建测试类"></a>使用快捷方式自动创建测试类</h2><p>选择目标类或目标方法，点击右键，选择GoTo -&gt; Test，来快速创建单元测试方法</p>]]></content>
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Junit 单元测试 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Android 多线程</title>
      <link href="/2016/04/28/Android-%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
      <url>/2016/04/28/Android-%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>当我们启动一个App的时候，Android系统会启动一个Linux Process，该Process包含一个Thread，称为UI Thread或Main Thread。通常一个应用的所有组件都运行在这个Process中，当然，也可以通过修改四大组件的android:process属性指定其运行在不同的Process中。</p><p>UI Thread中运行着很多重要的逻辑，如系统事件处理，用户输入事件处理，UI绘制，Service等,如下图</p><p><img src="/2016/04/28/Android-多线程/1.png" alt="UI Thread中重要逻辑"></p><a id="more"></a><h1 id="ANR"><a href="#ANR" class="headerlink" title="ANR"></a>ANR</h1><p><img src="/2016/04/28/Android-多线程/anr.png" alt="ANR"><br>ANR：全名Application Not Responding，也就是“应用无响应”，当操作在一段时间内系统无法处理时，系统层面会弹出上图那样的ANR对话框。</p><h2 id="为什么会产生ANR"><a href="#为什么会产生ANR" class="headerlink" title="为什么会产生ANR"></a>为什么会产生ANR</h2><p>在Android里，App的响应能力是由Activity Manager和Window Manager系统服务来监控，通常以下两种情况会报ANR：</p><ol><li>5s内无法响应用户输入事件（例如键盘输入、触摸屏幕等）</li><li>BroadcastReceiver在10s内无法结束</li></ol><p>造成以上两种情况的首要原因就是在主线程（UI 线程）里面做了太多的阻塞耗时操作，例如文件读写，数据库读写，网络查询等等。</p><h2 id="如何避免ANR"><a href="#如何避免ANR" class="headerlink" title="如何避免ANR"></a>如何避免ANR</h2><p>知道了ANR发生的原因，那么想要避免ANR，也就很简单了，就一条原则<br><strong>不要在主线程（UI线程）里面做繁重的操作</strong></p><h2 id="ANR的处理"><a href="#ANR的处理" class="headerlink" title="ANR的处理"></a>ANR的处理</h2><p>针对三种不同的情况，一般的处理情况如下</p><ol><li>主线程阻塞：开辟单独的子线程来处理耗时阻塞事务</li><li>CPU满负荷，I/O阻塞：I/O阻塞一般来说就是文件读写或数据库操作执行在主线程了, 也可以通过开辟子线程的方式异步执行.</li><li>内存不够用：增大VM内存, 使用largeHeap属性, 排查内存泄露等.</li></ol><h1 id="Android-常见启动多线程方式"><a href="#Android-常见启动多线程方式" class="headerlink" title="Android 常见启动多线程方式"></a>Android 常见启动多线程方式</h1><p>在新线程执行完耗时的逻辑后，往往需要将结果反馈给界面，进行UI更新。Android的UI toolkit不是线程安全的，不能在非UI线程进行UI的更新，所有对界面的更新必须在UI线程进行。</p><h1 id="Handler-Thread"><a href="#Handler-Thread" class="headerlink" title="Handler + Thread"></a>Handler + Thread</h1><p>Android主线程包含一个消息队列（MessageQueue），该消息队列里面可以存入一系列的Message或Runnable对象。通过一个Handler可以往这个消息队列发送Message或者Runnable对象，并且处理这些对象。每次创建一个Handle对象，它会绑定于创建它的线程（也就是UI线程）以及该线程的消息队列，此时，这个handler就会开始把Message或Runnable对象传递到消息队列中，并在它们出队列的时候执行它们。<br><img src="/2016/04/28/Android-多线程/handler.png" alt="handler"></p><p>Handler发送消息队列有两种方式，Post和sendMessage</p><h2 id="Post方式"><a href="#Post方式" class="headerlink" title="Post方式"></a>Post方式</h2><p>post允许把一个Runnable对象入消息队列中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">post(Runnable)</span><br><span class="line">postAtTime(Runnable,long)</span><br><span class="line">postDelayed(Runnable,long)</span><br></pre></td></tr></table></figure></p><p>在这个Runnable对象中，重写run()方法，一般在这个run()方法中更新UI操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">handler.post(new Runnable()&#123;</span><br><span class="line">@Override</span><br><span class="line">public void run()&#123;</span><br><span class="line">//此处可更细UI</span><br><span class="line">tv.setText(&quot;handler.post 更新ui&quot;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h2 id="sendMessage"><a href="#sendMessage" class="headerlink" title="sendMessage"></a>sendMessage</h2><p>sendMessage允许把一个包含消息数据的Message对象发送到消息队列<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sendEmptyMessage(int)</span><br><span class="line">sendMessage(Message)</span><br><span class="line">sendMessageAtTime(Message,long)</span><br><span class="line">sendMessageDelayed(Message,long)</span><br></pre></td></tr></table></figure></p><h2 id="优缺点及适用范围"><a href="#优缺点及适用范围" class="headerlink" title="优缺点及适用范围"></a>优缺点及适用范围</h2><p>优缺点：</p><ol><li>Handler用法简单明了，可以将多个异步任务更新UI的代码放在一起，清晰明了</li><li>处理单个异步任务代码略多</li></ol><p>适用范围</p><ol><li>多个异步任务更新UI</li></ol><h1 id="AsyncTask"><a href="#AsyncTask" class="headerlink" title="AsyncTask"></a>AsyncTask</h1><p>AsyncTask是android提供的轻量级的异步类，可以直接继承AsyncTask，在doInBackground()中做耗时操作，onPostExecute()中更新UI。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">class DownloadTask extends AsyncTask&lt;Integer, Integer, String&gt;&#123;</span><br><span class="line">@Override</span><br><span class="line">    protected void onPreExecute() &#123;</span><br><span class="line">        //第一个执行方法</span><br><span class="line">        super.onPreExecute();</span><br><span class="line">    &#125;</span><br><span class="line">@Override</span><br><span class="line">    protected String doInBackground(Integer... params) &#123;</span><br><span class="line">        //第二个执行方法,onPreExecute()执行完后执行</span><br><span class="line">        return &quot;执行完毕&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">@Override</span><br><span class="line">    protected void onProgressUpdate(Integer... progress) &#123;</span><br><span class="line">        //这个函数在doInBackground调用publishProgress时触发，虽然调用时只有一个参数</span><br><span class="line">        super.onProgressUpdate(progress);</span><br><span class="line">    &#125;</span><br><span class="line">@Override</span><br><span class="line">    protected void onPostExecute(String result) &#123;</span><br><span class="line">        //doInBackground返回时触发，换句话说，就是doInBackground执行完后触发</span><br><span class="line">        //这里的result就是上面doInBackground执行后的返回值，所以这里是&quot;执行完毕&quot;</span><br><span class="line">        setTitle(result);</span><br><span class="line">        super.onPostExecute(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="优缺点及适用范围-1"><a href="#优缺点及适用范围-1" class="headerlink" title="优缺点及适用范围"></a>优缺点及适用范围</h2><p>优缺点：</p><ol><li>处理单个异步任务简单，可以获取到异步任务的进度</li><li>可以通过cancel方法取消还没执行完的AsyncTask</li><li>处理多个异步任务代码显得较多</li></ol><p>适用范围：</p><ol><li>单个异步任务</li></ol><h1 id="ThreadPoolExecutor"><a href="#ThreadPoolExecutor" class="headerlink" title="ThreadPoolExecutor"></a>ThreadPoolExecutor</h1><p>ThreadPoolExecutor提供了一组线程池，可以管理多个线程并行执行。这样可以一方面减少每个并行任务独自建立线程的开销，另一方面可以管理多个并发线程的公共资源，从而提高了多线程的效率。<br>Executors利用工厂模式对ThreadPoolExecutor进行了封装，使用起来更加方便。  </p><p>Executors提供了四种创建方法：</p><ol><li>Executors.newFixedThreadPool() 定长线程池</li><li>Executors.newCachedThreadPool() 可缓存的线程池，当线程池长度超过了处理的需要，它会灵活回收空闲的线程，当需要增加时，它会灵活增加新的线程，不会对池的长度作任何限制</li><li>Executors.newScheduledThreadPool() 定长线程池，支持定时的以及周期性的执行任务，类似Timer</li><li>Executors.newSingleThreadExecutor() 单线程或的executor，它只创建一个worker线程来执行任务</li></ol><h2 id="优缺点及适用范围-2"><a href="#优缺点及适用范围-2" class="headerlink" title="优缺点及适用范围"></a>优缺点及适用范围</h2><p>适用范围：</p><ol><li>批处理任务</li></ol><h1 id="IntentService"><a href="#IntentService" class="headerlink" title="IntentService"></a>IntentService</h1><p>IntentService继承自Service，是一个经过包装的轻量级Service，用来接收并处理通过Intent传递的异步请求。调用startService（Intent）启动一个IntentService，在onHandleIntent中依次处理顺序过来的请求，处理完后自动结束Service。</p><h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ol><li>可以处理异步任务的简单Service</li></ol>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Activity启动模式及应用场景</title>
      <link href="/2016/04/21/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E5%8F%8A%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/"/>
      <url>/2016/04/21/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E5%8F%8A%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/</url>
      <content type="html"><![CDATA[<p>栈：  </p><ol><li>程序打开时就创建了一个任务栈，用于存储当前程序的activity。</li><li>一个任务栈包含一个activity的集合，去有序的选择哪一个activity和用户进行交互；只有任务栈栈顶的activity才可以跟用户进行交互。</li><li>任务栈可以移动到后台，并且保留了每一个activity的状态，并且有序的给用户列出它们的任务，而且还不丢失它们的状态信息。</li><li>退出应用程序：当把所有任务栈中的activity清理出栈时，任务栈会被销毁，程序退出。<a id="more"></a></li></ol><p>任务栈的缺点：</p><ol><li>没开启一次页面都会在栈顶添加一个activity；只有任务栈中的activity全部被清除出栈时，程序才会退出。</li><li>没开启一次页面都会在栈顶添加一个activity，会造成数据冗余，重复数据太多，会导致内存溢出（OOM）。</li></ol><p>为了解决任务栈的缺点，引入了启动模式。</p><p>启动模式在多个Activity跳转中扮演重要角色，它决定是否生成新的Activity实例；是否重用已存在的Activity实例；是否和其他Activity公用一个<strong>task</strong>。 <strong>task</strong>是一个具有栈结构的对象，一个task可以管理多个Activity，启动一个应用，也就创建一个与之对应的task。</p><h1 id="四种启动模式"><a href="#四种启动模式" class="headerlink" title="四种启动模式"></a>四种启动模式</h1><ul><li>standard</li><li>singleTop</li><li>singleTask</li><li>singleInstance</li></ul><p>可直接在AndroidManifest配置android：launcherMode属性。</p><h1 id="详细介绍"><a href="#详细介绍" class="headerlink" title="详细介绍"></a>详细介绍</h1><h2 id="standard"><a href="#standard" class="headerlink" title="standard"></a>standard</h2><p>standard是默认的启动模式：每次跳转系统都会在task中生成一个新的Activity实例，放于栈顶<br>standard模式，不管有没有已经存在的实例，都会生成新的实例。</p><h2 id="singleTop"><a href="#singleTop" class="headerlink" title="singleTop"></a>singleTop</h2><p>singleTop：跳转时如果当前Activity正位于栈顶，则不再生成新的实例（调用onPause,onNewIntent,onResume方法），不位于栈顶或任务栈中没有当前Activity，则生成新的实例。</p><h2 id="singleTask"><a href="#singleTask" class="headerlink" title="singleTask"></a>singleTask</h2><p>singleTask：如果任务栈中没有要打开的Activity，就生成新的实例；如果任务栈中有要打开的Activity，则使此Activity实例之上的其他Activity实例统统出栈，使此实例成为栈顶对象，显示到幕前。</p><h2 id="singleInstance"><a href="#singleInstance" class="headerlink" title="singleInstance"></a>singleInstance</h2><p>singleInstance很特别，因为它会启用一个新的栈结构，将Activity放置于新的栈结构中，并保证不再有其他Activity实例进入。<br>新建FirstActivity 启动模式为standard，SecondActivity 启动模式为SingleInstance；</p><p><img src="/2016/04/21/Activity启动模式及应用场景/1.jpg" alt=""></p><p>从First跳转到Second时，重新启用了一个新的栈结构，来放置Second实例，然后按下返回键，再次回到原始栈机构；<br>图中下部分在Second再次跳转到First，这时系统会在原始栈结构中生成一个First实例，然后后退两次，此时并没有退出，而是到了Second？？？是因为从Second跳转到First的时候，起点变成了Second所在的栈结构。</p><h1 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h1><p>SingleTop：适合接受通知启动的内容显示页面。<br>SingleTask：适合做为程序入口。<br>SingleInstance：适合需要与程序分离开的页面。例如闹钟提醒，将闹钟提醒和闹钟设置分离。</p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>面向对象设计的五个基本原则</title>
      <link href="/2016/04/16/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1%E7%9A%84%E4%BA%94%E4%B8%AA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99/"/>
      <url>/2016/04/16/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1%E7%9A%84%E4%BA%94%E4%B8%AA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99/</url>
      <content type="html"><![CDATA[<p>面向对象设计的3个基本要素：封装、继承、多态  </p><p>面向对象设计的5个基本原则：单一职责原则、开放封闭、里氏置换、依赖倒置、接口隔离<br><a id="more"></a></p><h1 id="单一职责原则（Single-Resposibility-Principle）"><a href="#单一职责原则（Single-Resposibility-Principle）" class="headerlink" title="单一职责原则（Single-Resposibility Principle）"></a>单一职责原则（Single-Resposibility Principle）</h1><p>其核心思想为：一个类，最好只做一件事，只有一个引起它的变化。<br>单一职责原则可以看做是低耦合、高内聚在面向对象原则上的引申，将职责定义为引起变化的原因，以提高内聚性来减少引起变化的原因。职责过多，可能引起它变化的原因就越多，这将导致职责依赖，相互之间就产生影响，从而大大损伤其内聚性和耦合度。通常意义下的单一职责，就是指只有一种单一功能，不要为类实现过多的功能点，以保证实体只有一个引起它变化的原因。<br>专注，是一个人优良的品质；同样的，单一也是一个类的优良设计。交杂不清的职责将使得代码看起来特别别扭牵一发而动全身，有失美感和必然导致丑陋的系统错误风险。</p><h1 id="开放封闭原则（Open-Closed-principle）"><a href="#开放封闭原则（Open-Closed-principle）" class="headerlink" title="开放封闭原则（Open-Closed principle）"></a>开放封闭原则（Open-Closed principle）</h1><p>其核心思想是：软件实体应该是可扩展的，而不是可修改的。也就是说对扩展开放，对修改封闭。<br>1、对扩展开放，意味着有新的需求或变化时，可以对现有代码进行扩展，以适应新的情况。<br>2、对修改封闭，意味着类一旦设计完成，就可以独立完成其工作，而不要对其进行任何尝试的修改。<br>实现开开放封闭原则的核心思想就是对抽象编程，而不对具体编程，因为抽象相对稳定。让类依赖于固定的抽象，所以修改就是封闭的；而通过面向对象的继承和多态机制，又可以实现对抽象类的继承，通过覆写其方法来改变固有行为，实现新的拓展方法，所以就是开放的。<br>“需求总是变化”没有不变的软件，所以就需要用封闭开放原则来封闭变化满足需求，同时还能保持软件内部的封装体系稳定，不被需求的变化影响。</p><h1 id="里氏置换原则（Liskov-Substituion-Principle）"><a href="#里氏置换原则（Liskov-Substituion-Principle）" class="headerlink" title="里氏置换原则（Liskov-Substituion Principle）"></a>里氏置换原则（Liskov-Substituion Principle）</h1><p>其核心思想是：子类必须能够替换其基类。<br>这一思想体现为对继承机制的约束规范，只有子类能够替换基类时，才能保证系统在运行期内识别子类，这是保证继承复用的基础。在父类和子类的具体行为中，必须严格把握继承层次中的关系和特征，将基类替换为子类，程序的行为不会发生任何变化。同时，这一约束反过来则是不成立的，子类可以替换基类，但是基类不一定能替换子类。<br>Liskov替换原则，主要着眼于对抽象和多态建立在继承的基础上，因此只有遵循了Liskov替换原则，才能保证继承复用是可靠地。实现的方法是面向接口编程：将公共部分抽象为基类接口或抽象类，通过Extract Abstract Class，在子类中通过覆写父类的方法实现新的方式支持同样的职责。<br>Liskov替换原则是关于继承机制的设计原则，违反了Liskov替换原则就必然导致违反开放封闭原则。<br>Liskov替换原则能够保证系统具有良好的拓展性，同时实现基于多态的抽象机制，能够减少代码冗余，避免运行期的类型判别。  </p><h1 id="依赖倒置原则（Dependecy-Inversion-Principle）"><a href="#依赖倒置原则（Dependecy-Inversion-Principle）" class="headerlink" title="依赖倒置原则（Dependecy-Inversion Principle）"></a>依赖倒置原则（Dependecy-Inversion Principle）</h1><p>其核心思想是：依赖于抽象。具体而言就是高层模块不依赖于底层模块，二者都同依赖于抽象；抽象不依赖于具体，具体依赖于抽象。<br>我们知道，依赖一定会存在于类与类、模块与模块之间。当两个模块之间存在紧密的耦合关系时，最好的方法就是分离接口和实现：在依赖之间定义一个抽象的接口使得高层模块调用接口，而底层模块实现接口的定义，以此来有效控制耦合关系，达到依赖于抽象的设计目标。<br>抽象的稳定性决定了系统的稳定性，因为抽象是不变的，依赖于抽象是面向对象设计的精髓，也是依赖倒置原则的核心。<br>依赖于抽象是一个通用的原则，而某些时候依赖于细节则是在所难免的，必须权衡在抽象和具体之间的取舍，方法不是一层不变的。依赖于抽象，就是对接口编程，不要对实现编程。  </p><h1 id="接口隔离原则（Interface-Segregation-Principle）"><a href="#接口隔离原则（Interface-Segregation-Principle）" class="headerlink" title="接口隔离原则（Interface-Segregation Principle）"></a>接口隔离原则（Interface-Segregation Principle）</h1><p>其核心思想是：使用多个小的专门的接口，而不要使用一个大的总接口。<br>具体而言，接口隔离原则体现在：接口应该是内聚的，应该避免“胖”接口。一个类对另外一个类的依赖应该建立在最小的接口上，不要强迫依赖不用的方法，这是一种接口污染。  </p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>以上就是5个基本的面向对象设计原则，它们就像面向对象程序设计中的金科玉律，遵守它们可以使我们的代码更加鲜活，易于复用，易于拓展，灵活优雅。不同的设计模式对应不同的需求，而设计原则则代表永恒的灵魂，需要在实践中时时刻刻地遵守。就如ARTHUR J.RIEL在那边《OOD启示录》中所说的：“你并不必严格遵守这些原则，违背它们也不会被处以宗教刑罚。但你应当把这些原则看做警铃，若违背了其中的一条，那么警铃就会响起。”</p>]]></content>
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>java 线程同步</title>
      <link href="/2016/04/09/java-%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/"/>
      <url>/2016/04/09/java-%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/</url>
      <content type="html"><![CDATA[<p>为什么要线程同步？<br>当我们有多个线程同时访问一个变量或对象时，如果这些线程中既有读又有写操作时，会导致变量值或对象的状态出现混乱，从而导致程序异常。比如：银行账户存钱取钱</p><a id="more"></a><h1 id="同步方法"><a href="#同步方法" class="headerlink" title="同步方法"></a>同步方法</h1><p>用synchroized关键字修饰方法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class Bank &#123;</span><br><span class="line">private int count =0;//账户余额</span><br><span class="line"></span><br><span class="line">//存钱</span><br><span class="line">public synchronized void addMoney(int money)&#123;</span><br><span class="line">count +=money;</span><br><span class="line">System.out.println(System.currentTimeMillis()+&quot;存进：&quot;+money);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//取钱</span><br><span class="line">public synchronized void subMoney(int money)&#123;</span><br><span class="line">if(count-money &lt; 0)&#123;</span><br><span class="line">System.out.println(&quot;余额不足&quot;);</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">count -=money;</span><br><span class="line">System.out.println(+System.currentTimeMillis()+&quot;取出：&quot;+money);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><em>补充：synchroized也可以修饰静态方法，会锁住整个类</em></p><h1 id="同步代码块"><a href="#同步代码块" class="headerlink" title="同步代码块"></a>同步代码块</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Bank &#123;</span><br><span class="line">private int count =0;//账户余额</span><br><span class="line"></span><br><span class="line">    //存钱</span><br><span class="line">    public void addMoney(int money)&#123;</span><br><span class="line">synchroized(this)&#123;</span><br><span class="line">count +=money;</span><br><span class="line">&#125;</span><br><span class="line">        System.out.println(System.currentTimeMillis()+&quot;存进：&quot;+money);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>效果和同步方法差不多。  </p><p><em>注：同步是一种高开销操作，因此应该尽量减少同步的内容。通常没有必要同步整个方法，使用synchorized同步代码块即可。</em></p><h1 id="使用特殊域变量-Volatile"><a href="#使用特殊域变量-Volatile" class="headerlink" title="使用特殊域变量 Volatile"></a>使用特殊域变量 Volatile</h1><ul><li>volatile关键字为域变量的访问提供一种免锁机制</li><li>使用volatile修饰相当于告诉虚拟机该域可能会被其他线程更新</li><li>每次使用该域就要重新计算，而不是使用寄存器中的值</li><li>volatile不会提供任何原子操作，它也不能用来修饰final类型的变量</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class Bank &#123;</span><br><span class="line">private volatile int count =0;//账户余额</span><br><span class="line"></span><br><span class="line">    //存钱</span><br><span class="line">    public synchronized void addMoney(int money)&#123;</span><br><span class="line">        count +=money;</span><br><span class="line">        System.out.println(System.currentTimeMillis()+&quot;存进：&quot;+money);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="重入锁"><a href="#重入锁" class="headerlink" title="重入锁"></a>重入锁</h1><p>在java 5中新增了一个包java.util.concurrent包来支持同步。ReentrantLock类是可重入、互斥、实现了Lock接口的锁，它与使用synchroized方法和块具有相同的基本行为和语义，并且扩展了其能力。</p><p>ReentrantLock类的常用方法：<br>ReentrantLock()：创建一个ReentrantLock实例<br>lock()：获得锁<br>unlock()：释放锁</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public class Bank &#123;</span><br><span class="line">private int count =0;//账户余额</span><br><span class="line"></span><br><span class="line">//声明锁</span><br><span class="line">private ReentrantLock lock = new ReentrantLock();</span><br><span class="line"></span><br><span class="line">    //存钱</span><br><span class="line">    public synchronized void addMoney(int money)&#123;</span><br><span class="line">lock.lock();//上锁</span><br><span class="line">try&#123;</span><br><span class="line">count +=money;</span><br><span class="line">        System.out.println(System.currentTimeMillis()+&quot;存进：&quot;+money);</span><br><span class="line">&#125; finally &#123;</span><br><span class="line">lock.unlock();//解锁</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>要及时释放锁，否则会出现死锁。如果synchroized能满足用户需求，就用synchroized，因为它能简化代码。</em></p><h1 id="使用局部变量-ThreadLocal"><a href="#使用局部变量-ThreadLocal" class="headerlink" title="使用局部变量(ThreadLocal)"></a>使用局部变量(ThreadLocal)</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class Bank &#123;</span><br><span class="line">private static ThreadLocal&lt;Integer&gt; count = new ThreadLocal&lt;Integer&gt;()&#123;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        protected Integer initialValue() &#123;</span><br><span class="line">            // TODO Auto-generated method stub</span><br><span class="line">            return 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">//存钱</span><br><span class="line">public void addMoney(int money) &#123;</span><br><span class="line">count.set(count.get() + money);</span><br><span class="line">System.out.println(System.currentTimeMillis() + &quot;存进：&quot; + money);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用局部变量，则每个使用该变量的线程都获得该变量的副本，副本之间相互独立，这样每一个线程都可以随意修改自己的变量副本，而不会对其它线程产生影响。</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>ThreadLocal和同步机制区别</p><ul><li>ThreadLocal与同步机制都是为了解决多线程中相同变量的访问冲突问题</li><li>前者采用以“空间换时间”的方法，后者采用以“时间换空间”的方法</li></ul>]]></content>
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java 多线程 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>标签（tags）使用</title>
      <link href="/2015/12/01/%E6%A0%87%E7%AD%BE%EF%BC%88tags%EF%BC%89%E4%BD%BF%E7%94%A8/"/>
      <url>/2015/12/01/%E6%A0%87%E7%AD%BE%EF%BC%88tags%EF%BC%89%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>标签（tags）使用教程</p><p>1.新建页面，<strong>命名为tags</strong>；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page &quot;tags&quot;</span><br></pre></td></tr></table></figure></p><p>2.编辑刚新建的页面<strong>（source/tags/index.md）</strong>，将页面的类型设置为tags，主题将自动为这个页面显示标签云；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">title: tags</span><br><span class="line">date: 2017-10-31 12:26:42</span><br><span class="line">type: &quot;tags&quot;//这里</span><br></pre></td></tr></table></figure></p><p>*注意：如果有启用多说或Disqus评论，默认页面也会带有评论。需要关闭的话，请添加字段comments并将其值设置为false，如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">title: tags</span><br><span class="line">date: 2017-10-31 12:26:42</span><br><span class="line">type: &quot;tags&quot;</span><br><span class="line">comments: false//这里</span><br></pre></td></tr></table></figure></p><p>3.在菜单中添加链接。编辑<strong>主题配置文件</strong>，添加tags到menu中；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  首页: / || home</span><br><span class="line">  标签: /tags/ || tags //这里</span><br><span class="line">  归档: /archives/ || archive</span><br><span class="line">  关于: /about/ || user</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>hexo图片无法显示</title>
      <link href="/2015/11/06/hexo%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA/"/>
      <url>/2015/11/06/hexo%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA/</url>
      <content type="html"><![CDATA[<p>在使用Hexo搭建个人博客的过程中，发现使用链接（！[描述]（图片无法显示/t1.png））的方式引用图片，无法显示，如下<br><img src="/2015/11/06/hexo图片无法显示/t1.png" alt="描述"></p><a id="more"></a><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><h3 id="1-设置站点配置-config-yml"><a href="#1-设置站点配置-config-yml" class="headerlink" title="1.设置站点配置 _config.yml"></a>1.设置站点配置 _config.yml</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">post_asset_folder: true</span><br></pre></td></tr></table></figure><h3 id="2-安装插件"><a href="#2-安装插件" class="headerlink" title="2.安装插件"></a>2.安装插件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure><h3 id="3-引用图片"><a href="#3-引用图片" class="headerlink" title="3.引用图片"></a>3.引用图片</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">（！[描述]（图片无法显示/t1.png））</span><br></pre></td></tr></table></figure><h3 id="4-hexo-server"><a href="#4-hexo-server" class="headerlink" title="4.hexo server"></a>4.hexo server</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install //可能需要</span><br><span class="line">hexo d //本地部署</span><br><span class="line">hexo s //本地预览</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>hexo 引用图片</title>
      <link href="/2015/11/05/hexo-%E5%BC%95%E7%94%A8%E5%9B%BE%E7%89%87/"/>
      <url>/2015/11/05/hexo-%E5%BC%95%E7%94%A8%E5%9B%BE%E7%89%87/</url>
      <content type="html"><![CDATA[<p><img src="/2015/11/05/hexo-引用图片/test.jpg" alt="描述信息"><br><a id="more"></a><br>hexo可通过插件引用图片 hexo-asset-image.<br>新建文章：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new &quot;hexo-引用图片&quot;</span><br></pre></td></tr></table></figure></p><p>在source/_posts目录下会生成“hexo-引用图片”文件夹和“hexo-引用图片.md”文件，文件夹中存放图片（test.jpg）。</p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure><h1 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![描述信息](hexo-引用图片/test.jpg)</span><br></pre></td></tr></table></figure><p><img src="/2015/11/05/hexo-引用图片/test.jpg" alt="描述信息">  </p>]]></content>
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>hexo+next添加algolia搜索</title>
      <link href="/2015/11/05/hexo-next%E6%B7%BB%E5%8A%A0algolia%E6%90%9C%E7%B4%A2/"/>
      <url>/2015/11/05/hexo-next%E6%B7%BB%E5%8A%A0algolia%E6%90%9C%E7%B4%A2/</url>
      <content type="html"><![CDATA[<p>当博客达到一定数量的时候，为了方便找到想找的内容，就需要用到搜索了。  </p><h1 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h1><p><img src="/2015/11/05/hexo-next添加algolia搜索/demo.png" alt="效果图"><br><a id="more"></a></p><h1 id="开始添加"><a href="#开始添加" class="headerlink" title="开始添加"></a>开始添加</h1><ol><li>下载最新的next主题（5.1.0），因为最新版的已经集成了algolia搜索，可以省去很多配置和修改。</li><li>去<a href="https://www.algolia.com/" title="algolia" target="_blank" rel="noopener">algolia官网</a>注册账号（可直接使用github账号登录）</li><li>新建index  <img src="/2015/11/05/hexo-next添加algolia搜索/index.png" alt="index"></li><li>打开API Keys页面，里面的信息等会需要写到hexo的配置文件中<img src="/2015/11/05/hexo-next添加algolia搜索/apikeys.png" alt="index"></li><li><p>在根目录的站点配置文件_config.yml中加入如下配置，参照上图申请到的key值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">algolia:</span><br><span class="line">  appId: &apos;appid&apos;</span><br><span class="line">  apiKey: &apos;apiKey&apos;</span><br><span class="line">  adminApiKey: &apos;adminApiKey&apos;</span><br><span class="line">  indexName: &apos;上面填写的index名&apos;</span><br><span class="line">  chunkSize: 5000</span><br><span class="line">  fields:</span><br><span class="line">    - title</span><br><span class="line">    - slug</span><br><span class="line">    - path</span><br><span class="line">    - content:strip</span><br></pre></td></tr></table></figure></li><li><p>执行hexo algolia.<br><img src="/2015/11/05/hexo-next添加algolia搜索/hexo_algolia.png" alt="hexo algolia"></p></li><li>查看algolia -&gt; Indices<br><img src="/2015/11/05/hexo-next添加algolia搜索/indices.png" alt="hexo algolia"><br>如果无法提交成功，先执行hexo clean即可。</li><li><p>在\themes\next下找到_config.yml，找到如下内容，将enable修改为true，labels修改为自己需要的  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Algolia Search</span><br><span class="line">algolia_search:</span><br><span class="line">  enable: true</span><br><span class="line">  hits:</span><br><span class="line">    per_page: 10</span><br><span class="line">  labels:</span><br><span class="line">    input_placeholder: &quot;输入关键字&quot;</span><br><span class="line">    hits_empty: &quot;没有找到与「$&#123;query&#125;」相关的内容&quot;</span><br><span class="line">    hits_stats: &quot;$&#123;hits&#125;条相关记录，共耗时 $&#123;time&#125; ms&quot;</span><br></pre></td></tr></table></figure></li><li><p>在themes\next\layout_partials中找到header.swig，找到以下代码并修改</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">algolia: &#123;</span><br><span class="line">&lt;!-- applicationID: &apos;&#123;&#123; theme.algolia.applicationID &#125;&#125;&apos;,--&gt;</span><br><span class="line">&lt;!-- 改为 (对应站点配置_config.yml中的algolia.appId)--&gt;</span><br><span class="line">applicationID: &apos;&#123;&#123; theme.algolia.applicationID &#125;&#125;&apos;,</span><br><span class="line">apiKey: &apos;&#123;&#123; theme.algolia.apiKey &#125;&#125;&apos;,</span><br><span class="line">indexName: &apos;&#123;&#123; theme.algolia.indexName &#125;&#125;&apos;,</span><br><span class="line">hits: &#123;&#123; theme.algolia_search.hits | json_encode &#125;&#125;,</span><br><span class="line">labels: &#123;&#123; theme.algolia_search.labels | json_encode &#125;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h1 id="algolia刷新"><a href="#algolia刷新" class="headerlink" title="algolia刷新"></a>algolia刷新</h1><p>添加了新文章，搜索不到时需要刷新algolia<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo algolia</span><br></pre></td></tr></table></figure></p><p>如果失败，clean一下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br></pre></td></tr></table></figure></p><p>然后再执行 hexo algolia   </p>]]></content>
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>hexo常用命令</title>
      <link href="/2015/10/30/hexo%E5%91%BD%E4%BB%A4/"/>
      <url>/2015/10/30/hexo%E5%91%BD%E4%BB%A4/</url>
      <content type="html"><![CDATA[<p>本文介绍hexo的常用命令。  </p><h1 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h1><p>npm install hexo -g #安装<br>npm update hexo -g #升级<br>npm init #初始化 </p><h1 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h1><p>hexo s #启动服务预览并自动更新，无需重启服务器<br>hexo server -s #静态模式<br>hexo server -p 5000 #更改端口<br>hexo server -i 192.168.1.1 #自定义IP<br>hexo clean #清理缓存<br>hexo g #生成静态网页<br>hexo d #开始部署  </p><p>hexo g -d #生成静态网页并部署，两步并一步</p><h1 id="草稿"><a href="#草稿" class="headerlink" title="草稿"></a>草稿</h1><p>hexo publish [layout] <title></title></p><h1 id="模版"><a href="#模版" class="headerlink" title="模版"></a>模版</h1><p>hexo new “postName” #新建文章<br>hexo new page “pageName” #新建页面<br>hexo server #启动服务预览<br>hexo generate #生成静态页面<br>hexo deploy #部署  </p><h1 id="简写"><a href="#简写" class="headerlink" title="简写"></a>简写</h1><p>hexo n “我的博客” == hexo new “我的博客” #新建文章<br>hexo g == hexo generate #生成<br>hexo s == hexo server #启动服务预览<br>hexo d == hexo deploy #部署  </p><h1 id="设置文章摘要"><a href="#设置文章摘要" class="headerlink" title="设置文章摘要"></a>设置文章摘要</h1><p><img src="/2015/10/30/hexo命令/more.png" alt="more"></p><h1 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h1><p>error:ERROR Deployer not found: git<br><strong>解决方法</strong><br>npm install hexo-deployer-git –save</p>]]></content>
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
